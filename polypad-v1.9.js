/* Polypad API v1.9, (c) Mathigon Ltd */
(()=>{var Fo=Object.defineProperty;var Ll=Object.prototype.hasOwnProperty;var Ol=Object.getOwnPropertyDescriptor,jo=Object.getOwnPropertySymbols,Il=Object.prototype.propertyIsEnumerable;var Wo=(s,t,e)=>t in s?Fo(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,Zt=(s,t)=>{for(var e in t||(t={}))Ll.call(t,e)&&Wo(s,e,t[e]);if(jo)for(var e of jo(t))Il.call(t,e)&&Wo(s,e,t[e]);return s};var Q=(s,t,e,i)=>{for(var n=i>1?void 0:i?Ol(t,e):t,o=s.length-1,r;o>=0;o--)(r=s[o])&&(n=(i?r(t,e,n):r(n))||n);return i&&n&&Fo(t,e,n),n};var M=(s,t,e)=>new Promise((i,n)=>{var o=l=>{try{a(e.next(l))}catch(h){n(h)}},r=l=>{try{a(e.throw(l))}catch(h){n(h)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(o,r);a((e=e.apply(s,t)).next())});var Rl='<path d="M4,8H8V4H4Zm6,12h4V16H10ZM4,20H8V16H4Zm0-6H8V10H4Zm6,0h4V10H10ZM16,4V8h4V4ZM10,8h4V4H10Zm6,6h4V10H16Zm0,6h4V16H16Z"/>',Gl='<path d="M3,18a1.1,1.1,0,0,0,1,1H9V17H4A1.1,1.1,0,0,0,3,18ZM3,6A1,1,0,0,0,4,7h9V5H4A1,1,0,0,0,3,6ZM13,20V19h7a1,1,0,0,0,0-2H13V16a1,1,0,0,0-2,0v4a1,1,0,0,0,2,0ZM7,10v1H4a1,1,0,0,0,0,2H7v1a.9.9,0,0,0,1,1,.9.9,0,0,0,1-1V10A.9.9,0,0,0,8,9,.9.9,0,0,0,7,10Zm14,2a1,1,0,0,0-1-1H11v2h9A1,1,0,0,0,21,12ZM16,9a1,1,0,0,0,1-1V7h3a1,1,0,0,0,0-2H17V4a1,1,0,0,0-2,0V8A.9.9,0,0,0,16,9Z"/>',Dl='<path d="M13,14v6a1,1,0,0,0,1,1h6a1.1,1.1,0,0,0,1-1V14a1,1,0,0,0-1-1H14A.9.9,0,0,0,13,14ZM4,21h6a1,1,0,0,0,1-1V14a.9.9,0,0,0-1-1H4a1,1,0,0,0-1,1v6A1.1,1.1,0,0,0,4,21ZM3,4v6a1,1,0,0,0,1,1h6a.9.9,0,0,0,1-1V4a1,1,0,0,0-1-1H4A1.1,1.1,0,0,0,3,4ZM15.9,2.4,11.7,6.6a1.1,1.1,0,0,0,0,1.5l4.2,4.2a1.1,1.1,0,0,0,1.5,0l4.2-4.2a1.1,1.1,0,0,0,0-1.5L17.4,2.4A1.1,1.1,0,0,0,15.9,2.4Z"/>',Nl='<path d="M22.3,13.1,16.7,3.2a1.9,1.9,0,0,0-3.4,0L12.3,5l-.6-.5a3,3,0,0,0-3.4,0L2.5,8.8A3,3,0,0,0,1.4,12l2.3,6.9a2.8,2.8,0,0,0,2.7,1.9h7.2a2.8,2.8,0,0,0,2.7-1.9l1-2.9h3.3a1.9,1.9,0,0,0,1.6-.9A2,2,0,0,0,22.3,13.1Zm-7.9,5.1a.8.8,0,0,1-.8.6H6.4a.8.8,0,0,1-.8-.6L3.3,11.4a.9.9,0,0,1,.3-1L9.5,6.2a.7.7,0,0,1,1,0l.8.6L7.7,13.1a2,2,0,0,0,.1,2,1.9,1.9,0,0,0,1.6.9h5.8ZM9.6,14,15,4.3,20.4,14Z"/>',zl='<path d="m2.1 9.5.2 1.8 2.1-.7v8.2h2.2v-10.5h-1.9z"/><path d="m20.7 12.3a2.5 2.5 0 0 0 1.5-2.4c0-1.7-1.4-2.8-3.5-2.8a5.8 5.8 0 0 0 -3.2 1h-.1l.3 1.9.2-.2a5 5 0 0 1 2.6-.8c.7 0 1.5.1 1.5 1.1s-.7 1.2-2.1 1.2h-1l.3 1.8h.7c2.1 0 2.3.9 2.3 1.5s-1.1 1.4-1.7 1.4a4.3 4.3 0 0 1 -2.7-.8h-.2l-.3 2a6.9 6.9 0 0 0 3.2.8c2.4 0 3.9-1.3 3.9-3.2a2.5 2.5 0 0 0 -1.7-2.5z"/><path d="m10.9 11.9 2.2-2.2c1.2-1.3 1.9-2.1 1.9-3.5s-1.3-3-3.4-3a4.7 4.7 0 0 0 -3.3 1.1h-.1l.3 2.1.2-.2a4.5 4.5 0 0 1 2.7-1.1c.9 0 1.4.4 1.4 1.3s-.4 1.2-1.1 2l-3.7 3.7v1.6h7.2l-.3-1.9z"/>',ql='<path d="m11.6 3.9v6.2h2v-8.1h-1.8l-2.1 1 .2 1.5z"/><path d="m11.5 20.6 1.6-1.6c1-1 1.6-1.7 1.6-2.8s-1.1-2.3-2.7-2.3a4.3 4.3 0 0 0 -2.7.8l.2 1.7a4 4 0 0 1 2.2-.8c.6 0 1 .3 1 .8a2.1 2.1 0 0 1 -.8 1.5l-2.8 2.8v1.4h5.7l-.2-1.5z"/><path d="m17 11h-10a1 1 0 0 0 0 2h10a1 1 0 0 0 0-2z"/>',_l='<path d="m19.5 9h-2.6l1.3-1.2c.9-.9 1.4-1.5 1.4-2.5s-1-2.2-2.5-2.2a4 4 0 0 0 -2.4.7h-.1l.2 1.7h.2a2.9 2.9 0 0 1 1.8-.7c.3 0 .9.1.9.6s-.3.8-.7 1.3l-2.5 2.5v1.4h5.2z"/><path d="m9.2 13-1.2-2.9-2.4.4 2 4.4-3.7 4.8h2.7l2.1-2.9 1.3 3v.1l2.4-.3-2.1-4.7 3.3-4.5.2-.1h-2.7z"/>',Bl='<path d="M17.3,3H6.7A3.8,3.8,0,0,0,3,6.7V17.3A3.8,3.8,0,0,0,6.7,21H17.3A3.8,3.8,0,0,0,21,17.3V6.7A3.8,3.8,0,0,0,17.3,3ZM19,17.3A1.8,1.8,0,0,1,17.3,19H6.7A1.8,1.8,0,0,1,5,17.3V6.7A1.8,1.8,0,0,1,6.7,5H17.3A1.8,1.8,0,0,1,19,6.7Z"/><circle cx="8.5" cy="8.5" r="1.5"/><circle cx="15.5" cy="8.5" r="1.5"/><circle cx="8.5" cy="15.5" r="1.5"/><circle cx="12" cy="12" r="1.5"/><circle cx="15.5" cy="15.5" r="1.5"/>',Hl='<path d="M12.5,8a10.4,10.4,0,0,0-6.9,2.6L3.7,8.7a1,1,0,0,0-1.4,0,.9.9,0,0,0-.3.7V15a.9.9,0,0,0,1,1H8.6a1,1,0,0,0,1-1,.9.9,0,0,0-.3-.7L7.4,12.4a8,8,0,0,1,11.3,1,8.6,8.6,0,0,1,1,1.6,1.2,1.2,0,0,0,1.5.6,1.1,1.1,0,0,0,.9-1.5v-.2A10.7,10.7,0,0,0,12.5,8Z"/>',Ul='<path d="M18.4,10.6a10.5,10.5,0,0,0-14.8,1,11.4,11.4,0,0,0-1.5,2.3,1.2,1.2,0,0,0,.6,1.7h.1A1.2,1.2,0,0,0,4.3,15,8,8,0,0,1,15,11.3a9.1,9.1,0,0,1,1.6,1.1l-1.9,1.9a1,1,0,0,0,0,1.4.9.9,0,0,0,.7.3H21a.9.9,0,0,0,1-1V9.4a1,1,0,0,0-1-1,.9.9,0,0,0-.7.3Z"/>',Zl='<path d="M20,2H4A2,2,0,0,0,2,4V20a2,2,0,0,0,2,2H20a2,2,0,0,0,2-2V4A2,2,0,0,0,20,2ZM8,20H4V16H8Zm0-6H4V10H8ZM8,8H4V4H8Zm6,12H10V16h4Zm0-6H10V10h4Zm0-6H10V4h4Zm6,12H16V16h4Zm0-6H16V10h4Zm0-6H16V4h4Z"/>',Fl='<path d="m13.4 15.5 4.4 4.4a1.5 1.5 0 0 0 2.1 0 1.4 1.4 0 0 0 0-2.1l-4.4-4.4z"/><path d="m16.3 9.8a3.6 3.6 0 0 0 3.1-.4 3.1 3.1 0 0 0 1.5-2.3 2.7 2.7 0 0 0 -.2-2l-2.4 2.4-1.8-1.8 2.4-2.4a3.4 3.4 0 0 0 -2-.3 3.5 3.5 0 0 0 -2.3 1.6 3.6 3.6 0 0 0 -.4 3.1l-2.2 2.2-1.7-1.7a1 1 0 0 0 0-1.4l-.5-.6 2.3-2.3a3.5 3.5 0 0 0 -2.3-.9 3.1 3.1 0 0 0 -2.2.9l-2.9 2.9a1 1 0 0 0 0 1.4l.5.5h-1.7l-.5.2a.7.7 0 0 0 0 1l2 2a.7.7 0 0 0 1 0 .8.8 0 0 0 .2-.5v-1.7l.6.5a1 1 0 0 0 1.4 0l1.7 1.8-5.8 5.8a1.4 1.4 0 0 0 0 2.1 1.4 1.4 0 0 0 2.1 0l5.4-5.3z"/>',jl='<path d="M22,5V3a.9.9,0,0,0-1-1H19a.9.9,0,0,0-1,1H6A.9.9,0,0,0,5,2H3A.9.9,0,0,0,2,3V5A.9.9,0,0,0,3,6V18a.9.9,0,0,0-1,1v2a.9.9,0,0,0,1,1H5a.9.9,0,0,0,1-1H18a.9.9,0,0,0,1,1h2a.9.9,0,0,0,1-1V19a.9.9,0,0,0-1-1V6A.9.9,0,0,0,22,5ZM19,18a.9.9,0,0,0-1,1H6a.9.9,0,0,0-1-1V6A.9.9,0,0,0,6,5H18a.9.9,0,0,0,1,1Z"/><path d="M15,7H9A.9.9,0,0,0,8,8,.9.9,0,0,0,9,9h2v7a1,1,0,0,0,2,0V9h2a.9.9,0,0,0,1-1A.9.9,0,0,0,15,7Z"/>',Wl='<path d="M12,3a9,9,0,0,0,0,18,1.5,1.5,0,0,0,1.5-1.5,1.3,1.3,0,0,0-.4-1,1.8,1.8,0,0,1-.4-1A1.5,1.5,0,0,1,14.2,16H16a5,5,0,0,0,5-5C21,6.6,17,3,12,3ZM6.5,12a1.5,1.5,0,0,1,0-3,1.5,1.5,0,0,1,0,3Zm3-4A1.5,1.5,0,0,1,8,6.5a1.5,1.5,0,0,1,3,0A1.5,1.5,0,0,1,9.5,8Zm5,0A1.5,1.5,0,0,1,13,6.5a1.5,1.5,0,0,1,3,0A1.5,1.5,0,0,1,14.5,8Zm3,4A1.5,1.5,0,1,1,19,10.5,1.5,1.5,0,0,1,17.5,12Z"/>',Kl='<path d="m15.9 11.8-3.7-3.7-7.8 7.7-1.2 1.3c-.2.1-.2.2-.2.4v3a.5.5 0 0 0 .5.5h3c.2 0 .3 0 .4-.2l2.8-2.7 1.1-1.2 1.7-1.6z"/><path d="m21.6 10.4c0-.4-.5-.9-.9-1.4s-.7-.6-.7-1 .4-.6.7-1h.1a1.4 1.4 0 0 0 .2-.6.9.9 0 0 0 -.3-.6l-2.3-2.5h-.1l-.6-.3a.9.9 0 0 0 -.7.3l-.5.5-3.4 3.3 3.8 3.8 1.4-1.4.9.9-3.5 3.6a.8.8 0 0 0 -.3.7 1.1 1.1 0 0 0 1 1 1.1 1.1 0 0 0 .7-.3l3.4-3.5c.6-.5 1.1-1 1.1-1.5z"/>',Xl='<path d="M22.2,16.5,15.9,14c-.2,0-.4,0-.5.2s-.2.3-.1.5l.6,1.3H8V8.1l1.3.6h.2l.3-.2c.2-.1.2-.3.2-.5L7.5,1.8a.6.6,0,0,0-1,0L4,8.1c0,.2,0,.4.2.5s.3.2.5.1L6,8.1V16H2a1,1,0,0,0,0,2H6v4a.9.9,0,0,0,1,1,.9.9,0,0,0,1-1V18h7.9l-.6,1.3c-.1.2-.1.4.1.5a.5.5,0,0,0,.4.2h.1l6.3-2.5a.6.6,0,0,0,0-1Z"/>',Yl='<path d="M21.2,16H19V10.5a1,1,0,0,0-1-1,.9.9,0,0,0-1,1V16H14.8a1,1,0,0,0-.8,1.7L17.3,21a1.2,1.2,0,0,0,1.4,0L22,17.7A1,1,0,0,0,21.2,16Z"/><path d="M12.8,17H6a.5.5,0,0,1-.4-.8l1.9-2.6a.6.6,0,0,1,.9,0L10,16l2.6-3.5a.5.5,0,0,1,.8,0l2,2.5H16V10.5a2,2,0,0,1,2-2,1.7,1.7,0,0,1,1,.3V5a2,2,0,0,0-2-2H5A2,2,0,0,0,3,5V17a2,2,0,0,0,2,2h8.9l-.6-.6A2.4,2.4,0,0,1,12.8,17Z"/>',Ql='<path d="M10.5,8.5V6a.9.9,0,0,0-1-1,.9.9,0,0,0-1,1V8.5H6a.9.9,0,0,0-1,1,.9.9,0,0,0,1,1H8.5V13a.9.9,0,0,0,1,1,.9.9,0,0,0,1-1V10.5H13a.9.9,0,0,0,1-1,.9.9,0,0,0-1-1Z"/><path d="M21.6,19.4l-4-4a1.6,1.6,0,0,0-1.5-.3l-.8-.9A7,7,0,0,0,17,9.5,7.6,7.6,0,0,0,9.5,2,7.6,7.6,0,0,0,2,9.5,7.6,7.6,0,0,0,9.5,17a7,7,0,0,0,4.7-1.7l.9.8a1.6,1.6,0,0,0,.3,1.5l4,4a1.7,1.7,0,0,0,2.2,0A1.8,1.8,0,0,0,21.6,19.4ZM9.5,15A5.5,5.5,0,0,1,4,9.5,5.5,5.5,0,0,1,9.5,4,5.5,5.5,0,0,1,15,9.5,5.5,5.5,0,0,1,9.5,15Z"/>',Jl='<path d="M6,8.5a.9.9,0,0,0-1,1,.9.9,0,0,0,1,1h7a.9.9,0,0,0,1-1,.9.9,0,0,0-1-1Z"/><path d="M21.6,19.4l-4-4a1.6,1.6,0,0,0-1.5-.3l-.8-.9A7,7,0,0,0,17,9.5,7.6,7.6,0,0,0,9.5,2,7.6,7.6,0,0,0,2,9.5,7.6,7.6,0,0,0,9.5,17a7,7,0,0,0,4.7-1.7l.9.8a1.6,1.6,0,0,0,.3,1.5l4,4a1.7,1.7,0,0,0,2.2,0A1.8,1.8,0,0,0,21.6,19.4ZM9.5,15A5.5,5.5,0,0,1,4,9.5,5.5,5.5,0,0,1,9.5,4,5.5,5.5,0,0,1,15,9.5,5.5,5.5,0,0,1,9.5,15Z"/>',tc='<path d="M10.5,9h3a.5.5,0,0,0,.5-.5V6h1.8a.4.4,0,0,0,.3-.8L12.3,1.4a.5.5,0,0,0-.7,0L7.8,5.2c-.3.3,0,.8.4.8H10V8.5A.5.5,0,0,0,10.5,9Zm-2,1H6V8.2a.4.4,0,0,0-.8-.3L1.4,11.6a.6.6,0,0,0,0,.8l3.8,3.7a.4.4,0,0,0,.8-.3V14H8.5a.5.5,0,0,0,.5-.5v-3A.5.5,0,0,0,8.5,10Zm14.1,1.6L18.9,7.9a.5.5,0,0,0-.9.3V10H15.5a.5.5,0,0,0-.5.5v3a.5.5,0,0,0,.5.5H18v1.8a.5.5,0,0,0,.9.3l3.7-3.8C22.8,12.2,22.8,11.8,22.6,11.6ZM13.5,15h-3a.5.5,0,0,0-.5.5V18H8.2a.5.5,0,0,0-.3.9l3.7,3.7a.6.6,0,0,0,.8,0l3.7-3.8a.4.4,0,0,0-.3-.8H14V15.5A.5.5,0,0,0,13.5,15Z"/>',ec='<path d="M8.3,3.2,17.8,12a.8.8,0,0,1-.5,1.3l-4.1.4L16,19.9a1.2,1.2,0,0,1-.6,1.6h0a1.2,1.2,0,0,1-1.6-.6l-2.7-6.3L8.3,17.3A.8.8,0,0,1,7,16.8V3.8A.8.8,0,0,1,8.3,3.2Z"/>',ic='<path d="m9.7 9.5 4.3 4.3-6.6 6.5-.7-.7-1.4 1.4a2.1 2.1 0 0 1 -2.9 0 1.9 1.9 0 0 1 0-2.8l1.5-1.5-.8-.7zm11.6-5.8-1.5-1.5a1.9 1.9 0 0 0 -2.8 0l-6.2 6.2 4.2 4.3 6.3-6.2a2.1 2.1 0 0 0 0-2.8z" fill-rule="evenodd"/>',sc='<path d="M10.2,9.5l-5.9,6a1.9,1.9,0,0,0,.1,2.8L.8,22H6.4l.8-.8a1.8,1.8,0,0,0,2.7.1l6-6.1Zm12.5-4L19.9,2.6a2.1,2.1,0,0,0-2.9,0L11.3,8.4l5.6,5.8,5.7-5.8A2.1,2.1,0,0,0,22.7,5.5Z" fill-rule="evenodd"/>',nc='<path d="m17.7 2.1-1.1 1.1 1.6 1.6a.7.7 0 0 1 0 1 .8.8 0 0 1 -1.1 0l-1.6-1.6-1.4 1.4.9.9a.8.8 0 0 1 -1.1 1.1l-.8-.9-1.5 1.4 1.6 1.6a.8.8 0 0 1 0 1.1.7.7 0 0 1 -1 0l-1.6-1.6-1.4 1.4.9.9a.9.9 0 0 1 0 1 .8.8 0 0 1 -1.1 0l-.9-.9-1.4 1.5 1.6 1.6a.7.7 0 0 1 0 1 .8.8 0 0 1 -1.1 0l-1.6-1.6-1.4 1.4.9.9a.8.8 0 0 1 -1.1 1.1l-.8-.9-1.1 1.1a1 1 0 0 0 0 1.4l2.8 2.8a1 1 0 0 0 1.4 0l15.6-15.6a1 1 0 0 0 0-1.4l-2.8-2.8a1 1 0 0 0 -1.4 0z"/>',oc='<path d="M20.4,8.4,16.6,4.6A2.2,2.2,0,0,0,15.1,4a2,2,0,0,0-1.4.6L3.6,14.7a2.1,2.1,0,0,0,0,2.9L6,20h5.7l8.7-8.7A2.1,2.1,0,0,0,20.4,8.4Z"/><path d="M20,18H16l-2,2h6a1,1,0,0,0,0-2Z"/>',rc='<path d="M21,5H19V3a.9.9,0,0,0-1-1h0a.9.9,0,0,0-1,1V5H15a.9.9,0,0,0-1,1h0a.9.9,0,0,0,1,1h2V9a.9.9,0,0,0,1,1h0a.9.9,0,0,0,1-1V7h2a.9.9,0,0,0,1-1h0A.9.9,0,0,0,21,5ZM16,9V8H15a2.1,2.1,0,0,1-2-2,1.7,1.7,0,0,1,.3-1H5A2,2,0,0,0,3,7V19a2,2,0,0,0,2,2H17a2,2,0,0,0,2-2V10.7a1.7,1.7,0,0,1-1,.3A2,2,0,0,1,16,9Zm0,10H6c-.4,0-.7-.5-.4-.8l2-2.6a.5.5,0,0,1,.8,0L10,18l2.6-3.5a.5.5,0,0,1,.8,0l3,3.7A.5.5,0,0,1,16,19Z"/>',ac='<path d="M5.8,5.2c.1-.5.4-.7,1-.7H8.1a.9.9,0,0,1,1,.7l4.7,13.3a.7.7,0,0,1-.7,1h-1a1,1,0,0,1-1-.7L10,15.7H4.8l-1,3.1a1,1,0,0,1-1,.7h-1c-.7,0-.9-.4-.7-1Zm3.6,8.2L8,9.4c-.2-.8-.5-2.3-.5-2.3H7.4a19.8,19.8,0,0,1-.6,2.3l-1.3,4Z"/><path d="M20.2,13.6h.4v-.2c0-1.3-.8-1.7-1.8-1.7a4.3,4.3,0,0,0-1.9.5c-.5.2-.9.1-1.1-.3l-.2-.4a.7.7,0,0,1,.3-1A6.9,6.9,0,0,1,19,9.7c2.5,0,4,1.4,4,3.8v5.2a.7.7,0,0,1-.8.8h-.6a.7.7,0,0,1-.8-.8v-.8h0a3.5,3.5,0,0,1-3,1.8,3,3,0,0,1-3.2-2.9C14.6,14,18.1,13.6,20.2,13.6Zm-1.8,4.3a2.4,2.4,0,0,0,2.2-2.5V15h-.4c-1.2,0-3.2.2-3.2,1.6A1.3,1.3,0,0,0,18.4,17.9Z"/>',lc='<path d="M20.5,1A2.5,2.5,0,0,0,18,3.5a2.9,2.9,0,0,0,.2.9L4.4,18.2,3.5,18a2.5,2.5,0,0,0,0,5A2.5,2.5,0,0,0,6,20.5a2.9,2.9,0,0,0-.2-.9L19.6,5.8l.9.2A2.5,2.5,0,0,0,23,3.5,2.5,2.5,0,0,0,20.5,1Z" opacity=".4"/><circle cx="12" cy="12" r="2.5"/>',cc='<path d="M21,22a.9.9,0,0,1-.7-.3l-18-18a1,1,0,0,1,0-1.4,1,1,0,0,1,1.4,0l18,18a1,1,0,0,1,0,1.4A.9.9,0,0,1,21,22Z"/><path d="M20.5,1A2.5,2.5,0,0,0,18,3.5a2.9,2.9,0,0,0,.2.9L4.4,18.2,3.5,18a2.5,2.5,0,0,0,0,5A2.5,2.5,0,0,0,6,20.5a2.9,2.9,0,0,0-.2-.9L19.6,5.8l.9.2A2.5,2.5,0,0,0,23,3.5,2.5,2.5,0,0,0,20.5,1Z" opacity=".4"/>',hc='<path d="M3,23a1.2,1.2,0,0,1-.8-.4,1.1,1.1,0,0,1,.2-1.4l18-12a1,1,0,1,1,1.2,1.6l-18,12Z" opacity=".4"/><path d="M21.8,2.4a1.1,1.1,0,0,0-1.4-.2L13.3,6.9A1.8,1.8,0,0,0,12,6.5,2.5,2.5,0,0,0,9.5,9v.4L2.4,14.2a1.1,1.1,0,0,0-.2,1.4A1.2,1.2,0,0,0,3,16l.6-.2,7.1-4.7a1.8,1.8,0,0,0,1.3.4A2.5,2.5,0,0,0,14.5,9V8.6l7.1-4.8A1.1,1.1,0,0,0,21.8,2.4Z"/>',dc='<path d="M3,23a1.2,1.2,0,0,1-.8-.4,1.1,1.1,0,0,1,.2-1.4l18-12a1,1,0,1,1,1.2,1.6l-18,12Z" opacity=".4"/><path d="M16.8,20.4,8.1,7.3A1.8,1.8,0,0,0,8.5,6,2.5,2.5,0,0,0,6,3.5H5.6L4.8,2.4a1.1,1.1,0,0,0-1.4-.2,1.1,1.1,0,0,0-.2,1.4l.7,1.1A1.8,1.8,0,0,0,3.5,6,2.5,2.5,0,0,0,6,8.5h.4l8.8,13.1a1.2,1.2,0,0,0,.8.4l.6-.2A1.1,1.1,0,0,0,16.8,20.4Z"/>',pc='<path d="M10,22.9A8.9,8.9,0,1,1,18.9,14,8.9,8.9,0,0,1,10,22.9Zm0-16A7.1,7.1,0,1,0,17.1,14,7.1,7.1,0,0,0,10,6.9Z" opacity=".4"/><path d="M22.4,9.4,15.5,6.5h0A2.5,2.5,0,0,0,13,4a2.9,2.9,0,0,0-1.8.7L2.4,1.1a1,1,0,0,0-.8,1.8l8.9,3.7A2.6,2.6,0,0,0,13,9a2.8,2.8,0,0,0,1.7-.7l6.9,2.9H22a.9.9,0,0,0,.9-.6A1,1,0,0,0,22.4,9.4Z"/>',uc='<path d="M4,23a1,1,0,0,1-1-.8l-2-8a1.3,1.3,0,0,1,.1-.6l6-12a.9.9,0,0,1,1.2-.5l11,4a.8.8,0,0,1,.7.7l3,13a1.3,1.3,0,0,1-.2.8c-.1.2-.4.3-.6.4l-18,3Zm-.9-8.9,1.6,6.8,16.1-2.7L18.1,6.8,8.5,3.2Z" opacity=".4"/><circle cx="12.5" cy="13" r="2.5"/>',fc='<path d="M12,23A11,11,0,1,1,23,12,11,11,0,0,1,12,23ZM12,3a9,9,0,1,0,9,9A9,9,0,0,0,12,3Z"/><path d="M4.7,20,3.6,18.5l9.7-17H15l7.4,13L21.7,16ZM14.1,4,6.5,17.5,20,14.3Z" opacity=".4"/>',mc='<path d="M13.9,19.2a6.5,6.5,0,1,1,6.4-6.4A6.4,6.4,0,0,1,13.9,19.2Zm0-10.9a4.5,4.5,0,1,0,4.4,4.5A4.5,4.5,0,0,0,13.9,8.3Z"/><path d="M2,23a.9.9,0,0,1-.8-.4,1.1,1.1,0,0,1-.1-1.1l12-20a1.1,1.1,0,0,1,1.8,0l8,14a1.4,1.4,0,0,1,0,.9.9.9,0,0,1-.6.6l-20,6ZM14,4,4.2,20.3l16.3-4.9Z" opacity=".4"/>',gc='<path d="M17,13H7a1,1,0,0,1,0-2H17a1,1,0,0,1,0,2Z"/><rect x="8" y="2" width="8" height="8" rx="1" opacity=".4"/><rect x="8" y="14" width="8" height="8" rx="1" opacity=".4"/>',yc='<rect height="7" opacity=".4" rx="1" width="7" x="14" y="3"/><rect height="14" opacity=".4" rx="1" width="9" x="4" y="7"/>',vc='<rect x="12" y="7" width="8" height="12" rx="1" opacity=".4"/><path d="M8,21a1,1,0,0,1-.9-.7L4.6,12.9l-.9.8a1,1,0,0,1-1.4,0,1,1,0,0,1,0-1.4l2-2a.8.8,0,0,1,.9-.3,1,1,0,0,1,.7.7l1.7,4.8L9,3.9A1.1,1.1,0,0,1,10,3H21a.9.9,0,0,1,1,1,.9.9,0,0,1-1,1H10.9L9,20.1a1.1,1.1,0,0,1-.9.9Z"/>',bc='<path d="M19,7H9A2,2,0,0,0,7,9V19a2,2,0,0,0,2,2H19a2,2,0,0,0,2-2V9A2,2,0,0,0,19,7Zm-1,8H15v3a1.1,1.1,0,0,1-1,1,1.1,1.1,0,0,1-1-1V15H10a1.1,1.1,0,0,1-1-1,1.1,1.1,0,0,1,1-1h3V10a1.1,1.1,0,0,1,1-1,1.1,1.1,0,0,1,1,1v3h3a1.1,1.1,0,0,1,1,1A1.1,1.1,0,0,1,18,15Z"/><path d="M17,3H5A2,2,0,0,0,3,5V17a2,2,0,0,0,2,2V6A1.1,1.1,0,0,1,6,5H19A2,2,0,0,0,17,3Z"/>',wc='<path d="M6,19a2,2,0,0,0,2,2h8a2,2,0,0,0,2-2V7H6Zm3.2-6.4a1,1,0,1,1,1.4-1.4L12,12.6l1.4-1.4a1,1,0,1,1,1.4,1.4L13.4,14l1.4,1.4a1,1,0,1,1-1.4,1.4L12,15.4l-1.4,1.4a1,1,0,1,1-1.4-1.4L10.6,14ZM18,4H15.5l-.7-.7a.9.9,0,0,0-.7-.3H9.9a.9.9,0,0,0-.7.3L8.5,4H6A.9.9,0,0,0,5,5,.9.9,0,0,0,6,6H18a1,1,0,0,0,0-2Z"/>',xc='<path d="M19.5,2A2.5,2.5,0,0,0,17,4.5a2.9,2.9,0,0,0,.2.9L5.4,17.2,4.5,17a2.5,2.5,0,0,0,0,5A2.5,2.5,0,0,0,7,19.5a2.9,2.9,0,0,0-.2-.9L18.6,6.8l.9.2A2.5,2.5,0,0,0,22,4.5,2.5,2.5,0,0,0,19.5,2Z"/>',$c='<circle cx="12" cy="12" r="2.5"/><path d="M14.4,2.3A2.6,2.6,0,0,0,12,.5,2.6,2.6,0,0,0,9.6,2.3a10,10,0,1,0,4.8,0ZM12,20A8,8,0,0,1,9.9,4.3a2.4,2.4,0,0,0,4.2,0A8,8,0,0,1,12,20Z"/>',Tc='<path d="M7,14.4,4.9,10.1C4.6,9.5,5,9,5.7,9H6.8a1,1,0,0,1,1,.6L8.7,12l.2.7H9l.5-.7,1.8-2.4A1.3,1.3,0,0,1,12.4,9h1.1c.8,0,.9.5.4,1.1l-3.6,4.3,2.2,4.5a.8.8,0,0,1-.8,1.1H10.6a.8.8,0,0,1-.9-.6L8.6,16.8a3.9,3.9,0,0,1-.2-.6H8.3a2.9,2.9,0,0,1-.4.6l-2,2.6a1.4,1.4,0,0,1-1.2.6h-1c-.7,0-.9-.5-.4-1.1Z"/><path d="M15.5,10.2c0-3,3.4-3.5,3.4-4.6a.8.8,0,0,0-.9-.8,1.2,1.2,0,0,0-.8.4c-.3.3-.6.4-.9.1L15.9,5c-.3-.3-.4-.5-.2-.8A3.1,3.1,0,0,1,18.2,3a2.4,2.4,0,0,1,2.7,2.4c0,2.5-3.2,2.9-3.3,3.9h2.8c.4,0,.6.3.6.7v.4a.5.5,0,0,1-.6.6H16.1a.5.5,0,0,1-.6-.6Z"/>',Sc='<path d="m20.1 8.2-1.4-1.5 2.2-2.2a1 1 0 0 0 0-1.4 1 1 0 0 0 -1.4 0l-2.2 2.2-1.5-1.4a.4.4 0 0 0 -.8.3v4.3a.5.5 0 0 0 .5.5h4.3a.4.4 0 0 0 .3-.8z"/><path d="m8.2 3.9-1.5 1.4-2.2-2.2a1 1 0 0 0 -1.4 0 1 1 0 0 0 0 1.4l2.2 2.2-1.4 1.4a.5.5 0 0 0 .3.9h4.3a.5.5 0 0 0 .5-.5v-4.3a.4.4 0 0 0 -.8-.3z"/><path d="m3.9 15.9 1.4 1.4-2.2 2.2a1 1 0 0 0 0 1.4 1 1 0 0 0 1.4 0l2.2-2.2 1.4 1.5a.6.6 0 0 0 .9-.4v-4.3a.5.5 0 0 0 -.5-.5h-4.3a.5.5 0 0 0 -.3.9z"/><path d="m15.9 20.1 1.4-1.4 2.2 2.2a1 1 0 0 0 1.4 0 1 1 0 0 0 0-1.4l-2.2-2.2 1.4-1.4a.5.5 0 0 0 -.3-.9h-4.3a.5.5 0 0 0 -.5.5v4.3a.5.5 0 0 0 .9.3z"/>',Mc='<path d="m15.9 3.8 1.4 1.5-2.2 2.2a1 1 0 0 0 0 1.4 1 1 0 0 0 1.4 0l2.2-2.2 1.5 1.4a.4.4 0 0 0 .8-.3v-4.3a.5.5 0 0 0 -.5-.5h-4.3a.4.4 0 0 0 -.3.8zm-12.1 4.3 1.5-1.4 2.2 2.2a1 1 0 0 0 1.4 0 1 1 0 0 0 0-1.4l-2.2-2.2 1.4-1.4a.5.5 0 0 0 -.3-.9h-4.3a.5.5 0 0 0 -.5.5v4.3a.4.4 0 0 0 .8.3zm4.3 12-1.4-1.4 2.2-2.2a1 1 0 0 0 0-1.4 1 1 0 0 0 -1.4 0l-2.2 2.2-1.4-1.5a.6.6 0 0 0 -.9.4v4.3a.5.5 0 0 0 .5.5h4.3a.5.5 0 0 0 .3-.9zm12-4.2-1.4 1.4-2.2-2.2a1 1 0 0 0 -1.4 0 1 1 0 0 0 0 1.4l2.2 2.2-1.4 1.4a.5.5 0 0 0 .3.9h4.3a.5.5 0 0 0 .5-.5v-4.3a.5.5 0 0 0 -.9-.3z"/>',Pc='<path d="m12 2c-3 5-8 7-8 12a4.3 4.3 0 0 0 4 4 3.7 3.7 0 0 0 3-1s.3 2-2 5h6c-2-3-2-5-2-5a3.7 3.7 0 0 0 3 1 4.3 4.3 0 0 0 4-4c0-5-5-7-8-12z"/>',kc='<path d="M12,2a4.4,4.4,0,0,1,4.3,4.2A4.5,4.5,0,0,1,14,10a6.7,6.7,0,0,1,2.5-.5A4.3,4.3,0,0,1,21,13.8,4.2,4.2,0,0,1,16.5,18,8.6,8.6,0,0,1,13,17s-.3,2,2,5H9c2.3-3,2-5,2-5a8.6,8.6,0,0,1-3.5,1A4.2,4.2,0,0,1,3,13.8,4.3,4.3,0,0,1,7.5,9.5,6.7,6.7,0,0,1,10,10,4.5,4.5,0,0,1,7.7,6.2,4.4,4.4,0,0,1,12,2Z"/>',Cc='<path d="M12,21.4,10.6,20C5.4,15.4,2,12.3,2,8.5A5.4,5.4,0,0,1,7.5,3,6,6,0,0,1,12,5.1,6,6,0,0,1,16.5,3,5.4,5.4,0,0,1,22,8.5c0,3.8-3.4,6.9-8.6,11.5Z"/>',Ac='<path d="m19 12-7 10-7-10 7-10"/>',Vc='<path d="M15.2,11.6h0a3.8,3.8,0,0,0,2-3.4c0-2.6-2.1-4.1-5-4.1H7.5a.9.9,0,0,0-1,1V19a.9.9,0,0,0,1,1h4.8c2.9,0,5.5-1.4,5.5-4.6A3.7,3.7,0,0,0,15.2,11.6ZM9.4,6.5h2.8a1.8,1.8,0,0,1,2,2,1.9,1.9,0,0,1-2,2H9.4Zm3.1,11H9.4V12.9h3.1a2.1,2.1,0,0,1,2.3,2.3A2.2,2.2,0,0,1,12.5,17.5Z"/>',Ec='<path d="m14.5 19v-.4a.8.8 0 0 0 -.8-1h-1.4l2.3-11.2h1.6a1.3 1.3 0 0 0 1.2-1v-.4a.8.8 0 0 0 -.8-1h-6a1.2 1.2 0 0 0 -1.1 1v-.2.8-.2a.8.8 0 0 0 .8 1h1.5l-2.4 11.2h-1.6a1.3 1.3 0 0 0 -1.2 1v-.2.8-.2a.8.8 0 0 0 .8 1h6a1.2 1.2 0 0 0 1.1-1z"/>',Lc='<path d="M5,20H5a1,1,0,0,0,1,1H18a1.1,1.1,0,0,0,1-1h0a1.1,1.1,0,0,0-1-1H6A1,1,0,0,0,5,20Z"/><path d="M17,3h-.7a1,1,0,0,0-1,1v8.5A3,3,0,0,1,12,15.7a3,3,0,0,1-3.3-3.2V4a1,1,0,0,0-1-1H7A.9.9,0,0,0,6,4v8.6c0,3.3,2.4,5.6,6,5.6s6-2.3,6-5.6V4A.9.9,0,0,0,17,3Z"/>',Oc='<path d="M18,2H10A4,4,0,0,0,6,6a4,4,0,0,0-4,4v8a4,4,0,0,0,4,4h8a4,4,0,0,0,4-4,4,4,0,0,0,4-4V6A4,4,0,0,0,18,2ZM16,18a2,2,0,0,1-2,2H6a2,2,0,0,1-2-2V10A2,2,0,0,1,6,8h8a2,2,0,0,1,2,2Zm4-4a2,2,0,0,1-2,2V10a4,4,0,0,0-4-4H8a2,2,0,0,1,2-2h8a2,2,0,0,1,2,2Z"/>',b={tiles:Rl,controls:Gl,widgets:Dl,geometry:Nl,numbers:zl,fractions:ql,algebra:_l,probability:Bl,undo:Hl,redo:Ul,grid:Zl,construction:Fl,text:jl,color:Wl,pen:Kl,axes:Xl,screenshot:Yl,"zoom-in":Ql,"zoom-out":Jl,move:tc,cursor:ec,marker:ic,highlighter:sc,ruler:nc,eraser:oc,"add-image":rc,"text-alt":ac,"geo-midpoint":lc,"geo-perp-bisector":cc,"geo-parallel":hc,"geo-perpendicular":dc,"geo-tangent":pc,"geo-centroid":uc,"geo-circumcircle":fc,"geo-incircle":mc,fraction:gc,power:yc,sqrt:vc,copy:bc,delete:wc,"geo-line":xc,"geo-circle":$c,equation:Tc,"fullscreen-reverse":Sc,fullscreen:Mc,spades:Pc,clubs:kc,hearts:Cc,diamonds:Ac,bold:Vc,italic:Ec,underlined:Lc,quiz:Oc};function Oe(s=10){return Math.random().toString(36).substr(2,s)}function D(s,...t){return t.includes(s)}function Ni(s={},t){for(let e of Object.keys(t))Object.prototype.hasOwnProperty.call(s,e)||(s[e]=t[e]);return s}var Ic=(s,t)=>s.concat(t);function Gs(s,t,e=Ic){for(let i of Object.keys(t))i in s&&Array.isArray(s[i])&&Array.isArray(t[i])?s[i]=e(s[i],t[i]):i in s&&s[i]instanceof Object&&t[i]instanceof Object?Gs(s[i],t[i]):s[i]=t[i]}function zi(s,t=0){return t?+setTimeout(s,t):(s(),0)}function qi(s){return new Promise(t=>setTimeout(t,s))}function Ds(){let s=()=>{},t=()=>{},e=new Promise((i,n)=>{s=i,t=n});return e.catch(i=>i),{promise:e,resolve:s,reject:t}}function _i(s){let t=new Map;return function(...e){let i=e.join("--");return t.has(i)||t.set(i,s(...e)),t.get(i)}}function Ns(s,t=0,e=!1){let i=!1,n=!1;return(...o)=>{i?n=!0:(e?n=!0:s(...o),i=!0,setTimeout(()=>{n&&s(...o),i=n=!1},t))}}function zs(s,t={}){if(!s)return t;try{return JSON.parse(s)||t}catch(e){return t}}function Ie(s,t){return new Array(t).fill(s)}function N(s,t){let e=[];for(let i=0;i<t;++i)e.push(s(i));return e}function L(s,t=0){return s[s.length-1-t]}function q(s){return s.reduce((t,e)=>t+e,0)}function Bi(s,t,e=!1){return s.slice(0).sort((i,n)=>{let o=t(i),r=t(n);return o<r?e?1:-1:o>r?e?-1:1:0})}function Ko(s){let t=0;return()=>s[t++%s.length]}function Et(s){return s.filter((t,e)=>s.indexOf(t)===e)}function Ft(s){return s.reduce((t,e)=>t.concat(Array.isArray(e)?Ft(e):e),[])}function qs(s,t){let e=[];for(let i=0;i<s.length;i+=t)e.push(s.slice(i,i+t));return e}function Hi(...s){return s.reduce((t,e)=>t.concat(e),[])}function ct(s,t=/\s+/){return s?s.trim().split(t):[]}function Xo(s){return s.toLowerCase().replace(/^-/,"").replace(/-(.)/g,(t,e)=>e.toUpperCase())}var te=class{constructor(){this.events=new Map}on(t,e){for(let i of ct(t))this.events.has(i)||this.events.set(i,[]),this.events.get(i).push(e)}one(t,e){let i=n=>{this.off(t,i),e(n)};this.on(t,i)}off(t,e){for(let i of ct(t))this.events.has(i)&&this.events.set(i,this.events.get(i).filter(n=>n!==e))}trigger(t,e){for(let i of ct(t))if(this.events.has(i))for(let n of this.events.get(i))n(e)}},Rc=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Gc=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Dc=/rgba?\(([0-9,]+), ?([0-9,]+), ?([0-9,]+)(, ?([0-9,]+))?\)/,Nc=["#22ab24","#009ea6","#0f82f2","#6d3bbf","#cd0e66","#eb4726","#fd8c00"];function zc(s){return s.length===1?"0"+s:s}function Yo(s,t){if(t<=0)return V.from(s[0]);if(t>=1)return V.from(L(s));let e=Math.floor(t*(s.length-1)),i=t*(s.length-1)-e;return V.mix(s[e+1],s[e],i)}function _s(s,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+(t-s)*6*e:e<1/2?t:e<2/3?s+(t-s)*(2/3-e)*6:s}var V=class{constructor(t,e,i,n=1){this.r=t,this.g=e,this.b=i,this.a=n}get hex(){let t=[this.r,this.g,this.b].map(e=>zc(Math.round(e).toString(16)));return"#"+t.join("")}get rgb(){let t=[this.r,this.g,this.b].map(e=>Math.round(e)).join(",");return"rgba("+t+","+this.a+")"}get hsl(){let t=this.r/255,e=this.g/255,i=this.b/255,n=Math.max(t,e,i),o=Math.min(t,e,i),r=(o+n)/2,a=n-o;if(n===o)return[0,0,Math.round(r*100)];let l=t===n?(e-i)/a:e===n?2+(i-t)/a:4+(t-e)/a;l=Math.min(l*60,360),l<0&&(l+=360);let h=r<=.5?a/(n+o):a/(2-n-o);return[Math.round(l),Math.round(h*100),Math.round(r*100)]}get chroma(){return Math.max(this.r,this.g,this.b)-Math.min(this.r,this.g,this.b)}toString(){return this.rgb}copy(){return new V(this.r,this.g,this.b,this.a)}static from(t){return typeof t!="string"?t:t.startsWith("#")?V.fromHex(t):V.fromRgb(t)}static fromRgb(t){let e=t.match(Dc);if(!e)return new V(0,0,0);let i=e[4]?+e[5]||0:1;return new V(+e[1],+e[2],+e[3],i)}static fromHex(t){t=t.replace(Rc,function(i,n,o,r){return n+n+o+o+r+r});let e=Gc.exec(t);return e?new V(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)):new V(0,0,0)}static fromHsl(t,e,i){if(t/=360,e/=100,i/=100,e===0){let h=Math.round(i*255);return new V(h,h,h)}let n=i<.5?i*(1+e):i+e-i*e,o=2*i-n,r=_s(o,n,t+1/3),a=_s(o,n,t),l=_s(o,n,t-1/3);return new V(Math.round(r*255),Math.round(a*255),Math.round(l*255))}static rainbow(t){return N(e=>Yo(Nc,e/(t-1)),t)}static gradient(t,e){return N(i=>Yo(t,i/(e-1)),e)}static shades(t,e,i=.5){let n=V.mix("#fff",t,i),o=V.mix("#000",t,i);return V.gradient([n,t,o],e)}static mix(t,e,i=.5){return t=V.from(t),e=V.from(e),new V(i*t.r+(1-i)*e.r,i*t.g+(1-i)*e.g,i*t.b+(1-i)*e.b,i*t.a+(1-i)*e.a)}static mixMany(t,e){e||(e=t.map(()=>1));let i=q(e),n=t.map(m=>m.hsl),o=n.map(m=>m[0]),r=o.map(m=>m<180?m+360:m),a=e.map((m,v)=>m*Math.sqrt(t[v].chroma)),l=q(a),h=q(o.map((m,v)=>m*a[v]))/l,p=q(r.map((m,v)=>m*a[v]))/l,g=q(o.map((m,v)=>Math.abs(m-h)*a[v])),y=q(r.map((m,v)=>Math.abs(m-p)*a[v])),x=g<=y?h:p%360,G=q(n.map((m,v)=>e[v]*m[1]))/i,f=q(n.map((m,v)=>e[v]*m[2]))/i;return V.fromHsl(x,G,f)}};function Qo(s,t){for(let e of s)if(!t(e))return!1;return!0}function Jo(s,t){for(let e of s)if(t(e))return!0;return!1}function*tr(s,t){for(let e of s)for(let i of t(e))yield i}var Re=class{constructor(...t){this.values=t}map(t){let e=this.values;return new Re(function*(){let i=0;for(let n of e)for(let o of n)yield t(o,i),i+=1}())}every(t){let e=0;for(let i of this.values)for(let n of i){if(!t(n,e))return!1;e+=1}return!0}some(t){let e=0;for(let i of this.values)for(let n of i){if(t(n,e))return!0;e+=1}return!1}slice(t,e){let i=this.values;return new Re(function*(){let n=0;for(let o of i)for(let r of o)n<t||e!==void 0&&n>t+e||(yield r,n+=1)}())}filter(t){let e=this.values;return new Re(function*(){let i=0;for(let n of e)for(let o of n)t(o,i)&&(yield o),i+=1}())}concat(t){this.values.push(t)}[Symbol.iterator](){let t=this.values;return function*(){for(let e of t)for(let i of e)yield i}()}static make(t,e){return new Re(function*(){let i=0;for(;e===void 0||i<e;)yield t(i),i+=1}())}};var er=1e-6;function A(s,t,e=er){return isNaN(s)||isNaN(t)?!1:Math.abs(s-t)<e}function ot(s,t,e,i=er){return t>e&&([t,e]=[e,t]),s>t+i&&s<e-i}var ir=/(\d+)(\d{3})/,qc=["","k","m","b","t","q"];function _c(s){let[t,e]=s.split(".");for(;ir.test(t);)t=t.replace(ir,"$1,$2");return t+(e?"."+e:"")}function Bc(s,t=6){if(!t)return""+s;let e=(""+Math.abs(Math.floor(s))).length,i=s<0?1:0;if(e<=t-i)return""+Nt(s,t-e-i-1);let n=Math.floor(Math.log10(Math.abs(s))/3);return Nt(s/Math.pow(10,3*n),t-(e%3||3)-i-1)+qc[n]}function Lt(s,t=0,e=!0){let i=Bc(s,t).replace("-","\u2013");return e?_c(i):i}var Hc=/^-?0,[0-9]+$/,Uc=/^-?([0-9]+(,[0-9]{3})*)?\.?[0-9]*$/,Zc=/^-?[0-9]+(\.[0-9]{3})*,?[0-9]*$/;function Bs(s){return s=s.replace(/^â€“/,"-").trim(),!s||s.match(/[^0-9.,-]/)?NaN:Hc.test(s)?parseFloat(s.replace(/,/,".")):Uc.test(s)?parseFloat(s.replace(/,/g,"")):Zc.test(s)?parseFloat(s.replace(/\./g,"").replace(/,/,".")):NaN}var Hs=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],sr=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],Fc=[""," thousand"," million"," billion"," trillion"," quadrillion"," quintillion"," sextillion"];function jc(s){let[t,e,i]=s.split(""),n=t==="0"?"":" "+Hs[+t]+" hundred";return e+i==="00"?n:+e<2?n+" "+Hs[+(e+i)]:i==="0"?n+" "+sr[+e]:n+" "+sr[+e]+"-"+Hs[+i]}function Us(s){if(s===0)return"zero";let t=Math.round(Math.abs(s)).toString(),e=Math.ceil(t.length/3),i=t.padStart(3*e,"0"),n="";for(let o=0;o<e;o+=1){let r=i.substr(o*3,3);r!=="000"&&(n+=jc(r)+Fc[e-1-o])}return n.trim()}function Nt(s,t=0){let e=Math.pow(10,t);return Math.round(s*e)/e}function pt(s,t=1){return Math.round(s/t)*t}function E(s,t=-Infinity,e=Infinity){return Math.min(e,Math.max(t,s))}function gt(s,t,e=.5){return s+(t-s)*e}function Ot(s){return s*s}function Tt(s,t){return(s%t+t)%t}function or(s,t=0){let e=s.slice(0),i=nr(e);return t?i.filter(n=>n.length===t):i}function nr(s){if(s.length===1)return[[],s];let t=s.pop(),e=nr(s),i=[];for(let n of e)i.push(n,[...n,t]);return i}function fe(...s){let[t,...e]=s;if(e.length>1)return fe(t,fe(...e));let i=Math.abs(t),n=Math.abs(e[0]);for(;n;)[i,n]=[n,i%n];return i}function si(...s){let[t,...e]=s;return e.length>1?si(t,si(...e)):Math.abs(t*e[0])/fe(t,e[0])}function Wc(s){if(s%1!=0||s<2)return!1;if(s%2==0)return s===2;if(s%3==0)return s===3;let t=Math.sqrt(s);for(let e=5;e<=t;e+=6)if(s%e==0||s%(e+2)==0)return!1;return!0}function Ui(s){if(s===1)return[];if(Wc(s))return[s];let t=Math.sqrt(s);for(let e=2;e<=t;++e)if(s%e==0)return Ui(e).concat(Ui(s/e));return[]}function Kc(s){s=s.slice(0);for(let t=s.length-1;t>0;--t){let e=Math.floor(Math.random()*(t+1));[s[t],s[e]]=[s[e],s[t]]}return s}function Xc(s,t){let e=t===void 0?0:s,i=t===void 0?s:t-s+1;return e+Math.floor(i*Math.random())}function rr(s){let t=Math.random()*q(s),e=0;return s.findIndex(i=>(e+=i)>=t)}function Yc(s){return s[Math.floor(s.length*Math.random())]}var Zi=new Map;function Qc(s,t){t||(t=Oe()),Zi.has(t)||Zi.set(t,Ie(1,s));let e=Zi.get(t),i=rr(e.map(n=>n*n));return e[i]-=1,e[i]<=0&&Zi.set(t,e.map(n=>n+1)),i}function ar(s=.5){return Math.random()<s?1:0}function Jc(s=1,t=.5){let e=0;for(let i=0;i<s;++i)e+=ar(t);return e}function th(s=1){if(s<=0)return 0;let t=Math.exp(-s),e=1,i=0;for(;e>t;++i)e*=Math.random();return i-1}function eh(s=0,t=1){return s+(t-s)*Math.random()}function ih(s=0,t=1){let e=Math.random(),i=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*i)*Math.sqrt(t)+s}function sh(s=1){return s<=0?0:-Math.log(Math.random())/s}function nh(s=.5){if(!(s<=0||s>1))return Math.floor(Math.log(Math.random())/Math.log(1-s))}function oh(){let s,t,e;do t=2*Math.random()-1,e=2*Math.random()-1,s=t*t+e*e;while(s>=1);return t/e}function rh(s,t=1,e=0){return Math.exp(-((s-t)**2)/(2*e))/Math.sqrt(2*Math.PI*e)}var lr=7,cr=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,15056327351493116e-23];function hr(s){if(s<.5)return Math.PI/(Math.sin(Math.PI*s)*hr(1-s));s-=1;let t=cr[0];for(let i=1;i<lr+2;i++)t+=cr[i]/(s+i);let e=s+lr+.5;return Math.sqrt(2*Math.PI)*Math.pow(e,s+.5)*Math.exp(-e)*t}function dr(s,t,e,i=1){let n=0;for(let o=t;o<e;o+=i)n+=s(o)*i||0;return n}function ah(s,t){let e=dr(i=>Math.pow(i,(t-2)/2)*Math.exp(-i/2),0,s);return 1-e/Math.pow(2,t/2)/hr(t/2)}var Mt=Object.freeze({__proto__:null,shuffle:Kc,integer:Xc,weighted:rr,find:Yc,smart:Qc,bernoulli:ar,binomial:Jc,poisson:th,uniform:eh,normal:ih,exponential:sh,geometric:nh,cauchy:oh,normalPDF:rh,integrate:dr,chiCDF:ah});function pr(s){return s.length?q(s)/s.length:0}var It=2*Math.PI;function me(s,t){let e=Math.atan2(s.y-(t?t.y:0),s.x-(t?t.x:0));return Tt(e,It)}var c=class{constructor(t=0,e=0){this.x=t,this.y=e,this.type="point"}get unitVector(){return A(this.length,0)?new c(1,0):this.scale(1/this.length)}get length(){return Math.sqrt(this.x**2+this.y**2)}get inverse(){return new c(-this.x,-this.y)}get flip(){return new c(this.y,this.x)}get perpendicular(){return new c(-this.y,this.x)}get array(){return[this.x,this.y]}distanceFromLine(t){return c.distance(this,t.project(this))}clamp(t,e=0){let i=E(this.x,t.xMin+e,t.xMax-e),n=E(this.y,t.yMin+e,t.yMax-e);return new c(i,n)}changeCoordinates(t,e){let i=e.xMin+(this.x-t.xMin)/t.dx*e.dx,n=e.yMin+(this.y-t.yMin)/t.dy*e.dy;return new c(i,n)}add(t){return c.sum(this,t)}subtract(t){return c.difference(this,t)}round(t=1){return new c(pt(this.x,t),pt(this.y,t))}floor(){return new c(Math.floor(this.x),Math.floor(this.y))}mod(t,e=t){return new c(this.x%t,this.y%e)}angle(t=T){return me(this,t)}snap(t,e=5){return A(this.x,t.x,e)?new c(t.x,this.y):A(this.y,t.y,e)?new c(this.x,t.y):this}static average(...t){let e=q(t.map(n=>n.x))/t.length,i=q(t.map(n=>n.y))/t.length;return new c(e,i)}static dot(t,e){return t.x*e.x+t.y*e.y}static sum(t,e){return new c(t.x+e.x,t.y+e.y)}static difference(t,e){return new c(t.x-e.x,t.y-e.y)}static distance(t,e){return Math.sqrt(Ot(t.x-e.x)+Ot(t.y-e.y))}static manhattan(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}static interpolate(t,e,i=.5){return new c(gt(t.x,e.x,i),gt(t.y,e.y,i))}static interpolateList(t,e=.5){let i=t.length-1,n=Math.floor(E(e,0,1)*i);return c.interpolate(t[n],t[n+1],i*e-n)}static fromPolar(t,e=1){return new c(e*Math.cos(t),e*Math.sin(t))}static random(t){let e=Mt.uniform(t.xMin,t.xMax),i=Mt.uniform(t.yMin,t.yMax);return new c(e,i)}transform(t){let e=t[0][0]*this.x+t[0][1]*this.y+t[0][2],i=t[1][0]*this.x+t[1][1]*this.y+t[1][2];return new c(e,i)}rotate(t,e=T){if(A(t,0))return this;let i=this.x-e.x,n=this.y-e.y,o=Math.cos(t),r=Math.sin(t),a=i*o-n*r+e.x,l=i*r+n*o+e.y;return new c(a,l)}reflect(t){let e=t.p2.x-t.p1.x,i=t.p2.y-t.p1.y,n=this.x-t.p1.x,o=this.y-t.p1.y,r=(e*o-i*n)/(e*e+i*i),a=this.x+2*r*i,l=this.y-2*r*e;return new c(a,l)}scale(t,e=t){return new c(this.x*t,this.y*e)}shift(t,e=t){return new c(this.x+t,this.y+e)}translate(t){return this.shift(t.x,t.y)}equals(t,e){return A(this.x,t.x,e)&&A(this.y,t.y,e)}},T=new c(0,0),jt=class{constructor(t,e,i){this.c=t,this.start=e,this.angle=i,this.type="arc"}get radius(){return c.distance(this.c,this.start)}get end(){return this.start.rotate(this.angle,this.c)}get startAngle(){return me(this.start,this.c)}contract(t){return new this.constructor(this.c,this.at(t/2),this.angle*(1-t))}get minor(){return this.angle<=Math.PI?this:new this.constructor(this.c,this.end,It-this.angle)}get major(){return this.angle>=Math.PI?this:new this.constructor(this.c,this.end,It-this.angle)}get center(){return this.at(.5)}project(t){let e=this.startAngle,i=e+this.angle,n=me(t,this.c);return i>It&&n<i-It&&(n+=It),n=E(n,e,i),this.c.shift(this.radius,0).rotate(n,this.c)}at(t){return this.start.rotate(this.angle*t,this.c)}contains(t){return t.equals(this.project(t))}transform(t){return new this.constructor(this.c.transform(t),this.start.transform(t),this.angle)}rotate(t,e=T){return A(t,0)?this:new this.constructor(this.c.rotate(t,e),this.start.rotate(t,e),this.angle)}reflect(t){return new this.constructor(this.c.reflect(t),this.start.reflect(t),this.angle)}scale(t,e=t){return new this.constructor(this.c.scale(t,e),this.start.scale(t,e),this.angle)}shift(t,e=t){return new this.constructor(this.c.shift(t,e),this.start.shift(t,e),this.angle)}translate(t){return this.shift(t.x,t.y)}equals(){return!1}},re=class extends jt{constructor(){super(...arguments);this.type="sector"}contains(t){return c.distance(t,this.c)<=this.radius&&new ft(this.start,this.c,t).rad<=this.angle}},st=class{constructor(t,e){this.p1=t,this.p2=e,this.type="line"}make(t,e){return new st(t,e)}get length(){return c.distance(this.p1,this.p2)}get lengthSquared(){return(this.p1.x-this.p2.x)**2+(this.p1.y-this.p2.y)**2}get midpoint(){return c.average(this.p1,this.p2)}get slope(){return(this.p2.y-this.p1.y)/(this.p2.x-this.p1.x)}get intercept(){return this.p1.y+this.slope*this.p1.x}get angle(){return me(this.p2,this.p1)}get unitVector(){return this.p2.subtract(this.p1).unitVector}get perpendicularVector(){return new c(this.p2.y-this.p1.y,this.p1.x-this.p2.x).unitVector}parallel(t){let e=c.sum(t,c.difference(this.p2,this.p1));return new st(t,e)}perpendicular(t){return new st(t,c.sum(t,this.perpendicularVector))}get perpendicularBisector(){return this.perpendicular(this.midpoint)}distanceSquared(t){let e=this.project(t);return(t.x-e.x)**2+(t.y-e.y)**2}offset(t){let e=c.difference(this.p2,this.p1),i=c.difference(t,this.p1);return c.dot(e,i)/this.lengthSquared}project(t){return this.at(this.offset(t))}side(t,e){let i=c.difference(this.p2,this.p1),n=c.difference(t,this.p1),o=n.x*i.y-n.y*i.x;return A(o,0,e)?0:Math.sign(o)}contains(t,e){return this.side(t,e)===0}at(t){return c.interpolate(this.p1,this.p2,t)}transform(t){return new this.constructor(this.p1.transform(t),this.p2.transform(t))}rotate(t,e=T){return A(t,0)?this:new this.constructor(this.p1.rotate(t,e),this.p2.rotate(t,e))}reflect(t){return new this.constructor(this.p1.reflect(t),this.p2.reflect(t))}scale(t,e=t){return this.make(this.p1.scale(t,e),this.p2.scale(t,e))}shift(t,e=t){return this.make(this.p1.shift(t,e),this.p2.shift(t,e))}translate(t){return this.shift(t.x,t.y)}equals(t,e){return this.contains(t.p1,e)&&this.contains(t.p2,e)}},ni=class extends st{constructor(){super(...arguments);this.type="ray"}make(t,e){return new ni(t,e)}equals(t,e){return t.type!=="ray"?!1:this.p1.equals(t.p1,e)&&this.contains(t.p2,e)}},H=class extends st{constructor(){super(...arguments);this.type="segment"}contains(t,e){return st.prototype.contains.call(this,t,e)?this.p1.equals(t,e)||this.p2.equals(t,e)?!0:A(this.p1.x,this.p2.x,e)?ot(t.y,this.p1.y,this.p2.y):ot(t.x,this.p1.x,this.p2.x):!1}make(t,e){return new H(t,e)}project(t){let e=c.difference(this.p2,this.p1),i=c.difference(t,this.p1),n=E(c.dot(e,i)/this.lengthSquared,0,1);return c.sum(this.p1,e.scale(n))}contract(t){return new H(this.at(t),this.at(1-t))}equals(t,e,i=!1){return t.type!=="segment"?!1:this.p1.equals(t.p1,e)&&this.p2.equals(t.p2,e)||!i&&this.p1.equals(t.p2,e)&&this.p2.equals(t.p1,e)}},su=180/Math.PI,nu=Math.PI/180;var ft=class{constructor(t,e,i){this.a=t,this.b=e,this.c=i,this.type="angle"}static fromDegrees(t){return ft.fromRadians(t*(Math.PI/180))}static fromRadians(t){let e=new c(1,0),i=e.rotate(t);return new ft(e,T,i)}get rad(){let t=Math.atan2(this.a.y-this.b.y,this.a.x-this.b.x),i=Math.atan2(this.c.y-this.b.y,this.c.x-this.b.x)-t;return i<0&&(i+=It),i}get deg(){return this.rad*180/Math.PI}get isRight(){return A(this.rad,Math.PI/2,Math.PI/360)}get bisector(){if(this.b.equals(this.a)||this.b.equals(this.c))return;let t=Math.atan2(this.a.y-this.b.y,this.a.x-this.b.x),e=Math.atan2(this.c.y-this.b.y,this.c.x-this.b.x),i=(t+e)/2;t>e&&(i+=Math.PI);let n=Math.cos(i)+this.b.x,o=Math.sin(i)+this.b.y;return new st(this.b,new c(n,o))}get sup(){return this.rad<Math.PI?this:new ft(this.c,this.b,this.a)}get arc(){return new jt(this.b,this.a,this.rad)}project(){return this.c}at(){return this.c}contains(){return!1}transform(t){return new ft(this.a.transform(t),this.b.transform(t),this.c.transform(t))}rotate(t,e){return A(t,0)?this:new ft(this.a.rotate(t,e),this.b.rotate(t,e),this.c.rotate(t,e))}reflect(t){return new ft(this.a.reflect(t),this.b.reflect(t),this.c.reflect(t))}scale(t,e=t){return new ft(this.a.scale(t,e),this.b.scale(t,e),this.c.scale(t,e))}shift(t,e=t){return new ft(this.a.shift(t,e),this.b.shift(t,e),this.c.shift(t,e))}translate(t){return new ft(this.a.translate(t),this.b.translate(t),this.c.translate(t))}equals(t){return!1}},_=class{constructor(t=T,e=1){this.c=t,this.r=e,this.type="circle"}get circumference(){return It*this.r}get area(){return Math.PI*this.r**2}get arc(){let t=this.c.shift(this.r,0);return new jt(this.c,t,It)}tangentAt(t){let e=this.at(t),i=this.c.rotate(Math.PI/2,e);return new st(e,i)}collision(t){let e=this.c.x<t.p.x?t.p.x:this.c.x>t.p.x+t.w?t.p.x+t.w:this.c.x,i=this.c.y<t.p.y?t.p.y:this.c.y>t.p.y+t.h?t.p.y+t.h:this.c.y;return c.distance(this.c,new c(e,i))<=this.r}project(t){let e=t.subtract(this.c).unitVector.scale(this.r);return c.sum(this.c,e)}at(t){let e=It*t;return this.c.shift(this.r*Math.cos(e),this.r*Math.sin(e))}contains(t){return c.distance(t,this.c)<=this.r}transform(t){let e=Math.abs(t[0][0])+Math.abs(t[1][1]);return new _(this.c.transform(t),this.r*e/2)}rotate(t,e=T){return A(t,0)?this:new _(this.c.rotate(t,e),this.r)}reflect(t){return new _(this.c.reflect(t),this.r)}scale(t,e=t){return new _(this.c.scale(t,e),this.r*(t+e)/2)}shift(t,e=t){return new _(this.c.shift(t,e),this.r)}translate(t){return this.shift(t.x,t.y)}equals(t,e){return A(this.r,t.r,e)&&this.c.equals(t.c,e)}};function Ge(s){return["polygon","polyline","rectangle","triangle"].includes(s.type)}function Fi(s){return["polygon","triangle"].includes(s.type)}function ji(s){return s.type==="polyline"}function Zs(s){return s.type==="rectangle"}function yt(s){return["line","ray","segment"].includes(s.type)}function Fs(s){return s.type==="line"}function lh(s){return s.type==="ray"}function De(s){return s.type==="segment"}function rt(s){return s.type==="circle"}function ge(s){return s.type==="arc"}function ye(s){return s.type==="sector"}function ch(s){return s.type==="angle"}function ut(s){return s.type==="point"}function hh(s,t){return A(s.p1.x,s.p2.x)?ot(t.y,s.p1.y,s.p2.y):ot(t.x,s.p1.x,s.p2.x)}function dh(s,t){return A(s.p1.x,s.p2.x)?(t.y-s.p1.y)/(s.p2.y-s.p1.y)>0:(t.x-s.p1.x)/(s.p2.x-s.p1.x)>0}function ph(s,t){let e=s.p1.x-s.p2.x,i=s.p1.y-s.p2.y,n=t.p1.x-t.p2.x,o=t.p1.y-t.p2.y,r=e*o-i*n;if(A(r,0))return[];let a=s.p1.x*s.p2.y-s.p1.y*s.p2.x,l=t.p1.x*t.p2.y-t.p1.y*t.p2.x,h=a*n-e*l,p=a*o-i*l;return[new c(h/r,p/r)]}function uh(s,t){let e=c.distance(s.c,t.c);if(e>s.r+t.r)return[];if(e<Math.abs(s.r-t.r))return[];if(A(e,0)&&A(s.r,t.r))return[];if(A(e,s.r+t.r))return[new st(s.c,t.c).midpoint];let i=(Ot(s.r)-Ot(t.r)+Ot(e))/(2*e),n=Math.sqrt(Ot(s.r)-Ot(i)),o=(t.c.x-s.c.x)*i/e+(t.c.y-s.c.y)*n/e+s.c.x,r=(t.c.y-s.c.y)*i/e-(t.c.x-s.c.x)*n/e+s.c.y,a=(t.c.x-s.c.x)*i/e-(t.c.y-s.c.y)*n/e+s.c.x,l=(t.c.y-s.c.y)*i/e+(t.c.x-s.c.x)*n/e+s.c.y;return[new c(o,r),new c(a,l)]}function ur(s,t){let e=s.p2.x-s.p1.x,i=s.p2.y-s.p1.y,n=Ot(e)+Ot(i),o=t.c.x,r=t.c.y,a=(s.p1.x-o)*(s.p2.y-r)-(s.p2.x-o)*(s.p1.y-r),l=Ot(t.r)*n-Ot(a);if(l<0)return[];let h=a*i/n,p=-a*e/n;if(A(l,0))return[t.c.shift(h,p)];let g=e*(i<0?-1:1)*Math.sqrt(l)/n,y=Math.abs(i)*Math.sqrt(l)/n;return[t.c.shift(h+g,p+y),t.c.shift(h-g,p-y)]}function fh(s,t){let e=[];yt(s)&&yt(t)?e=ph(s,t):yt(s)&&rt(t)?e=ur(s,t):rt(s)&&yt(t)?e=ur(t,s):rt(s)&&rt(t)&&(e=uh(s,t));for(let i of[s,t])i.type==="segment"&&(e=e.filter(n=>hh(i,n))),i.type==="ray"&&(e=e.filter(n=>dh(i,n)));return e}function St(...s){if(s.length<2)return[];if(s.length>2)return Ft(or(s,2).map(i=>St(...i)));let[t,e]=s;if(Ge(e)&&([t,e]=[e,t]),Ge(t)){let i=yt(e)?t.points.filter(n=>e.contains(n)):[];for(let n of t.edges)i.push(...St(n,e));return i}return fh(t,e)}var C=class{constructor(...t){this.type="polygon",this.points=t}get circumference(){if(this.points.length<=1)return 0;let t=c.distance(this.points[0],L(this.points));for(let e=1;e<this.points.length;++e)t+=c.distance(this.points[e-1],this.points[e]);return t}get signedArea(){let t=this.points,e=t.length,i=t[e-1].x*t[0].y-t[0].x*t[e-1].y;for(let n=1;n<e;++n)i+=t[n-1].x*t[n].y-t[n].x*t[n-1].y;return i/2}get area(){return Math.abs(this.signedArea)}get centroid(){let t=this.points,e=t.length,i=0;for(let o=0;o<e;++o)i+=t[o].x;let n=0;for(let o=0;o<e;++o)n+=t[o].y;return new c(i/e,n/e)}get edges(){let t=this.points,e=t.length,i=[];for(let n=0;n<e;++n)i.push(new H(t[n],t[(n+1)%e]));return i}get radius(){let t=this.centroid,e=this.points.map(i=>c.distance(i,t));return Math.max(...e)}get oriented(){if(this.signedArea>=0)return this;let t=[...this.points].reverse();return new this.constructor(...t)}cut(t){let e=[],i=[];for(let l of this.edges){let h=t.side(l.p1),p=t.side(l.p2);if(h&&p&&h!==p){let g=St(l,t)[0];e.push(new H(l.p1,g));let y=new H(g,l.p2);y.flag=p,e.push(y),i.push(y)}else h===0&&p&&(i.push(l),l.flag=p),e.push(l)}if(i.length<2)return[this];i.sort((l,h)=>t.offset(l.p1)-t.offset(h.p1));let n=(l,h)=>{let p=e.length,g=[];h<l&&(h+=p);for(let y=l;y<=h;y++)g.push(e[y%p]);return g},o=l=>{let h=e.length,p=e[l].flag,g=l;for(;;)if(g=(g+1)%h,e[g].flag===p&&(e[g].flag=void 0,i.splice(i.indexOf(e[g]),1)),g===l||e[g].flag)return g},r=[],a=0;for(;i.length>=2;){let l=i[0],h=i[1],p=e.indexOf(l),g=e.indexOf(h),y=!1;if(o(p)===g?y=!0:([l,h]=[h,l],[p,g]=[g,p],o(p)===g&&(y=!0)),y?(a--,r.push(n(p,g)),e=n(g,p),l.flag=h.flag=void 0,i.splice(0,2),i.length<2&&r.push(e)):(a++,i.reverse()),a>1)break}return r.map(l=>new C(...l.map(h=>h.p1)))}static collision(t,e){if(t.points.some(i=>e.contains(i))||e.points.some(i=>t.contains(i)))return!0;for(let i of t.edges)for(let n of e.edges)if(St(i,n)[0])return!0;return!1}static regular(t,e=1){let i=It/t,n=Math.PI/2-i/2,o=N(r=>c.fromPolar(n+i*r,e),t);return new C(...o)}static interpolate(t,e,i=.5){let n=t.points.map((o,r)=>c.interpolate(o,e.points[r],i));return new C(...n)}contains(t){let e=!1;for(let i of this.edges){if(i.p1.equals(t)||i.contains(t))return!1;if(i.p1.y>t.y==i.p2.y>t.y)continue;let n=(i.p2.x-i.p1.x)/(i.p2.y-i.p1.y);t.x<n*(t.y-i.p1.y)+i.p1.x&&(e=!e)}return e}at(t){return c.interpolateList([...this.points,this.points[0]],t)}project(t){let e,i=Infinity;for(let n of this.edges){let o=n.project(t),r=c.distance(t,o);r<i&&(e=o,i=r)}return e||this.points[0]}transform(t){return new this.constructor(...this.points.map(e=>e.transform(t)))}rotate(t,e=T){if(A(t,0))return this;let i=this.points.map(n=>n.rotate(t,e));return new this.constructor(...i)}reflect(t){let e=this.points.map(i=>i.reflect(t));return new this.constructor(...e)}scale(t,e=t){let i=this.points.map(n=>n.scale(t,e));return new this.constructor(...i)}shift(t,e=t){let i=this.points.map(n=>n.shift(t,e));return new this.constructor(...i)}translate(t){return this.shift(t.x,t.y)}equals(t){return!1}},ae=class extends C{constructor(){super(...arguments);this.type="polyline"}get length(){let t=0;for(let e=1;e<this.points.length;++e)t+=c.distance(this.points[e-1],this.points[e]);return t}get edges(){let t=[];for(let e=0;e<this.points.length-1;++e)t.push(new H(this.points[e],this.points[e+1]));return t}},js=class extends C{constructor(){super(...arguments);this.type="triangle"}get circumcircle(){let[t,e,i]=this.points,n=2*(t.x*(e.y-i.y)+e.x*(i.y-t.y)+i.x*(t.y-e.y)),o=(t.x**2+t.y**2)*(e.y-i.y)+(e.x**2+e.y**2)*(i.y-t.y)+(i.x**2+i.y**2)*(t.y-e.y),r=(t.x**2+t.y**2)*(i.x-e.x)+(e.x**2+e.y**2)*(t.x-i.x)+(i.x**2+i.y**2)*(e.x-t.x),a=new c(o/n,r/n),l=c.distance(a,this.points[0]);return new _(a,l)}get incircle(){let t=this.edges,e=t.map(g=>g.length),i=e[0]+e[1]+e[2],[n,o,r]=this.points,a=e[1]*n.x+e[2]*o.x+e[0]*r.x,l=e[1]*n.y+e[2]*o.y+e[0]*r.y,h=new c(a/i,l/i),p=h.distanceFromLine(t[0]);return new _(h,p)}get orthocenter(){let[t,e,i]=this.points,n=new st(t,e).perpendicular(i),o=new st(t,i).perpendicular(e);return St(n,o)[0]}},$=class{constructor(t,e=1,i=e){this.p=t,this.w=e,this.h=i,this.type="rectangle"}static aroundPoints(t){let e=Infinity,i=-Infinity,n=Infinity,o=-Infinity;for(let r of t)e=e<r.x?e:r.x,i=i>r.x?i:r.x,n=n<r.y?n:r.y,o=o>r.y?o:r.y;return new $(new c(e,n),i-e,o-n)}get center(){return new c(this.p.x+this.w/2,this.p.y+this.h/2)}get centroid(){return this.center}get circumference(){return 2*Math.abs(this.w)+2*Math.abs(this.h)}get area(){return Math.abs(this.w*this.h)}get edges(){return this.polygon.edges}get points(){return this.polygon.points}get polygon(){let t=new c(this.p.x+this.w,this.p.y),e=new c(this.p.x+this.w,this.p.y+this.h),i=new c(this.p.x,this.p.y+this.h);return new C(this.p,t,e,i)}collision(t){return this.p.x<t.p.x+t.w&&this.p.x+this.w>t.p.x&&this.p.y<t.p.y+t.h&&this.p.y+this.h>t.p.y}contains(t,e){return ot(t.x,this.p.x,this.p.x+this.w,e)&&ot(t.y,this.p.y,this.p.y+this.h,e)}project(t){let e;for(let i of this.edges){let n=i.project(t);(!e||c.distance(t,n)<c.distance(t,e))&&(e=n)}return e}at(t){return this.p}transform(t){return this.polygon.transform(t)}rotate(t,e=T){return A(t,0)?this:this.polygon.rotate(t,e)}reflect(t){return this.polygon.reflect(t)}scale(t,e=t){return new $(this.p.scale(t,e),this.w*t,this.h*e)}shift(t,e=t){return new $(this.p.shift(t,e),this.w,this.h)}translate(t){return this.shift(t.x,t.y)}equals(t){return!1}},vt=class{constructor(t,e,i,n){this.xMin=t,this.xMax=e,this.yMin=i,this.yMax=n}contains(t){return this.containsX(t)&&this.containsY(t)}containsX(t){return ot(t.x,this.xMin,this.xMax)}containsY(t){return ot(t.y,this.yMin,this.yMax)}resize(t,e){return new vt(this.xMin,this.xMax+t,this.yMin,this.yMax+e)}get dx(){return this.xMax-this.xMin}get dy(){return this.yMax-this.yMin}get xRange(){return[this.xMin,this.xMax]}get yRange(){return[this.yMin,this.yMax]}get rect(){return new $(new c(this.xMin,this.yMin),this.dx,this.dy)}get center(){return new c(this.xMin+this.dx/2,this.yMin+this.dy/2)}get flip(){return new vt(this.yMin,this.yMax,this.xMin,this.xMax)}};function fr(s,t,e={}){if(e.fill&&(s.fillStyle=e.fill),e.opacity&&(s.globalAlpha=e.opacity),e.stroke&&(s.strokeStyle=e.stroke,s.lineWidth=e.strokeWidth||1,e.lineCap&&(s.lineCap=e.lineCap),e.lineJoin&&(s.lineJoin=e.lineJoin)),s.beginPath(),De(t))s.moveTo(t.p1.x,t.p1.y),s.lineTo(t.p2.x,t.p2.y);else if(rt(t))s.arc(t.c.x,t.c.y,t.r,0,It);else if(Fi(t)){s.moveTo(t.points[0].x,t.points[0].y);for(let i of t.points.slice(1))s.lineTo(i.x,i.y);s.closePath()}else if(ji(t)){s.moveTo(t.points[0].x,t.points[0].y);for(let i of t.points.slice(1))s.lineTo(i.x,i.y)}e.fill&&s.fill(),e.stroke&&s.stroke()}function Ws(s,t,e){let n=t.x*(e.y-s.y)+s.x*(t.y-e.y)+e.x*(s.y-t.y)>0?1:0,o=c.distance(t,s);return[s.x,s.y+"A"+o,o,0,n,1,e.x,e.y].join(",")}function mh(s,t={}){return s.isRight&&!t.round?20:24+20*(1-E(s.rad,0,Math.PI)/Math.PI)}function gh(s,t={}){let e=s.a,i=s.b,n=s.c,o=t.size||mh(s,t),r=c.difference(e,i).unitVector,a=c.difference(n,i).unitVector;e=c.sum(i,r.scale(o)),n=c.sum(i,a.scale(o));let l=t.fill?`M${i.x},${i.y}L`:"M";if(s.isRight&&!t.round){let h=c.sum(e,a.scale(o));l+=`${e.x},${e.y}L${h.x},${h.y}L${n.x},${n.y}`}else l+=Ws(e,i,n);return t.fill&&(l+="Z"),l}function Pt(...s){return"M"+s.map(t=>t.x+","+t.y).join("L")}function mr(s,t){let e=s.perpendicularVector.scale(6),i=s.unitVector.scale(3),n=s.midpoint;switch(t){case"bar":return Pt(n.add(e),n.add(e.inverse));case"bar2":return Pt(n.add(i).add(e),n.add(i).add(e.inverse))+Pt(n.add(i.inverse).add(e),n.add(i.inverse).add(e.inverse));case"arrow":return Pt(n.add(i.inverse).add(e),n.add(i),n.add(i.inverse).add(e.inverse));case"arrow2":return Pt(n.add(i.scale(-2)).add(e),n,n.add(i.scale(-2)).add(e.inverse))+Pt(n.add(e),n.add(i.scale(2)),n.add(e.inverse));default:return""}}function Wi(s,t){if(!s||!t)return"";let e=t.perpendicular,i=s.add(t.scale(9)).add(e.scale(9)),n=s.add(t.scale(9)).add(e.scale(-9));return Pt(i,s,n)}function yh(s,t){let e="";return D(t,"start","both")&&(e+=Wi(s.p1,s.unitVector)),D(t,"end","both")&&(e+=Wi(s.p2,s.unitVector.inverse)),e}function vh(s,t){let e="";if(D(t,"start","both")){let i=new st(s.c,s.start).perpendicularVector.inverse;e+=Wi(s.start,i)}if(D(t,"end","both")){let i=new st(s.c,s.end).perpendicularVector;e+=Wi(s.end,i)}return e}function le(s,t={}){if(ch(s))return gh(s,t);if(De(s)){if(s.p1.equals(s.p2))return"";let e=Pt(s.p1,s.p2);return t.mark&&(e+=mr(s,t.mark)),t.arrows&&(e+=yh(s,t.arrows)),e}if(lh(s)){if(!t.box)return"";let e=St(s,t.box)[0];return e?Pt(s.p1,e):""}if(Fs(s)){if(!t.box)return"";let e=St(s,t.box);if(e.length<2)return"";let i=Pt(e[0],e[1]);return t.mark&&(i+=mr(s,t.mark)),i}if(rt(s))return`M ${s.c.x-s.r} ${s.c.y} a ${s.r},${s.r} 0 1 0 ${2*s.r} 0 a ${s.r} ${s.r} 0 1 0 ${-2*s.r} 0`;if(ge(s)){let e="M"+Ws(s.start,s.c,s.end);return t.arrows&&(e+=vh(s,t.arrows)),e}return ye(s)?`M ${s.c.x} ${s.c.y} L ${Ws(s.start,s.c,s.end)} Z`:ji(s)?Pt(...s.points):Fi(s)?Pt(...s.points)+"Z":Zs(s)?Pt(...s.polygon.points)+"Z":""}function Wt(s,t,e,i){function n(o){return o instanceof e?o:new e(function(r){r(o)})}return new(e||(e=Promise))(function(o,r){function a(p){try{h(i.next(p))}catch(g){r(g)}}function l(p){try{h(i.throw(p))}catch(g){r(g)}}function h(p){p.done?o(p.value):n(p.value).then(a,l)}h((i=i.apply(s,t||[])).next())})}function bh(s){let t=[];for(let e of Object.keys(s)){let i=s[e];if(e=encodeURIComponent(e),i==null){t.push(e);continue}i=Array.isArray(i)?i.join(","):""+i,i=i.replace(/(\r)?\n/g,`\r
`),i=encodeURIComponent(i),i=i.replace(/%20/g,"+"),t.push(e+"="+i)}return t.join("&")}function oi(s,t){return Wt(this,void 0,void 0,function*(){let e=t instanceof FormData,i={method:"POST",body:e?t:t?bh(t):void 0,headers:{"X-CSRF-Token":window.csrfToken||""}};e||(i.headers["Content-Type"]="application/x-www-form-urlencoded");let n=s.includes("?")?"&xhr=1":"?xhr=1",o=yield fetch(s+n,i);if(!o.ok)throw new Error(`Fetch error ${o.status}: ${s}`);return o.text()})}function Ki(s,t=!1){return new Promise(e=>{let i=new Image;t||(i.crossOrigin="Anonymous"),i.onload=()=>e(i),i.src=s})}var ri=new Map;function wh(s,t){ri.has(s)?Gs(ri.get(s),t,(e,i)=>Et(e.concat(i))):ri.set(s,t)}function gr(){if(!!window.navigator.onLine)for(let[s,t]of ri)ri.delete(s),oi(s,{data:JSON.stringify(t)}).catch(e=>{console.error("Failed to send POST request:",e),wh(s,t)})}var xh=Ns(gr,5e3);window.addEventListener("online",xh);window.onbeforeunload=gr;var J;(function(s){s[s.Array=0]="Array",s[s.BinaryOp=1]="BinaryOp",s[s.Call=2]="Call",s[s.Conditional=3]="Conditional",s[s.Identifier=4]="Identifier",s[s.Literal=5]="Literal",s[s.Member=6]="Member",s[s.UnaryOp=7]="UnaryOp"})(J||(J={}));var yr={"===":(s,t)=>s===t,"!==":(s,t)=>s!==t,"||":(s,t)=>s||t,"&&":(s,t)=>s&&t,"==":(s,t)=>s==t,"!=":(s,t)=>s!=t,"<=":(s,t)=>s<=t,">=":(s,t)=>s>=t,"**":(s,t)=>Math.pow(s,t),"<":(s,t)=>s<t,">":(s,t)=>s>t,"+":(s,t)=>s+t,"-":(s,t)=>s-t,"*":(s,t)=>s*t,"/":(s,t)=>s/t,"%":(s,t)=>s%t},vr={"-":s=>-s,"+":s=>+s,"!":s=>!s},br={"||":1,"&&":2,"==":3,"!=":3,"===":3,"!==":3,"<":4,">":4,"<=":4,">=":4,"+":5,"-":5,"*":6,"/":6,"%":6,"**":7},wr={true:!0,false:!1,undefined:void 0},$h=/\s/,Ks=/[0-9]/,Xs=/[a-zA-ZÎ±-Ï‰Î‘-Î©$_]/,Th=/[0-9a-zA-ZÎ±-Ï‰Î‘-Î©$_]/;function Sh(s){let t=s.length,e=0;function i(f){throw new Error(`${f} at character ${e} of "${s}"`)}function n(){for(;$h.test(s[e]);)e+=1}function o(){let f="";for(;Ks.test(s[e]);)f+=s[e++];if(s[e]===".")for(f+=s[e++];Ks.test(s[e]);)f+=s[e++];let m=s[e];if(m&&Xs.test(m)){let v=f+s[e];i(`Variable names cannot start with a number (${v})`)}else m==="."&&i("Unexpected period");return{type:J.Literal,value:parseFloat(f)}}function r(){let f=s[e];e+=1;let m=!1,v="";for(;e<t;){let I=s[e++];if(I===f){m=!0;break}v+=I}return m||i(`Unclosed quote after "${v}"`),{type:J.Literal,value:v}}function a(){let f=s[e];for(Xs.test(s[e])||i("Unexpected "+f),e+=1;e<t&&Th.test(s[e]);)f+=s[e++];return f in wr?{type:J.Literal,value:wr[f]}:{type:J.Identifier,name:f}}function l(f){let m=[],v=!1,I;for(;e<t;)if(s[e]===f){I&&m.push(I),v=!0,e+=1;break}else s[e]===","?(m.push(I||{type:J.Literal,value:void 0}),e+=1):I=x();return v||i("Expected "+f),m}function h(){let f;if(s[e]==="("){if(e+=1,f=x(),n(),s[e]===")")return e+=1,f;i("Unclosed (")}else f=a();for(n();".[(".includes(s[e]);)s[e]==="."?(e++,n(),f={type:J.Member,object:f,computed:!1,property:a()}):s[e]==="["?(e++,f={type:J.Member,object:f,computed:!0,property:x()},n(),s[e]!=="]"&&i("Unclosed ["),e++):s[e]==="("&&(e++,f={type:J.Call,args:l(")"),callee:f}),n();return f}function p(){n();for(let f of[3,2,1]){let m=s.substr(e,f);if(m in yr)return e+=f,m}}function g(){n();let f=s[e];if(Ks.test(f)||f===".")return o();if(f==="'"||f==='"')return r();if(f==="[")return e+=1,{type:J.Array,elements:l("]")};if(f in vr)return e+=1,{type:J.UnaryOp,operator:f,argument:g()};if(Xs.test(f)||f==="(")return h();i("Expression parsing error")}function y(){let f=g(),m=p();if(!m)return f;let v=g();v||i("Expected expression after "+m);let I,it=[f,m,v];for(;m=p();){let Di=br[m],ii=m;for(;it.length>2&&Di<=br[it[it.length-2]];)v=it.pop(),m=it.pop(),f=it.pop(),I={type:J.BinaryOp,operator:m,left:f,right:v},it.push(I);I=g(),I||i("Expected expression after "+ii),it.push(ii,I)}let Dt=it.length-1;for(I=it[Dt];Dt>1;)I={type:J.BinaryOp,operator:it[Dt-1],left:it[Dt-2],right:I},Dt-=2;return I}function x(){let f=y();if(n(),f&&s[e]==="?"){e+=1;let m=x();if(m||i("Expected expression"),n(),s[e]===":"){e++;let v=x();return v||i("Expected expression"),{type:J.Conditional,test:f,consequent:m,alternate:v}}else i("Expected :")}else return f}let G=x();return e<s.length&&i(`Unexpected "${s[e]}"`),G}var Xi=[void 0,void 0];function Rt(s,t,e){switch(s.type){case J.Array:let i=s.elements.map(G=>Rt(G,t,e)[0]);return i.some(G=>G===void 0)?Xi:[i,void 0];case J.BinaryOp:let n=Rt(s.left,t,e)[0],o=Rt(s.right,t,e)[0];return"+-**/%".includes(s.operator)&&(n===void 0||o===void 0)?Xi:[yr[s.operator](n,o),void 0];case J.Call:let[r,a]=Rt(s.callee,t,e),l=s.args.map(G=>Rt(G,t,e)[0]);return l.some(G=>G===void 0)||typeof r!="function"?Xi:[r.apply(a,l),void 0];case J.Conditional:let h=Rt(s.consequent,t,e),p=Rt(s.alternate,t,e);return Rt(s.test,t,e)[0]?h:p;case J.Identifier:return[e[s.name]||t[s.name],void 0];case J.Literal:return[s.value,void 0];case J.Member:let g=Rt(s.object,t,e)[0],y=s.computed?Rt(s.property,t,e)[0]:s.property.name;return g?[g[y],g]:[void 0,void 0];case J.UnaryOp:let x=Rt(s.argument,t,e)[0];return x===void 0&&s.operator!=="!"?Xi:[vr[s.operator](x),void 0]}}function zt(s){let t=Sh(s);return t?(e={},i={})=>Rt(t,e,i)[0]:(e={})=>{}}var Mh=/\${([^}]+)}/g;function xr(s){let t=s.split(Mh),e=t.map((i,n)=>n%2?zt(i.replace(/Ã—/g,"*")):void 0);return i=>t.map((n,o)=>{if(!(o%2))return n;let r=e[o](i);return typeof r=="number"&&r<0?"\u2013"+-r:r}).join("")}var ai="ontouchstart"in window,Ne="onpointerdown"in window;function Kt(s){if(s.touches){let t=s.targetTouches.length?s.targetTouches:s.changedTouches;return new c(t[0].clientX,t[0].clientY)}else return new c(s.clientX||0,s.clientY||0)}function Ph(s){return s.touches||[]}function qt(s,t){return Kt(s).transform(t.inverseTransformMatrix)}function kh(s,t){let e=Kt(s),i=t.bounds,n=(e.x-i.left)*t.canvasWidth/i.width,o=(e.y-i.top)*t.canvasHeight/i.height;return new c(n,o)}function Ch(s){if(s instanceof PointerEvent&&s.pointerType==="mouse")return Z(s.target);let t=Kt(s);return Z(document.elementFromPoint(t.x,t.y)||void 0)}function Ah(s){if(s._data.tapEvent)return;s._data.tapEvent=!0;let t;s.on("pointerdown",e=>t=Kt(e)),s.on("pointerup",e=>{if(!t)return;let i=Kt(e);c.distance(t,i)<6&&s.trigger("tap",e),t=void 0}),s.on("pointercancel",()=>t=void 0)}function Vh(s){s._data.clickOutsideEvent||(s._data.clickOutsideEvent=!0,U.on("pointerdown",t=>{var e,i;let n=t.target,o=(i=(e=s._el).getRootNode)===null||i===void 0?void 0:i.call(e),r=Kt(t);(o==null?void 0:o.host)&&(n=o.elementFromPoint(r.x,r.y)),!(!n||s._el===n||s._el.contains(n))&&s.trigger("clickOutside",t)}))}function $r(s,t){let e=t.$box||s,i=Kt;e.type==="svg"?i=y=>qt(y,e.$ownerSVG):e.type==="canvas"&&(i=y=>kh(y,e));let n=t.justInside?s:U,o,r,a=!1,l=0;s.css("touch-action")==="auto"&&s.css("touch-action","none"),s.addClass("noselect");function h(y){y.handled||Ph(y).length>1||(y.preventDefault(),a=!1,l=y.pointerId||0,n.on("pointermove",p),n.on("pointerstop",g),o=r=i(y),t.down&&t.down(o))}function p(y){if(!o||l&&y.pointerId!==l)return;y.preventDefault();let x=i(y);c.distance(x,r)<.5||(!a&&t.start&&t.start(o),t.move&&t.move(x,o,r),r=x,a=!0)}function g(y,x=!1){!o||l&&y.pointerId!==l||(y.preventDefault(),n.off("pointermove",p),n.off("pointerstop",g),t.up&&t.up(r,o),a&&t.end&&t.end(r,o),!a&&t.click&&!x&&t.click(o),o=void 0)}w.onKey("escape",()=>{if(!o)return;a&&t.move&&t.move(o,o,r),r=o;let y=document.createEvent("MouseEvent");y.pointerId=l,g(y,!0)}),s.on("pointerdown",h),t.justInside&&s.on("mouseleave",g),t.accessible&&(s.setAttr("tabindex","0"),document.addEventListener("keydown",y=>{if(![37,38,39,40].includes(y.keyCode)||s!==w.getActiveInput())return;let x=s.boxCenter,G=i({clientX:x.x,clientY:x.y}),f=y.keyCode===37?-25:y.keyCode===39?25:0,m=y.keyCode===38?-25:y.keyCode===40?25:0,v=G.shift(f,m);t.down&&t.down(G),t.start&&t.start(G),t.move&&t.move(v,G,G),t.end&&t.end(v,G)}))}function Eh(s){if(s._data.scrollEvents)return;s._data.scrollEvents=!0;let t=!1,e;function i(){let l=s.scrollTop;if(l===e){t=!1;return}e=l,s.trigger("scroll",{top:e}),window.requestAnimationFrame(i)}function n(){t||window.requestAnimationFrame(i),t=!0}(s.type==="window"?window:s._el).addEventListener("scroll",n);function r(){window.addEventListener("touchmove",n),window.addEventListener("touchend",a)}function a(){window.removeEventListener("touchmove",n),window.removeEventListener("touchend",a)}s._el.addEventListener("touchstart",function(l){l.handled||r()})}var Ys;function Lh(s){for(let t of s){let e=t.isIntersecting?"enterViewport":"exitViewport";setTimeout(()=>Z(t.target).trigger(e))}}function Tr(s){if(!s._data.intersectionEvents){if(s._data.intersectionEvents=!0,!window.IntersectionObserver){let t=!1;U.on("scroll",()=>{let e=s.isInViewport;t&&!e?(s.trigger("exitViewport"),t=!1):e&&!t&&(s.trigger("enterViewport"),t=!0)});return}Ys||(Ys=new IntersectionObserver(Lh)),Ys.observe(s._el)}}function Oh(s,t=!1){if(t&&(s._data.resizeObserver&&s._data.resizeObserver.disconnect(),s._data.resizeObserver=void 0),!s._data.resizeObserver){if(window.ResizeObserver){let e=new window.ResizeObserver(()=>s.trigger("resize"));e.observe(s._el),s._data.resizeObserver=e}else if(window.MutationObserver){let e=new MutationObserver(()=>s.trigger("resize"));e.observe(s._el,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),s._data.resizeObserver=e}}}function Sr(s){if(s._data.pointerPositionEvents)return;s._data.pointerPositionEvents=!0;let t=s.parent,e;t.on("pointerend",()=>e=void 0),t.on("pointermove",i=>{let n=e,o=Ch(i);e=o.equals(s)||o.hasParent(s),n!=null&&e&&!n&&s.trigger("pointerenter",i),!e&&n&&s.trigger("pointerleave",i)})}function Qs(s,t){t._data["_"+s]||(t._data["_"+s]=!0,Ne?t.on(s.replace("mouse","pointer"),e=>{e.pointerType==="mouse"&&t.trigger(s,e)}):ai||t._el.addEventListener(s,e=>t.trigger(s,e)))}function Ih(s){s.on("keydown",t=>{if(t.metaKey||t.ctrlKey||w.isAndroid&&t.keyCode===229)return;let e=t.key||String.fromCharCode(t.which),i=e.toLowerCase(),n=!!t.shiftKey;s.trigger("key",{code:t.keyCode,key:i,char:e,shift:n})}),w.isAndroid&&s.type==="input"&&s.on("input",t=>{let e=t.data[t.data.length-1],i=e.toLowerCase();s.trigger("key",{code:void 0,key:i,char:e}),s.value=""})}var Yi={scrollwheel:"DOMMouseScroll mousewheel",pointerdown:Ne?"pointerdown":ai?"touchstart":"mousedown",pointermove:Ne?"pointermove":ai?"touchmove":"mousemove",pointerup:Ne?"pointerup":ai?"touchend":"mouseup",pointercancel:Ne?"pointercancel":"touchcancel",pointerstop:Ne?"pointerup pointercancel":ai?"touchend touchcancel":"mouseup"},Qi={scroll:Eh,tap:Ah,clickOutside:Vh,key:Ih,mousedown:Qs.bind(void 0,"mousedown"),mousemove:Qs.bind(void 0,"mousemove"),mouseup:Qs.bind(void 0,"mouseup"),pointerenter:Sr,pointerleave:Sr,enterViewport:Tr,exitViewport:Tr,resize:Oh};function Rh(s,t,e,i){if(t in Qi)Qi[t](s,!1);else if(t in Yi){let n=ct(Yi[t]);for(let o of n)s._el.addEventListener(o,e,i)}else s._el.addEventListener(t,e,i)}function Gh(s,t,e){if(t in Qi)(!s._events[t]||!s._events[t].length)&&Qi[t](s,!0);else if(e&&t in Yi){let i=ct(Yi[t]);for(let n of i)s._el.removeEventListener(n,e)}else e&&s._el.removeEventListener(t,e)}function Xt(s,t){let e=new Map,i=new Map,n,o=0;function r(m){n=m;let v=m(f);return n=void 0,v}function a(m){for(let v of e.values())v.has(m)&&v.delete(m)}function l(m,v){i.has(m)&&a(i.get(m));let I=()=>{s[m]=v(f),n===I&&(n=void 0),h(m)};i.set(m,I),r(I)}function h(m){let v=e.get(m);if(v)for(let I of v)I(s)}function p(){for(let m of e.values())for(let v of m)v(s)}function g(m){Object.assign(s,m),p()}function y(){for(o+=1;"_x"+o in s;)o+=1;return"_x"+o}function x(){s={},e.clear(),i.clear(),o=0}function G(m){!t||t.watch(()=>f[m]=t[m])}let f=new Proxy(s,{get(m,v){return v==="watch"?r:v==="unwatch"?a:v==="setComputed"?l:v==="forceUpdate"?p:v==="assign"?g:v==="getKey"?y:v==="clear"?x:v==="_internal"?[s,e]:(n&&(e.has(v)||e.set(v,new Set),e.get(v).add(n)),v in s||G(v),s[v])},set(m,v,I){return s[v]===I||(s[v]=I,i.has(v)&&(a(i.get(v)),i.delete(v)),h(v)),!0},deleteProperty(m,v){return delete s[v],e.delete(v),i.delete(v),!0}});return f}var Dh={A:7,C:6,H:1,L:2,M:2,Q:4,S:4,T:2,V:1,Z:0},Nh=/[astvzqmhlc]([^astvzqmhlc]*)/ig,zh=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function Js(s){let t=[],e;for(let i of s.match(Nh)||[]){let n=i[0].toUpperCase();if(n==="Z"){t.push({type:"Z",points:[]});continue}let o=(i.slice(1).match(zh)||[]).map(a=>+a),r=n===i[0];for(let[a,l]of qs(o,Dh[n]).entries()){let h=[],p=n==="M"&&a>0?"L":n,g;n==="H"?(p="L",h=[new c(l[0],r&&(e==null?void 0:e.y)||0)]):n==="V"?(p="L",h=[new c(r&&(e==null?void 0:e.x)||0,l[0])]):n==="A"?(p="A",h=[new c(l[5],l[6])],g=l.slice(0,5)):"MLCSQT".includes(n)&&(h=qs(l,2).map(y=>new c(y[0],y[1]))),!r&&e&&(h=h.map(y=>y.translate(e))),e=L(h),t.push({type:p,points:h,options:g})}}return t}function ve(s){return s?Js(s).map(e=>L(e.points)).filter(e=>!!e):[]}var li=class{constructor(t){this._el=t,this._data={},this._events={},this.type="default",t._view=this}get id(){return this._el.id}get data(){return this._el.dataset}get tagName(){return this._el.tagName.toUpperCase()}equals(t){return this._el===t._el}addClass(t){for(let e of ct(t))this._el.classList.add(e)}removeClass(t){for(let e of ct(t))this._el.classList.remove(e)}hasClass(t){return this._el.classList.contains(t)}toggleClass(t){return this._el.classList.toggle(t)}setClass(t,e){e?this.addClass(t):this.removeClass(t)}attr(t){return this._el.getAttribute(t)||""}hasAttr(t){return this._el.hasAttribute(t)}setAttr(t,e){e===void 0?this.removeAttr(t):this._el.setAttribute(t,e.toString())}removeAttr(t){this._el.removeAttribute(t)}get attributes(){return Array.from(this._el.attributes||[])}get html(){return this._el.innerHTML||""}set html(t){this._el.innerHTML=t}get text(){return this._el.textContent||""}set text(t){this._el.textContent=t}set textStr(t){this._el.textContent=""+t}blur(){this._el.blur()}focus(){this._el.focus()}getParentModel(){let t=this.parent;return t?t.model||t.getParentModel():void 0}bindModel(t,e=!0){var i;if(!this.model){if(this.model=t,this.hasAttr(":for"))return this.makeDynamicList(t);for(let{name:n,value:o}of this.attributes)this.makeDynamicAttribute(n,o,t);for(let n of this.childNodes)if(n instanceof Text){if((i=n.textContent)===null||i===void 0?void 0:i.includes("${")){let o=xr(n.textContent);t.watch(()=>n.textContent=o(t)||"")}}else e&&n.bindModel(t)}}bindVariable(t,e){}makeDynamicAttribute(t,e,i){if(t.startsWith("@")){let n=t.slice(1),o=zt(e);this.on(n,r=>o(i,{$event:r}))}else if(t===":show"){let n=zt(e);i.watch(()=>this.toggle(!!n(i)))}else if(t===":if"){let n=zt(e),o=Z(document.createComment(""));this.insertBefore(o);let r=!0;i.watch(()=>{let a=!!n(i);a!==r&&(a&&o.insertBefore(this),a||this.detach(),r=a)})}else if(t===":html"){let n=zt(e);i.watch(()=>this.html=n(i)||"")}else if(t===":draw"){let n=zt(e);i.watch(()=>this.draw(n(i)))}else if(t===":class"){let n=zt(e),o=this.attr("class")+" ";i.watch(()=>this.setAttr("class",o+n(i)))}else if(t===":bind")this.bindVariable(i,e);else if(t.startsWith(":")){let n=zt(e),o=t.slice(1);i.watch(()=>this.setAttr(o,n(i)))}else if(e.includes("${")){let n=xr(e);i.watch(()=>this.setAttr(t,n(i)||""))}(t.startsWith("@")||t.startsWith(":"))&&this.removeAttr(t)}makeDynamicList(t){let[e,i]=this.attr(":for").split(" in ");this.removeAttr(":for");let n=zt(i),o=Z(document.createComment(""));this.insertBefore(o),this.detach();let r=[],a=0;t.watch(()=>{let l=n(t);Array.isArray(l)||(l=[]);for(let h=l.length;h<a;++h)r[h].detach();for(let h=a;h<r.length;++h)o.insertBefore(r[h]);for(let h=r.length;h<l.length;++h){let p=this.copy(!0);p.bindModel(Xt({[e]:void 0},t)),o.insertBefore(p),r.push(p)}a=l.length;for(let h=0;h<a;++h)r[h].model[e]=l[h]})}get bounds(){return this._el.getBoundingClientRect()}get boundsRect(){let t=this.bounds;return new $(new c(t.x,t.y),t.width,t.height)}contains(t){this.boundsRect.contains(t)}get isInViewport(){if(this.height===0)return!1;let t=this.bounds;return ot(t.top,-t.height,w.height)}get topLeftPosition(){let t=this.bounds;return new c(t.left,t.top)}get boxCenter(){let t=this.bounds;return new c(t.left+t.width/2,t.top+t.height/2)}get scrollWidth(){return this._el.scrollWidth}get scrollHeight(){return this._el.scrollHeight}get scrollTop(){return this._el.scrollTop}set scrollTop(t){this._el.scrollTop=t,this.trigger("scroll",{top:t,left:this.scrollLeft})}get scrollLeft(){return this._el.scrollLeft}set scrollLeft(t){this._el.scrollLeft=t,this.trigger("scroll",{top:this.scrollTop,left:t})}scrollTo(t,e=1e3,i="cubic"){t<0&&(t=0);let n=this.scrollTop,o=t-n;this._data.scrollAnimation&&this._data.scrollAnimation.cancel(),this._data.scrollAnimation=X(r=>{let a=n+o*tt(i,r);this.scrollTop=a,this.trigger("scroll",{top:a})},e)}scrollBy(t,e=1e3,i="cubic"){!t||this.scrollTo(this.scrollTop+t,e,i)}css(t,e){if(e===void 0){if(typeof t=="string")return window.getComputedStyle(this._el).getPropertyValue(t);{let i=Object.keys(t);for(let n of i)this._el.style.setProperty(n,""+t[n])}}else typeof t=="string"&&this._el.style.setProperty(t,""+e)}get transform(){return this.css("transform").replace("none","")}get transformMatrix(){let t=this.transform;if(!t)return[[1,0,0],[0,1,0]];let e=t.match(/matrix\(([0-9,.\s-]*)\)/);if(!e||!e[1])return[[1,0,0],[0,1,0]];let i=e[1].split(",");return[[+i[0],+i[2],+i[4]],[+i[1],+i[3],+i[5]]]}get scale(){let t=this.transformMatrix;return[t[0][0],t[1][1]]}setTransform(t,e=0,i=1){let n="";t&&(n+=`translate(${pt(t.x,.1)}px,${pt(t.y,.1)}px)`),e&&(n+=` rotate(${e}rad)`),i&&(n+=` scale(${i})`),this._el.style.transform=n}translate(t,e){this.setTransform(new c(t,e))}show(){this.hasAttr("hidden")&&this.removeAttr("hidden"),this.data.display==="visibility"?this._el.style.visibility="visible":this._el.style.display=this.data.display||"block"}hide(){this.data.display==="visibility"?this._el.style.visibility="hidden":this._el.style.display="none"}toggle(t){t?this.show():this.hide()}is(t){return this._el.matches?this._el.matches(t):Array.from(document.querySelectorAll(t)).includes(this._el)}index(){let t=0,e=this._el;for(;(e=e.previousSibling||void 0)!==void 0;)++t;return t}prepend(t){let e=this._el.childNodes;e.length?this._el.insertBefore(t._el,e[0]):this._el.appendChild(t._el)}append(t){this._el.appendChild(t instanceof Text?t:t._el)}insertBefore(t){this.parent._el.insertBefore(t._el,this._el)}insertAfter(t){let e=this._el.nextSibling;e?this.parent._el.insertBefore(t._el,e):this.parent._el.appendChild(t._el)}get next(){return Z(this._el.nextSibling)}get prev(){return Z(this._el.previousSibling)}$(t){return Z(t,this)}$$(t){return tn(t,this)}get parent(){return Z(this._el.parentElement||void 0)}parents(t){let e=[],i=this.parent;for(;i;)(!t||i.is(t))&&e.push(i),i=i.parent;return e}hasParent(...t){let e=t.map(n=>n._el),i=this._el.parentNode;for(;i;){if(D(i,...e))return!0;i=i.parentNode}return!1}get children(){return Array.from(this._el.children||[],t=>Z(t))}get childNodes(){return Array.from(this._el.childNodes,t=>{if(!(t instanceof Comment))return t instanceof Text?t:Z(t)}).filter(t=>t)}restartAnimation(){let t=this.next,e=this.parent;this.detach(),t?t.insertBefore(this):e.append(this)}detach(){this._el&&this._el.parentNode&&this._el.parentNode.removeChild(this._el)}remove(){this.detach()}removeChildren(){for(;this._el.firstChild;)this._el.removeChild(this._el.firstChild)}on(t,e,i){for(let n of ct(t))n in this._events?this._events[n].includes(e)||this._events[n].push(e):this._events[n]=[e],Rh(this,n,e,i)}one(t,e,i){let n=o=>{this.off(t,n),e(o)};this.on(t,n,i)}off(t,e){for(let i of ct(t))i in this._events&&(this._events[i]=e?this._events[i].filter(n=>n!==e):[]),Gh(this,i,e)}trigger(t,e={}){for(let i of ct(t)){if(!this._events[i])return;for(let n of this._events[i])n.call(this,e)}}onKeyDown(t,e){let i=ct(t).map(n=>_t[n]||n);this._el.addEventListener("keydown",n=>{i.indexOf(n.keyCode)>=0&&e(n)})}onAttr(t,e){new MutationObserver(n=>{for(let o of n)o.type==="attributes"&&o.attributeName===t&&e(this.attr(t))}).observe(this._el,{attributes:!0}),e(this.attr(t),!0)}onPromise(t,e=!1){return e?Promise.resolve():new Promise(i=>this.one("solve",()=>i()))}animate(t,e=400,i=0,n="ease-in-out"){return wt(this,t,e,i,n)}enter(t="fade",e=500,i=0){return qh(this,t,e,i)}exit(t="fade",e=500,i=0,n=!1){return _h(this,t,e,i,n)}effect(t){this.one("animationend",()=>this.removeClass("effects-"+t)),this.addClass("effects-"+t)}copy(t=!0,e=!0,i){let n=Z(this._el.cloneNode(t));return e&&n.copyInlineStyles(this,t,i),n}copyInlineStyles(t,e=!0,i){let n=window.getComputedStyle(t._el);for(let o of i||Array.from(n))this.css(o,n.getPropertyValue(o));if(e){let o=this.children,r=t.children;for(let a=0;a<o.length;++a)o[a].copyInlineStyles(r[a],!0,i)}}},ce=class extends li{get offsetTop(){return this._el.offsetTop}get offsetLeft(){return this._el.offsetLeft}get offsetParent(){return Z(this._el.offsetParent||void 0)}get width(){return this._el.offsetWidth}get height(){return this._el.offsetHeight}get innerWidth(){let t=parseFloat(this.css("padding-left")),e=parseFloat(this.css("padding-right"));return this._el.clientWidth-t-e}get innerHeight(){let t=parseFloat(this.css("padding-bottom")),e=parseFloat(this.css("padding-top"));return this._el.clientHeight-t-e}get outerWidth(){let t=parseFloat(this.css("margin-left")),e=parseFloat(this.css("margin-right"));return this.width+t+e||0}get outerHeight(){let t=parseFloat(this.css("margin-bottom")),e=parseFloat(this.css("margin-top"));return this.height+t+e||0}get positionTop(){let t=this._el,e=0;for(;t;)e+=t.offsetTop,t=t.offsetParent;return e}get positionLeft(){let t=this._el,e=0;for(;t;)e+=t.offsetLeft,t=t.offsetParent;return e}offset(t){if(t._el===this._el.offsetParent){let e=this.offsetTop+t._el.clientTop,i=this.offsetLeft+t._el.clientLeft,n=e+this.height,o=i+this.width;return{top:e,left:i,bottom:n,right:o}}else{let e=t._el.getBoundingClientRect(),i=this._el.getBoundingClientRect();return{top:i.top-e.top,left:i.left-e.left,bottom:i.bottom-e.top,right:i.right-e.left}}}},Bh=["font-family","font-size","font-style","font-weight","letter-spacing","text-decoration","color","display","visibility","alignment-baseline","baseline-shift","text-anchor","clip","clip-path","clip-rule","mask","opacity","filter","fill","fill-rule","marker","marker-start","marker-mid","marker-end","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-width","text-rendering","transform","dominant-baseline"],en=class extends li{constructor(){super(...arguments);this.type="svg"}get $ownerSVG(){return Z(this._el.ownerSVGElement||void 0)}get width(){return this.bounds.width}get height(){return this.bounds.height}get positionLeft(){let t=this._el.getBBox().x+this._el.getCTM().e;return this.$ownerSVG.positionLeft+t}get positionTop(){let t=this._el.getBBox().y+this._el.getCTM().f;return this.$ownerSVG.positionTop+t}get inverseTransformMatrix(){let t=this._el.getScreenCTM().inverse(),e=[[t.a,t.c,t.e],[t.b,t.d,t.f]];if(w.isFirefox){let i=this.transformMatrix;e[0][2]-=i[0][2],e[1][2]-=i[1][2]}return e}setTransform(t,e=0,i=1){let n=t?`translate(${pt(t.x,.1)} ${pt(t.y,.1)})`:"",o=A(e,0)?"":`rotate(${e*180/Math.PI})`,r=A(i,1)?"":`scale(${i})`;this.setAttr("transform",[n,o,r].join(" "))}get strokeLength(){if(this._el instanceof SVGGeometryElement)return this._el.getTotalLength();{let t=this.bounds;return 2*t.height+2*t.width}}getPointAtLength(t){if(this._el instanceof SVGGeometryElement){let e=this._el.getPointAtLength(t);return new c(e.x,e.y)}else return new c(0,0)}getPointAt(t){return this.getPointAtLength(t*this.strokeLength)}get points(){return ve(this.attr("d"))}set points(t){let e=t.length?"M"+t.map(i=>i.x+","+i.y).join("L"):"";this.setAttr("d",e)}addPoint(t){let e=this.attr("d")+" L "+t.x+","+t.y;this.setAttr("d",e)}get center(){let t=+this.attr(this.tagName==="TEXT"?"x":"cx"),e=+this.attr(this.tagName==="TEXT"?"y":"cy");return new c(t,e)}setCenter(t){this.setAttr(this.tagName==="TEXT"?"x":"cx",t.x),this.setAttr(this.tagName==="TEXT"?"y":"cy",t.y)}setLine(t,e){this.setAttr("x1",t.x),this.setAttr("y1",t.y),this.setAttr("x2",e.x),this.setAttr("y2",e.y)}setRect(t){this.setAttr("x",t.p.x),this.setAttr("y",t.p.y),this.setAttr("width",t.w),this.setAttr("height",t.h)}draw(t,e={}){if(!t)return this.setAttr("d","");let i={mark:this.attr("mark"),arrows:this.attr("arrows"),size:+this.attr("size")||void 0,fill:this.hasClass("fill"),round:this.hasAttr("round")};this.setAttr("d",le(t,Ni(e,i)))}},Mr=class extends en{get viewBox(){return this._el.viewBox.baseVal||{width:0,height:0}}get $ownerSVG(){return this}get positionLeft(){return parseInt(this.css("margin-left"))+this.parent.positionLeft}get positionTop(){return parseInt(this.css("margin-top"))+this.parent.positionTop}get svgWidth(){return this.viewBox.width||this.width}get svgHeight(){return this.viewBox.height||this.height}drawPath(t,e={},i={}){let n=d("path",e,this);return n.draw(t,i),n}pngImage(t,e,i){return Wt(this,void 0,void 0,function*(){let n=this.copy(!0,!0,Bh);e||(e=t||this.svgHeight),t||(t=this.svgWidth),n.setAttr("width",t),n.setAttr("height",e),n.setAttr("viewBox",i||this.attr("viewBox")||`0 0 ${this.svgWidth} ${this.svgHeight}`),n.setAttr("xmlns","http://www.w3.org/2000/svg");let o=n.$$('image[href^="http"]');yield Promise.all(o.map(p=>Wt(this,void 0,void 0,function*(){let g=yield Ki(p.attr("href")),y=d("canvas",{width:g.width,height:g.height});y.ctx.drawImage(g,0,0,g.width,g.height);let x=yield y.pngImage;p.setAttr("href",x)})));let r=new XMLSerializer().serializeToString(n._el),a="data:image/svg+xml;utf8,"+encodeURIComponent(r),l=d("canvas",{width:t,height:e});l.ctx.fillStyle=Bt.css("background-color")||"white",l.ctx.fillRect(0,0,t,e);let h=yield Ki(a);return l.ctx.drawImage(h,0,0,t,e),l.pngImage})}downloadImage(t,e,i,n){let o=w.isIOS?window.open("","_blank"):void 0;this.pngImage(e,i,n).then(r=>{if(o)return o.location.href=r;d("a",{download:t,href:r,target:"_blank"})._el.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}))})}},sn=class extends ce{constructor(){super(...arguments);this.type="window"}get width(){return window.innerWidth}get height(){return window.innerHeight}get innerWidth(){return window.innerWidth}get innerHeight(){return window.innerHeight}get outerWidth(){return window.outerWidth}get outerHeight(){return window.outerHeight}get scrollWidth(){return document.body.scrollWidth}get scrollHeight(){return document.body.scrollHeight}get scrollTop(){return window.pageYOffset}set scrollTop(t){document.body.scrollTop=document.documentElement.scrollTop=t,this.trigger("scroll",{top:t,left:this.scrollLeft})}get scrollLeft(){return window.pageXOffset}set scrollLeft(t){document.body.scrollLeft=document.documentElement.scrollLeft=t,this.trigger("scroll",{top:this.scrollTop,left:t})}},Pr=class extends ce{constructor(){super(...arguments);this.type="form"}get action(){return this._el.action}get formData(){let t={};for(let e of Array.from(this._el.elements)){let i=e.name||e.id;i&&(t[i]=e.value)}return t}get isValid(){return this._el.checkValidity()}},kr=class extends ce{constructor(){super(...arguments);this.type="input"}get checked(){return this._el.checked||!1}set checked(t){this._el.checked=t}get value(){return this._el.value}set value(t){this._el.value=t}bindVariable(t,e){let i=this._el.type==="number",n=this._el.type==="checkbox";if(e in t?n?this.checked=t[e]:this.value=t[e]:this.value&&(n?t[e]=this.checked:t[e]=this.value),i){let o=this.hasAttr("min")?+this.attr("min"):-Infinity,r=this.hasAttr("max")?+this.attr("max"):Infinity;this.change(a=>t[e]=E(+a,o,r)),this.on("blur",()=>this.value=t[e])}else n?this.on("change",()=>t[e]=this.checked):this.change(o=>t[e]=o);t.watch(()=>{n?this.checked=t[e]:this.value=t[e]})}setInputPattern(t){if(isNaN(+t))return;let e=t.match(/^[0-9]+$/);this.setAttr("inputmode",e?"numeric":"decimal"),e&&this.setAttr("pattern","[0-9]*")}change(t){let e=this.value||"";this.on("change keyup input paste",()=>{this.value!==e&&(e=this.value.trim(),t(e))})}validate(t){this.change(e=>this.setValidity(t(e)))}setValidity(t){this._el.setCustomValidity(t)}get isValid(){return this._el.checkValidity()}},Cr=class extends ce{constructor(){super(...arguments);this.type="canvas"}getContext(t="2d",e={}){return this._el.getContext(t,e)}get pngImage(){return this._el.toDataURL("image/png")}get canvasWidth(){return this._el.width}get canvasHeight(){return this._el.height}get ctx(){return this._ctx||(this._ctx=this.getContext()),this._ctx}draw(t,e={}){this.ctx.save(),fr(this.ctx,t,e),this.ctx.restore()}clear(){this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)}fill(t){this.ctx.save(),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.restore()}clearCircle(t,e){this.ctx.save(),this.ctx.globalCompositeOperation="destination-out",this.ctx.beginPath(),this.ctx.arc(t.x,t.y,e,0,2*Math.PI,!1),this.ctx.fill(),this.ctx.restore()}downloadImage(t){let e=this.pngImage;d("a",{download:t,href:e,target:"_blank"})._el.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0}))}},Ar=class extends ce{play(){return this._el.play()||Promise.resolve()}pause(){return this._el.pause()}},Vr=["path","rect","circle","ellipse","polygon","polyline","g","defs","marker","line","text","tspan","pattern","mask","svg","foreignObject","image","use"];function Z(s,t){if(!s)return;let e=t?t._el:document.documentElement,i=typeof s=="string"?e.querySelector(s):s;if(!i)return;if(i._view)return i._view;let n=(i.tagName||"").toLowerCase();return n==="svg"?new Mr(i):n==="canvas"?new Cr(i):n==="form"?new Pr(i):n==="input"||n==="select"||n==="textarea"?new kr(i):n==="video"||n==="audio"?new Ar(i):Vr.includes(n)?new en(i):new ce(i)}function tn(s,t){let e=t?t._el:document.documentElement,i=s?e.querySelectorAll(s):[];return Array.from(i,n=>Z(n))}function d(s,t={},e){let i=Vr.includes(s)?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s);for(let[o,r]of Object.entries(t))r!==void 0&&(o==="id"?i.id=r:o==="html"?i.innerHTML=r:o==="text"?i.textContent=r:o==="path"?i.setAttribute("d",le(r)):i.setAttribute(o,r));let n=Z(i);return e&&e.append(n),n}var U=new sn(document.body),Bt=new sn(document.documentElement),_t={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46},Ji="_M",ze=window.navigator.userAgent.toLowerCase(),Er={};for(let[s,t]of Object.entries(_t))Er[t]=s;var Hh=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i,Lr=/iphone|ipad|ipod/i,Uh=/^((?!chrome|android).)*safari/i,Or=class{constructor(){var t,e,i;this.isMobile=Hh.test(ze),this.isRetina=(window.devicePixelRatio||1)>1,this.isTouch=!!window.Touch||"ontouchstart"in window,this.isChrome=!!window.chrome,this.isFirefox=ze.indexOf("firefox")>=0,this.isAndroid=ze.indexOf("android")>=0,this.isIOS=Lr.test(ze),this.isSafari=Lr.test(ze)||Uh.test(ze),this.loadQueue=[],this.loaded=!1,this.width=window.innerWidth,this.height=window.innerHeight,this.resizeCallbacks=[],this.theme={name:"light",isDark:!1},this.themeChangedCallbacks=[],this.themeOverride="",this.darkQuery=(t=window.matchMedia)===null||t===void 0?void 0:t.call(window,"(prefers-color-scheme: dark)"),window.onload=()=>this.afterLoad(),document.addEventListener("DOMContentLoaded",()=>this.afterLoad());let n=Ns(()=>this.applyResize());window.addEventListener("resize",n);try{(e=this.darkQuery)===null||e===void 0||e.addEventListener("change",()=>this.applyThemeChange())}catch(r){(i=this.darkQuery)===null||i===void 0||i.addListener(()=>this.applyThemeChange())}let o=this.getCookie("theme");o&&this.setTheme(o);try{this.localStorage=window.localStorage}catch(r){console.warn("Unable to access Local Storage in this context.")}}afterLoad(){if(!this.loaded){this.loaded=!0;for(let t of this.loadQueue)t();setTimeout(()=>this.resize())}}ready(t){this.loaded?t():this.loadQueue.push(t)}redraw(){document.body.offsetHeight}applyResize(){let t=window.innerWidth,e=window.innerHeight;if(!(this.width===t&&this.height===e)){this.width=t,this.height=e;for(let i of this.resizeCallbacks)i({width:this.width,height:this.height});U.trigger("scroll",{top:U.scrollTop})}}onResize(t){t({width:this.width,height:this.height}),this.resizeCallbacks.push(t)}offResize(t){let e=this.resizeCallbacks.indexOf(t);e>=0&&this.resizeCallbacks.splice(e,1)}resize(){this.applyResize()}applyThemeChange(){let t=this.theme.name,e=t==="dark"||t==="auto"&&this.darkQuery.matches;if(e!==this.theme.isDark){this.theme.isDark=e,Bt.setAttr("theme",this.themeOverride||(e?"dark":"light"));for(let i of this.themeChangedCallbacks)i(this.theme)}}setTheme(t){t!==this.theme.name&&(this.theme.name=t,this.setCookie("theme",t),this.applyThemeChange())}onThemeChange(t){this.themeChangedCallbacks.push(t)}getHash(){return window.location.hash.slice(1)}setHash(t){let e=document.body.scrollTop;window.location.hash=t,document.body.scrollTop=e}setURL(t,e=""){window.history.replaceState({},e,t),e&&(window.document.title=e)}getCookies(){let t=document.cookie.split(";"),e={};for(let i=0,n=t.length;i<n;++i){let o=t[i].split("=");e[decodeURIComponent(o[0]).trim()]=decodeURIComponent(o[1])}return e}getCookie(t){let e=document.cookie.match(new RegExp(`(^|;) ?${t}=([^;]*)(;|$)`));return e?e[2]:void 0}setCookie(t,e,i=60*60*24*365){let n=window.location.hostname.replace(/^[a-z]{2}\./,"");document.cookie=`${t}=${e};path=/;max-age=${i};domain=${n}`}deleteCookie(t){this.setCookie(t,"",-1)}setStorage(t,e){var i,n;let o=(t||"").split("."),r=zs(((i=this.localStorage)===null||i===void 0?void 0:i.getItem(Ji))||void 0),a=r;for(let l=0;l<o.length-1;++l)a[o[l]]==null&&(a[o[l]]={}),a=a[o[l]];a[o[o.length-1]]=e,(n=this.localStorage)===null||n===void 0||n.setItem(Ji,JSON.stringify(r))}getStorage(t){var e;let i=zs(((e=this.localStorage)===null||e===void 0?void 0:e.getItem(Ji))||void 0);if(!t)return i;let n=(t||"").split("."),o=n.pop();for(let r of n){if(!(r in i))return;i=i[r]}return i[o]}deleteStorage(t){var e;t?this.setStorage(t,void 0):(e=this.localStorage)===null||e===void 0||e.setItem(Ji,"")}getActiveInput(){let t=document.activeElement;return(t==null?void 0:t.shadowRoot)&&(t=t.shadowRoot.activeElement),t===document.body?void 0:Z(t)}onKey(t,e,i=!1){let n=ct(t),o=i?"keyup":"keydown";document.addEventListener(o,r=>{let a=Er[r.keyCode]||r.key;if(!n.includes(a))return;let l=this.getActiveInput();l&&l.is("input, textarea, [contenteditable]")||l&&["space","enter","tab"].includes(a)&&l.is("button, a, [tabindex]")||e(r,a)})}},w=window.BoostBrowser||new Or;window.BoostBrowser=w;var Zh=/\bTrident\/[567]\b|\bMSIE (?:9|10)\.0\b/,Fh=/\bAppleWebKit\/(\d+)\b/,jh=/\bEdge\/12\.(\d+)\b/,Wh=Zh.test(navigator.userAgent)||+(navigator.userAgent.match(jh)||[])[1]<10547||+(navigator.userAgent.match(Fh)||[])[1]<537,nn={};function Kh(){if(!Wh)return;Array.from(document.querySelectorAll("svg > use")).forEach(function(t){let e=t.getAttribute("xlink:href"),[i,n]=e.split("#");if(!i.length||!n)return;let o=t.parentNode;o.removeChild(t),i in nn||(nn[i]=fetch(i).then(a=>a.text())),nn[i].then(a=>{let l=document.implementation.createHTMLDocument("");l.documentElement.innerHTML=a;let p=l.getElementById(n).cloneNode(!0),g=document.createDocumentFragment();for(;p.childNodes.length;)g.appendChild(p.firstChild);o.appendChild(g)})})}var ts=!1;setTimeout(()=>ts=!0);var Xh="cubic-bezier(0.175, 0.885, 0.32, 1.275)",Yh="cubic-bezier(0.68, -0.275, 0.825, 0.115)",be={cancel:()=>{},promise:Promise.resolve()};function X(s,t){if(t===0)return s(1,0,()=>{}),be;let e=Date.now(),i=Ds(),n=0,o=!0,r=()=>{o=!1,i.reject()};function a(){o&&(!t||n<=t)&&window.requestAnimationFrame(a);let l=Date.now()-e;s(t?Math.min(1,l/t):l,l-n,r),t&&l>=t&&i.resolve(),n=l}return a(),{cancel:r,promise:i.promise}}function es(s,t=0,e=0){switch(s){case"quad":return Math.pow(t,2);case"cubic":return Math.pow(t,3);case"quart":return Math.pow(t,4);case"quint":return Math.pow(t,5);case"circ":return 1-Math.sqrt(1-Math.pow(t,2));case"sine":return 1-Math.cos(t*Math.PI/2);case"exp":return t<=0?0:Math.pow(2,10*(t-1));case"back":return e||(e=1.70158),t*t*((e+1)*t-e);case"elastic":return e||(e=.3),-Math.pow(2,10*(t-1))*Math.sin(((t-1)*2/e-.5)*Math.PI);case"swing":return .5-Math.cos(t*Math.PI)/2;case"spring":return 1-Math.cos(t*4.5*Math.PI)*Math.exp(-t*6);case"bounce":return t<1/11?1/64-7.5625*(.5/11-t)*(.5/11-t):t<3/11?1/16-7.5625*(2/11-t)*(2/11-t):t<7/11?1/4-7.5625*(5/11-t)*(5/11-t):1-7.5625*(1-t)*(1-t);default:return t}}function tt(s,t=0,e=0){if(t===0)return 0;if(t===1)return 1;let[i,n]=s.split("-");return n==="in"?es(i,t,e):n==="out"?1-es(i,1-t,e):t<=.5?es(i,2*t,e)/2:1-es(i,2*(1-t),e)/2}function wt(s,t,e=400,i=0,n="ease-in-out"){if(!ts)return Object.keys(t).forEach(f=>{let m=t[f];s.css(f,Array.isArray(m)?m[1]:m)}),be;n==="bounce-in"&&(n=Xh),n==="bounce-out"&&(n=Yh);let o="";w.isSafari&&(o=s._el.style.transition,s.css("transition","none"),w.redraw());let r=s._data.animation;r&&r.cancel();let a={},l={},h=Ds(),p=window.getComputedStyle(s._el);Object.keys(t).forEach(f=>{let m=t[f],v=Xo(f);l[v]=Array.isArray(m)?m[0]:p.getPropertyValue(f),a[v]=Array.isArray(m)?m[1]:m,i&&s.css(f,l[v])});let g=a.height;a.height==="auto"&&(a.height=q(s.children.map(f=>f.outerHeight))+"px");let y,x=!1;zi(()=>{x||(y=s._el.animate([l,a],{duration:e,easing:n,fill:"forwards"}),y.onfinish=()=>{s._el&&Object.keys(t).forEach(f=>s.css(f,f==="height"?g:a[f])),w.isSafari&&s.css("transition",o),h.resolve(),y.cancel()})},i);let G={cancel(){x=!0,s._el&&Object.keys(t).forEach(f=>s.css(f,s.css(f))),y&&y.cancel()},promise:h.promise};return setTimeout(()=>s._data.animation=G),G}var Qh=/matrix\([0-9.\-\s]+,[0-9.\-\s]+,[0-9.\-\s]+,[0-9.\-\s]+,([0-9.\-\s]+),([0-9.\-\s]+)\)/;function qh(s,t="fade",e=500,i=0){if(s.show(),!ts)return be;let n=+s.css("opacity")||1;if(t==="fade")return wt(s,{opacity:[0,n]},e,i);if(t==="pop"){let o=s.transform.replace(/scale\([0-9.]*\)/,"").replace(Qh,"translate($1px,$2px)");return wt(s,{opacity:[0,n]},e,i),wt(s,{transform:[o+" scale(0.5)",o+" scale(1)"]},e,i,"bounce-in")}else{if(t==="descend")return wt(s,{opacity:[0,1],transform:["translateY(-50%)","none"]},e,i);if(t.startsWith("draw")){let o=s.strokeLength;s.css("stroke-dasharray",o+"px"),s.css("opacity")||s.css("opacity",1);let r=t==="draw-reverse"?2*o+"px":0,a={"stroke-dashoffset":[o+"px",r]},l=wt(s,a,e,i,"linear");return l.promise.then(()=>s.css("stroke-dasharray","")),l}else if(t.startsWith("slide")){let o={opacity:[0,n],transform:["translateY(50px)","none"]};return t.includes("down")&&(o.transform[0]="translateY(-50px)"),t.includes("right")&&(o.transform[0]="translateX(-50px)"),t.includes("left")&&(o.transform[0]="translateX(50px)"),wt(s,o,e,i)}else if(t.startsWith("reveal")){let o={opacity:[0,n],height:[0,"auto"]};return t.includes("left")&&(o.transform=["translateX(-50%)","none"]),t.includes("right")&&(o.transform=["translateX(50%)","none"]),wt(s,o,e,i)}}return be}function _h(s,t="fade",e=400,i=0,n=!1){if(!s._el)return be;if(!ts)return s.hide(),be;if(s.css("display")==="none")return be;let o;if(t==="fade")o=wt(s,{opacity:[1,0]},e,i);else if(t==="pop"){let r=s.transform.replace(/scale\([0-9.]*\)/,"");wt(s,{opacity:[1,0]},e,i),o=wt(s,{transform:[r+" scale(1)",r+" scale(0.5)"]},e,i,"bounce-out")}else if(t==="ascend")o=wt(s,{opacity:[1,0],transform:["none","translateY(-50%)"]},e,i);else if(t.startsWith("draw")){let r=s.strokeLength;s.css("stroke-dasharray",r);let l={"stroke-dashoffset":[t==="draw-reverse"?2*r+"px":0,r+"px"]};o=wt(s,l,e,i,"linear")}else if(t.startsWith("slide")){let r={opacity:0,transform:"translateY(50px)"};t.includes("up")&&(r.transform="translateY(-50px)"),o=wt(s,r,e,i)}else if(t.startsWith("reveal")){let r={opacity:0,height:0};t.includes("left")&&(r.transform="translateX(-50%)"),t.includes("right")&&(r.transform="translateX(50%)"),o=wt(s,r,e,i)}return o.promise.then(()=>n?s.remove():s.hide()),o}var Jh="position: fixed; top: 0; left: 0; width: 100%; height: 4px; background: #0f82f2; pointer-events: none; z-index: 9999; will-change: transform;";function Ir(s,t){let e=t.regex.exec(s);if(e){e.shift();let i={};for(let[n,o]of t.params.entries())i[o]=e[n];return i}else return}function td(s,t,e){return Wt(this,void 0,void 0,function*(){return s.template?typeof s.template=="string"?s.template:s.template(t):(yield fetch(e+(e.indexOf("?")>=0?"&xhr=1":"?xhr=1"))).text()})}var Rr=document.readyState==="complete";window.addEventListener("load",()=>setTimeout(()=>Rr=!0));"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var Gr=class extends te{constructor(){super(...arguments);this.$viewport=U,this.views=[],this.active={path:"",hash:""},this.preloaded=!1,this.transition=!1,this.noLoad=!1,this.initialise=()=>{}}setup(t={}){t.$viewport&&(this.$viewport=t.$viewport),t.initialise&&(this.initialise=t.initialise),t.preloaded&&(this.preloaded=t.preloaded),t.transition&&(this.transition=t.transition),t.noLoad&&(this.noLoad=t.noLoad),t.click&&U.on("click",e=>this.onLinkClick(e)),t.history&&window.addEventListener("popstate",e=>Wt(this,void 0,void 0,function*(){var i;if(!Rr||!((i=e.state)===null||i===void 0?void 0:i.path))return;(yield this.load(e.state.path,e.state.hash))||window.history.pushState(this.active,"",this.active.path+this.active.hash)}))}view(t,{enter:e,exit:i,template:n}={}){let o=(t.match(/:\w+/g)||[]).map(y=>y.substr(1)),r=t.replace(/:\w+/g,"([\\w-]+)").replace("/","\\/")+"\\/?",a=t.includes("?")?"":"(\\?.*)?",h={regex:new RegExp("^"+r+a+"$","i"),params:o,enter:e,exit:i,template:n};this.views.push(h);let p=window.location.pathname+window.location.search,g=Ir(p,h);!g||(this.active={path:p,hash:window.location.hash},window.history.replaceState(this.active,"",this.active.path+this.active.hash),w.ready(()=>{setTimeout(()=>{this.preloaded?(this.initialise(this.$viewport,g),h.enter&&h.enter(this.$viewport,g)):this.loadView(h,g)})}))}paths(...t){for(let e of t)this.view(e)}getView(t){for(let e of this.views){let i=Ir(t,e);if(i)return{view:e,params:i}}}load(t,e){return Wt(this,void 0,void 0,function*(){if(t===this.active.path&&e!==this.active.hash)return this.trigger("hashChange",e.slice(1)),this.trigger("change",t+e),this.active={path:t,hash:e},!0;let i=this.getView(t);return!i||this.beforeChange&&!(yield this.beforeChange())?!1:(this.active={path:t,hash:e},this.trigger("change",t+e),window.ga&&window.ga("send","pageview",t+e),this.noLoad?i.view.enter&&i.view.enter(this.$viewport,i.params):this.loadView(i.view,i.params),!0)})}loadView(t,e={}){return Wt(this,void 0,void 0,function*(){this.showLoadingBar();let i=this.active.path,n=yield td(t,e,i);if(this.active.path!==i)return;yield this.$viewport.animate({opacity:0},200).promise,this.$viewport.removeChildren(),U.scrollTop=0,this.$viewport.html=n,w.resize(),Kh(),this.$viewport.animate({opacity:1},200),this.hideLoadingBar();let o=this.$viewport.$("title");o&&(document.title=o.text),this.initialise(this.$viewport,e),t.enter&&t.enter(this.$viewport,e),this.trigger("afterChange",{$viewport:this.$viewport})})}onLinkClick(t){if(t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;let e=t.target;for(;e&&e.nodeName!=="A";)e=e.parentNode;if(!e||e.nodeName!=="A")return;let i=e;if(i.target||i.origin!==window.location.origin||i.hasAttribute("download")||i.getAttribute("rel")==="external")return;let n=i.getAttribute("href");n&&n.indexOf("mailto:")>-1||this.getView(i.pathname+i.search)&&(t.preventDefault(),this.goTo(i.pathname+i.search,i.hash))}goTo(t,e=""){return Wt(this,void 0,void 0,function*(){let i=this.active.path+this.active.hash;(yield this.load(t,e))&&i!==this.active.path+this.active.hash&&window.history.pushState(this.active,"",t+e)})}replace(t,e=""){this.active={path:t,hash:e},window.history.replaceState(this.active,"",t+e)}back(){window.history.back()}forward(){window.history.forward()}showLoadingBar(){this.$loadingBar||(this.$loadingBar=d("div",{style:Jh},U)),this.$loadingBar.css({transform:"translateX(-100%)",opacity:1}),this.$loadingBar.show(),this.animation=X(t=>{this.$loadingBar.css("transform",`translateX(-${10+90*Math.exp(-4*t)}%)`)},3e3)}hideLoadingBar(){var t,e,i;return Wt(this,void 0,void 0,function*(){(t=this.animation)===null||t===void 0||t.cancel(),yield(e=this.$loadingBar)===null||e===void 0?void 0:e.animate({transform:"none",opacity:0}).promise,(i=this.$loadingBar)===null||i===void 0||i.hide()})}},Gt=new Gr;function ed(s,t){let e=Array.from(s.childNodes);s.innerHTML=t;let i={};for(let n of Array.from(s.querySelectorAll("slot")))i[n.getAttribute("name")||""]=n;for(let n of e){let o=n.getAttribute&&n.getAttribute("slot")||"",r=i[o]||i[""];r&&r.parentNode.insertBefore(n,r)}for(let n of Object.values(i))n.parentNode.removeChild(n)}function Dr(s){let t=[];for(let e of Array.from(s.children))e.tagName.startsWith("X-")?t.push(e):t.push(...Dr(e));return t}var Nr=new Map,zr=class extends HTMLElement{constructor(){super(...arguments);this.wasConnected=!1,this.isReady=!1}connectedCallback(){return Wt(this,void 0,void 0,function*(){if(this.wasConnected){this._view.trigger("connected");return}this.wasConnected=!0,this.isReady=!1,this._view.created();let t=Nr.get(this._view.tagName)||{};t.template&&ed(this,t.template);let e=Dr(this).filter(i=>!i.isReady).map(i=>new Promise(n=>i.addEventListener("ready",n)));yield Promise.all(e),this._view.ready(),this.dispatchEvent(new CustomEvent("ready")),this.isReady=!0})}disconnectedCallback(){this._view.trigger("disconnected")}},Y=class extends ce{created(){}ready(){}};function et(s,t={}){return function(e){class i extends zr{constructor(){super();this._view=new e(this)}}Nr.set(s.toUpperCase(),t),window.customElements.define(s,i)}}function is(s,t,e,i){let n,o;t:for(let[r,a]of e)for(let l of t){let h=(i?i(r,l):r).subtract(l),p=h.length;if(p<s&&(s=p,n=h,o=a,p<1))break t}return n?{shift:n,target:o}:void 0}function qr(s){if(ut(s))return[s];if(Ge(s))return s.points;if(De(s))return[s.p1,s.p2];if(rt(s))return[s.c.shift(s.r,0),s.c.shift(-s.r,0),s.c.shift(0,s.r),s.c.shift(0,-s.r)];if(ye(s)||ge(s)){let t=[s.start,s.end];ye(s)&&t.push(s.c);let e=s.radius;for(let[i,n]of[[e,0],[0,e],[-e,0],[0,-e]]){let o=s.c.shift(i,n);jt.prototype.contains.call(s,o)&&t.push(o)}return t}return[]}function we(...s){return $.aroundPoints(function*(){for(let t of s)for(let e of qr(t))yield e}())}function ss(s,t,e=0){if(!s.size&&!t.size)return new vt(0,100,0,100);let i=$.aroundPoints(function*(){for(let n of s)if(n.transformed)for(let o of qr(n.transformed))yield o;for(let n of t){yield n.segments[0].p1;for(let o of n.segments)yield o.p2}}());return new vt(i.p.x-e,i.p.x+i.w+e,i.p.y-e,i.p.y+i.h+e)}function ci(s,t,e){if(ut(t))return s.contains(t);if(Fi(t))return C.collision(s.polygon,t);if(Zs(t))return t.collision(s);if(yt(t))return St(t,s).length>0||s.contains(t.p1);if(rt(t))return e==="geo"?St(t,s).length>0||s.contains(t.at(0)):t.collision(s);if(ye(t)){let i=new C(t.c,t.start,t.at(.25),t.at(.5),t.at(.75),t.end);return C.collision(s.polygon,i)}return!1}var on=new Map;function O(s){if(!s||!w.theme.isDark)return s;if(on.has(s))return on.get(s);let t=V.fromHex(s).hsl;ot(t[2],20,80)||(t[2]=100-t[2]);let e=V.fromHsl(...t).hex;return on.set(s,e),e}function _r(s){let t=s==null?void 0:s.items;if(!!(t==null?void 0:t.length))for(let e=0;e<t.length;++e){if(!t[e].type.startsWith("image/"))continue;let i=t[e].getAsFile();if(i)return i}}var kt=180/Math.PI,nt=Math.PI/180,u={grey:"#cccccc",darkGrey:"#242436",red:"#cd0e66",orange:"#eb4726",yellow:"#fd8c00",lime:"#bfc212",green:"#22ab24",teal:"#009ea6",blue:"#0f82f2",purple:"#6d3bbf"},id="M12.5,0H0V25H12.5a12.5,12.5,0,0,0,0-25Z",sd="M0,0V12.5a12.5,12.5,0,0,0,25,0V0Z",ns=new Map,S=class{constructor(t,e,i){this.$parent=t;this.options="";this.colour="";this.posn=T;this.rot=0;this.flipped=!1;this.locked=!1;this.isActive=!1;this.snapAngles=[0,90];this.rotateAroundOrigin=!1;this.showSelectionOutline=!1;this.hideSelectionOutline=!1;this.canDragToSelect=!0;this.keepOnTop=!1;this.canRotate=!0;this.canMove=!0;this.$el=i||d("g",{class:"tile"},t.$tiles),t.tiles.add(this),ns.set(this.$el._el,this),this.id=e||Oe(10),t.tileMap.set(this.id,this)}makeHandle(t,e,i){let o=d(t==="c"?"circle":"path",{class:"handle"},this.$el);t==="h"&&o.setAttr("d",id),t==="v"&&o.setAttr("d",sd),t==="c"&&o.setAttr("r",10);let r="",a;return this.$parent.events.listen(o,{start:()=>{this.$parent.selection.add(this,!0),r=this.options,a=this.size},move:({posn:l})=>e(this.relativePosn(l),l),click:()=>i==null?void 0:i(),end:()=>{(this.options!==r||this.size!==a)&&this.$parent.change({tilesChanged:[this]})}}),o}is(t){return this.type===t}setColour(t){this.colour=t}setSize(t){this.size=t}lock(t=!0){t!==this.locked&&(this.$el.css("pointer-events",t?"none":"all"),this.locked=t,t&&this.$parent.selection.remove(this))}flip(t){this.flipped=!this.flipped}click(t){}select(){this.isActive=!0,this.$parent.$activeTiles.append(this.$el)}deselect(){this.isActive=!1,this.$parent.$tiles.append(this.$el)}moveStart(){this.startPosn=this.posn}move(t,e){t&&(this.posn=this.startPosn.add(t),this.transform(!0))}moveEnd(){this.collision&&this.collide(this.collision)}highlight(t=!0){}findNearby(t,e,i=this.posn){for(let n of this.$parent.tiles)if(n!==this&&n.is(t)&&c.distance(i,n.posn)<e)return n}setCollision(t){var e;t!==this.collision&&((e=this.collision)==null||e.highlight(!1)),this.collision=t,t==null||t.highlight(!0)}collide(t){}transform(t=!1){let e=this.rot*nt;this.$el.setTransform(this.posn,e),this.customTransform(this.posn,e),!t&&this.path&&(this.transformed=this.path.rotate(e).translate(this.posn),this.snapPoints=this.getSnapPoints().map(i=>i.rotate(e).translate(this.posn)),this.snapLines=this.getSnapLines().map(i=>i.rotate(e).translate(this.posn)))}customTransform(t,e){}setTransform(t,e=this.rot){this.posn=t,this.rot=Tt(e,360),this.transform()}animateTo(t,e=this.posn,i=400){return this.setTransform(t),X(n=>{n=tt("sine",n),this.$el.setTransform(c.interpolate(e,t,n),this.rot*nt)},i).promise}static makeThumbnail(t,e,i,n){}getSnapPoints(){return this.path?ut(this.path)?[this.path]:Ge(this.path)?this.path.points:yt(this.path)?[this.path.p1,this.path.p2]:rt(this.path)?[this.path.c,this.path.c.shift(0,this.path.r),this.path.c.shift(0,-this.path.r),this.path.c.shift(this.path.r,0),this.path.c.shift(-this.path.r,0)]:ye(this.path)?[this.path.c,this.path.start,this.path.end]:ge(this.path)?[this.path.start,this.path.end]:[]:[]}getSnapLines(){return[]}delete(){this.$parent.selection.remove(this),this.$parent.tiles.delete(this),this.$parent.tileMap.delete(this.id),ns.delete(this.$el._el),this.$el.remove(),this.$parent.trigger("delete-tile",{tile:this})}copy(t={},e=25){let i=new this.constructor(this.options,this.$parent);return this.colour&&i.setColour(this.colour),this.flipped&&i.flip(),i.setTransform(this.posn.shift(e,e),this.rot),this.size&&i.setSize(this.size),i}relativePosn(t){return t.subtract(this.posn).rotate(-this.rot*nt)}get center(){return this.path?we(this.path).center:T}get ariaDescription(){return`${this.type}: ${this.options}`}static action(t,e,i){}serialize(){return{id:this.id,name:this.type,options:this.options,x:this.posn.x,y:this.posn.y,rot:this.rot,size:this.size,flipped:this.flipped,locked:this.locked,colour:this.colour}}static unSerialize(t,e){if(!t.name)return;let i=e.newTile(t.name,t.options||"",t.id);return t.flipped&&i.flip(),i.setTransform(new c(t.x,t.y),t.rot),t.colour&&i.setColour(t.colour),t.size&&i.setSize(t.size),t.locked&&i.lock(),i}};var nd=3,od=.15;function Br(s,t,e,i=!1){let n=t||s,o=e||s,r=Math.atan2(o.y-n.y,o.x-n.x)+(i?Math.PI:0),a=c.distance(n,o)*od;return s.shift(Math.cos(r)*a,Math.sin(r)*a)}function rd(s){return s.length<=2?le(new ae(...s)):s.map((t,e)=>{if(e===0)return`M${t.x} ${t.y}`;if(c.distance(s[e-1],t)<4)return`L${t.x},${t.y}`;let i=Br(s[e-1],s[e-2],t),n=Br(t,s[e-1],s[e+1],!0);return`C${i.x},${i.y} ${n.x},${n.y} ${t.x},${t.y}`}).join("")}var ee=class{constructor(t,e,i,n,o){this.$parent=t;this.brush=n;this.path="";this.$el=d("path",{class:`stroke ${n}`},t.$strokes),this.setColor(i),t.strokes.add(this),e.length===1&&e.push(e[0].shift(.01)),this.draw(e),this.id=o||Oe(10),t.strokeMap.set(this.id,this)}setColor(t){this.color=t,this.$el.setAttr("stroke",O(t))}addPoint(t){this.segments.push(new H(L(this.segments).p2,t)),this.path+=`L${t.x},${t.y}`,this.$el.setAttr("d",this.path)}setLine(t){this.segments=[t],this.path=le(t),this.$el.setAttr("d",this.path)}makeSnapPoints(){this.snapPoints=Hi(...this.segments.map(t=>[t.p1,t.p2])),this.snapLines=this.segments}simplify(){let t=this.segments.map(n=>n.p1);t.push(L(this.segments).p2);let e=[t[0]],i=0;for(let n=2;n<t.length;++n){let o=new H(L(e),t[n]);t.slice(i+1,n).every(a=>o.contains(a,nd))||(e.push(t[n-1]),i=n-1)}e.push(L(t)),this.draw(e)}draw(t){this.path=rd(t),this.segments=new ae(...t).edges,this.$el.setAttr("d",this.path)}hitTest(t,e){let i=e**2;return this.segments.some(n=>n.distanceSquared(t)<i)}delete(){this.$parent.strokeMap.delete(this.id),this.$parent.strokes.delete(this),this.$el.remove()}serialize(t){return{points:this.path.slice(0,t),colour:this.color,brush:this.brush,id:this.id}}static unSerialize(t,e){let i=ve(t.points),n=new ee(e,i,t.colour||"#000",t.brush||"",t.id);return i.length===2&&n.makeSnapPoints(),n}};var rn=class extends Y{constructor(){super(...arguments);this.$options={}}ready(){let t=this.children;this.$active=this.$(".active")||t[0],this.$active.addClass("active");for(let[e,i]of t.entries())!D(i.tagName,"A","BUTTON")&&!i.hasAttr("tabindex")&&i.setAttr("tabindex",0),i.on("click",()=>this.makeActive(i)),this.$options[i.attr("value")||e]=i;this.trigger("change",this.$active)}makeActive(t){t!==this.$active&&(this.$active.removeClass("active"),this.$active=t,t.addClass("active"),this.trigger("change",t))}bindVariable(t,e){t[e]=this.$active.attr("value"),this.on("change",i=>t[e]=i.attr("value")),t.watch(()=>{let i=this.$options[t[e]];i&&this.makeActive(i)})}};rn=Q([et("x-select")],rn);var an=class extends Y{constructor(){super(...arguments);this.isOpen=!1}ready(){this.animation=this.attr("animation")||"pop",this.$bubble=this.$(".popup-body"),this.$bubble.hide(),this.$(".popup-target").on("click",()=>this.toggle()),this.on("clickOutside",()=>this.close());for(let e of this.$bubble.$$("a"))e.on("click",()=>this.close());w.onKey("escape",()=>this.close())}toggle(){this.isOpen?this.close():this.open()}open(){this.isOpen||(this.isOpen=!0,this.addClass("active"),this.$bubble.enter(this.animation,150),this.$bubble.setAttr("role","dialog"),this.$bubble.focus())}close(){!this.isOpen||(this.isOpen=!1,this.removeClass("active"),this.$bubble.exit(this.animation,150),this.$bubble.removeAttr("role"))}};an=Q([et("x-popup")],an);var Hr=new Map,qe,ad=d("div",{class:"snackbar"},U),ln=class extends Y{ready(){var t;ad.append(this),Hr.set(this.attr("key"),this),(t=this.$("button"))==null||t.on("click",()=>this.close())}open(t=2e3){return M(this,null,function*(){qe!==this&&(qe&&(yield qe.close()),qe=this,yield this.enter("pop",300).promise,this.setAttr("role","alert"),t&&setTimeout(()=>this.close(),t))})}close(){return M(this,null,function*(){qe===this&&(qe=void 0,this.removeAttr("role"),yield this.exit("pop",300).promise)})}};ln=Q([et("x-alert")],ln);function Ct(s,t=4e3){var e;return(e=Hr.get(s))==null?void 0:e.open(t)}var cn=class{constructor(t,e){this.$canvas=t;this.defaultCallbacks=e;this.callbacks=new WeakMap;this.isMoving=!1;this.shiftKey=!1;this.altKey=!1;this.cancelled=!1;setTimeout(()=>{document.addEventListener("keydown",i=>{this.shiftKey=i.shiftKey,this.altKey=i.altKey}),document.addEventListener("keyup",i=>{this.shiftKey=i.shiftKey,this.altKey=i.altKey}),document.addEventListener("visibilitychange",()=>{this.shiftKey=this.altKey=!1})},2e3),t.css("touch-action","none"),t.on("pointerdown",i=>this.startEvent(i)),w.onKey("escape",()=>this.cancel()),e.hover&&t.on("pointermove",i=>{this.isMoving||e.hover({posn:qt(i,t),event:i})})}listen(t,e){this.callbacks.set(t._el,e),t.hasParent(this.$canvas)||(t.css("touch-action","none"),t.on("pointerdown",i=>this.startEvent(i)))}startEvent(t){var h;if(t.handled)return;this.isMoving=!0,this.cancelled=!1,t.preventDefault();let e=t.pointerId,i=this.getCallbacks(t.target);"shiftKey"in t&&(this.shiftKey=t.shiftKey),i.blurInput!==!1&&((h=w.getActiveInput())==null||h.blur());let n=qt(t,this.$canvas),o=n,r=!1,a=p=>{if(p.pointerId&&p.pointerId!==e)return;if(p.preventDefault(),this.cancelled)return l(p);let g=qt(p,this.$canvas);c.distance(g,o)<.5||(!r&&i.start&&i.start({posn:n,event:p}),i.move&&i.move({posn:g,startPosn:n,lastPosn:o,event:p}),!r&&i.cursor!==!1&&Bt.addClass("grabbing"),o=g,r=!0)},l=p=>{var g,y;p.pointerId&&p.pointerId!==e||(p.preventDefault(),U.off("pointermove",a),U.off("pointerstop",l),r?(g=i.end)==null||g.call(i,{posn:o,lastPosn:o,startPosn:n,event:p,cancelled:this.cancelled}):this.cancelled||(y=i.click)==null||y.call(i,{posn:n,event:p}),Bt.removeClass("grabbing"),this.isMoving=this.cancelled=!1)};i.down&&i.down({posn:n,event:t}),U.on("pointermove",a),U.on("pointerstop",l)}getCallbacks(t){for(;t;){let e=this.callbacks.get(t);if(e&&(!e.checkIfActive||e.checkIfActive()))return e;t=t.parentNode||void 0}return this.defaultCallbacks}cancel(){this.cancelled=!0}};function hi(s,t,e){return s.hasAttr(t)?s.attr(t)!=="no":e}var hn={hasGeoModel:!0,pi:Math.PI,point:(s,t)=>s!==void 0&&t!==void 0?new c(s,t):void 0,angle:(s,t,e)=>s&&t&&e?new ft(s,t,e):void 0,line:(s,t)=>s&&t&&!s.equals(t)?new st(s,t):void 0,ray:(s,t)=>s&&t&&!s.equals(t)?new ni(s,t):void 0,segment:(s,t)=>s&&t&&!s.equals(t)?new H(s,t):void 0,circle:(s,t)=>s&&t?new _(s,t):void 0,arc:(s,t,e)=>s&&t&&e?new jt(s,t,e):void 0,sector:(s,t,e)=>s&&t&&e?new re(s,t,e):void 0,polygon:(...s)=>s.every(t=>t)?new C(...s):void 0,polyline:(...s)=>s.every(t=>t)?new ae(...s):void 0,triangle:(s,t,e)=>s&&t&&e?new js(s,t,e):void 0,rectangle:(s,t,e)=>s?new $(s,t,e):void 0,distance:c.distance,round:(s,t=0)=>Nt(s,t),sqrt:Math.sqrt,floor:Math.floor,ceil:Math.ceil,intersections:St};function os(s,t){return yt(s)?s.offset(t):rt(s)?new st(s.c,t).angle/2/Math.PI:ge(s)?new ft(s.start,s.c,t).rad/s.angle:.5}var Ht=Xt({});Ht.assign(hn);var he=new Map,di=new Map,ld=/^_x[0-9]+\.at\([0-9-.e]+\)$/,cd=/^intersections\(|\.midpoint$|\.centroid$/,j=class extends S{constructor(t,e,i){super(e,i,d("path",{class:"geo-path"},e.$geoPaths));this.$parent=e;this.type="geo";this.hideSelectionOutline=!0;this.isProjection=!1;this.parentKeys=[];this.deleted=!1;this.onDraw=()=>this.draw();this.$shadow=d("path",{class:"geo-shadow"},e.$geoShadows),this.options=t;let[n,o]=t.split("=");o||(o=n,n=Ht.getKey()),this.key=n,he.set(n,this),this.snapPoints=this.snapLines=this.snapAngles=[],this.setExpr(o),Ht.watch(this.onDraw),this.setColour(e.penColour)}setExpr(t,e=!1){let i=zt(t);Ht.setComputed(this.key,i),!e&&(this.options=`${this.key}=${t}`,this.expr=t,this.setParentKeys(t.match(/_x[0-9]+/g)||[]),this.isProjection=ld.test(t),this.locked=cd.test(t),this.$el.setClass("locked",this.locked))}draw(){let t=Ht[this.key];if(t===this.path)return;this.path=t,this.$el.toggle(!!t),this.isActive&&!t&&this.$shadow.hide();let e=t==null?void 0:t.type;e!==this.geoType&&(this.$el.setClass("geo-point",e==="point"),this.$el.setClass("geo-path",e!=="point"),(e==="point"?this.$parent.$geoPoints:this.$parent.$geoPaths).append(this.$el),this.geoType=e),!!t&&(e==="point"&&(t=new _(t,this.locked?3.5:6)),this.$el.draw(t,{box:this.$parent.canvasBounds.rect}),this.$shadow.setAttr("d",this.$el.attr("d")),this.transform())}setParentKeys(t){var e;for(let i of this.parentKeys)(e=di.get(i))==null||e.delete(this.key);this.parentKeys=t;for(let i of t)di.has(i)||di.set(i,new Set),di.get(i).add(this.key)}get parents(){return this.parentKeys.map(t=>he.get(t)).filter(t=>t)}get children(){let t=di.get(this.key);return t?Array.from(t).map(e=>he.get(e)).filter(e=>e):[]}get ariaDescription(){var t;return`${(t=this.path)==null?void 0:t.type} ${this.key}: ${this.expr}`}select(){var t;this.isActive=!0,this.path&&this.$shadow.show(),(t=this.$el.parent)==null||t.append(this.$el)}deselect(){this.isActive=!1,this.$shadow.hide()}hover(t=!0){this.isActive||!this.path||(t?this.$shadow.show():this.$shadow.hide())}transform(){this.transformed=this.path,this.pending||(this.snapPoints=this.path&&ut(this.path)?[this.path]:[],this.snapLines=!this.path||ut(this.path)?[]:[this.path])}setTransform(){this.transform()}setColour(t){var e,i;this.colour=t,(e=this.$el)==null||e.css("color",O(t)),(i=this.$shadow)==null||i.css("color",O(t))}copy(t={}){if(!this.path)return;if(t[this.key])return t[this.key];let e=this.expr;if(ut(this.path))e=`point(${this.path.x+25},${this.path.y+25})`;else for(let i of this.parents){let n=t[i.key]||i.copy(t);e=e.replace(i.key,n.key)}return t[this.key]=new j(e,this.$parent)}delete(){this.deleted=!0,super.delete(),Ht.unwatch(this.onDraw),Ht[this.key]=void 0,he.delete(this.key),this.$shadow.remove();for(let t of this.parents)t.geoType==="point"&&!t.deleted&&!t.parentKeys.length&&!t.children.length&&t.delete();for(let t of this.children)t.delete()}setPending(t=!0){this.pending=t,t||this.transform();for(let e of this.children)e.setPending(t)}moveStart(){if(!(this.locked||!this.path)){if(this.isProjection){if(this.$parent.selection.size>1)return;this.setParentKeys([])}this.setPending(!0);for(let t of this.parents)t.moveStart();this.moveStartValue=this.transformed}}move(t,e){if(!(!t||!this.path||!this.moveStartValue))if(ut(this.path))this.snapTarget=e,this.$el.setClass("locked",this.locked||!!(e==null?void 0:e.intersection)),Ht[this.key]=this.moveStartValue.translate(t);else for(let i of this.parents)i.move(t)}moveEnd(){var t,e,i,n;if(!!this.moveStartValue){for(let o of this.parents)o.moveEnd();if(this.setPending(!1),(t=this.snapTarget)==null?void 0:t.intersection)this.setExpr(this.snapTarget.intersection.expr);else if(((i=(e=this.snapTarget)==null?void 0:e.tile)==null?void 0:i.type)==="geo"){let o=(n=this.snapTarget)==null?void 0:n.tile;if(o.path&&ut(o.path)){for(let r of this.children)r.setExpr(r.expr.replace(this.key,o.key));return this.$parent.selection.add(o),this.delete()}else if(o.path){let r=os(o.path,Ht[this.key]);this.setExpr(`${o.key}.at(${r})`)}}}}static get tiles(){return he.values()}static computeIntersections(t){t.intersections.clear();let e=Array.from(he.values()).filter(n=>n.path&&!ut(n.path)),i=e.length;for(let n=0;n<i;++n)for(let o=n+1;o<i;++o){let r=St(e[n].path,e[o].path);for(let[a,l]of r.entries())t.intersections.add({value:l,expr:`intersections(${e[n].key},${e[o].key})[${a}]`})}}static getInferredShape(t){let e=t.filter(a=>a.type==="geo"&&a.path);if(!e.length)return;if(e.length===1)return{type:e[0].path.type,expr:e[0].key};let i=e.filter(a=>ut(a.path)),n=e.filter(a=>yt(a.path)||rt(a.path));if(n.length===1&&i.length===e.length-1){let a=n[0].path;if(i.every(l=>a.contains(l.path)))return{type:a.type,expr:n[0].key}}let o=n.filter(a=>yt(a.path));if(i.length+o.length!==e.length)return;for(let a of o)if(De(a.path)){let l=a.parentKeys.map(h=>he.get(h));for(let h of l)i.includes(h)||i.push(h)}else if(i.filter(l=>a.path.contains(l.path)).length<2)return;let r=i.map(a=>a.key).join(",");return i.length===2?{type:"segment",expr:`segment(${r})`}:i.length===3?{type:"triangle",expr:`triangle(${r})`}:{type:"polygon",expr:`polygon(${r})`}}static construct(t,e,i){if(t=t.replace(/\$0/g,e||""),t.includes("$1"))i.tools.geoPending.enable(t);else{let n=new j(t,i);i.selection.add(n,!0);let o=ut(n.path)?"pop":"draw";n.$el.enter(o,400),n.$shadow.enter(o,400),j.computeIntersections(i)}}static redrawLines(t){for(let e of he.values())e.path&&Fs(e.path)&&(e.$el.draw(e.path,{box:t}),e.$shadow.setAttr("d",e.$el.attr("d")))}static clearModel(){Ht.clear(),Ht.assign(hn)}};var hd=[[0,0]],Ur=[[0,-39],[0,39]],dd=[...Ur,[0,0]],rs=[[-18,-39],[18,-39],[-18,39],[18,39]],pd=[...rs,[0,0]],Zr=[...rs,[-18,0],[18,0]],ud=[...Zr,[0,-19]],dn=[...rs,[-18,-13],[18,-13],[-18,13],[18,13]],fd=[...dn,[0,0]],md=[...dn,[0,-26],[0,26]],gd={C:"#333",S:"#333",H:u.orange,D:u.orange},yd={A:hd,2:Ur,3:dd,4:rs,5:pd,6:Zr,7:ud,8:dn,9:fd,10:md},vd="AH:2H:3H:4H:5H:6H:7H:8H:9H:0H:JH:QH:KH:AC:2C:3C:4C:5C:6C:7C:8C:9C:0C:JC:QC:KC:KD:QD:JD:0D:9D:8D:7D:6D:5D:4D:3D:2D:1D:KS:QS:JS:0S:9S:8S:7S:6S:5S:4S:3S:2S:1S";function Fr(s,t){s.removeChildren();let[e,i,n]=t.split("");if(n)return d("rect",{x:-39,y:-57,width:78,height:114,rx:2,fill:"url(#card-bg)"},s);e==="0"&&(e="10"),s.setAttr("fill",gd[i]);let o=`#suit-${i.toLowerCase()}`;if(i==="J")d("image",{href:"https://mathigon.org/images/polypad/cards/joker.svg",style:"transform: translate(-35px, -53px)",width:70},s),e="Joker";else if(["K","Q","J"].includes(e))d("use",{href:o,style:"transform: translate(-35px, -36px) scale(0.6)",width:24,height:24},s),d("use",{href:o,style:"transform: rotate(180deg) translate(-35px, -36px) scale(0.6)",width:24,height:24},s),d("image",{href:`https://mathigon.org/images/polypad/cards/${t.toLowerCase()}.svg`,style:"transform: translate(-35px, -53px)",width:70},s);else{let a=e==="A"?" scale(1.7)":"";for(let l of yd[e]||[]){let h=l[1]>0?" rotate(180deg)":"";d("use",{href:o,style:`transform: translate(${l[0]}px, ${l[1]}px)`+h+a,width:24,height:24},s)}}let r={text:e,x:-40,y:-45,style:"font-size: 16px; letter-spacing: -1px;"};d("text",r,s),d("text",Zt(Zt({},r),{style:"transform: rotate(180deg)"}),s)}var _e=class extends S{constructor(t,e){super(e);this.type="card";this.count=0;this.$stack=d("rect",{class:"polygon-tile",fill:"#bbb",rx:10},this.$el),this.$path=d("rect",{class:"polygon-tile",fill:"#eee",rx:10},this.$el),this.$body=d("g",{transform:"scale(1.4)"},this.$el),this.$outline=d("rect",{class:"outline",rx:10},this.$el),this.path=new $(new c(-125/2,-175/2),125,175);for(let i of[this.$stack,this.$path,this.$outline])i.setRect(this.path);this.setOptions(t==="deck"?vd:t)}setOptions(t){if(t===this.options)return;this.options=t;let e=t.split(":");this.count=e.length,this.$stack.setTransform({x:0,y:Math.sqrt(this.count-1)*3}),this.value=q(e.map(i=>+({A:1,J:11,Q:12,K:13}[i[0]]||i[0]))),Fr(this.$body,L(e))}setColour(t){super.setColour(t||u.blue)}addCards(t){this.setOptions(this.options+":"+t)}highlight(t=!0){this.$outline.setClass("active",t)}move(t){super.move(t),!(this.$parent.selection.tiles.size>1)}collide(t){t.highlight(!1),t.addCards(this.options),this.$parent.selection.add(t,!0),this.delete()}flip(){let t=this.options.split(":").reverse();this.setOptions(t.map(e=>e.length>2?e.slice(0,2):e+"f").join(":"))}draw(){return M(this,null,function*(){if(this.count<=1)return;this.$parent.selection.clear();let t=this.options.split(":"),e=t.pop();this.setOptions(t.join(":"));let i=new _e(e,this.$parent);i.rot=this.rot,yield i.animateTo(this.posn.shift(150,0),this.posn),this.$parent.selection.add(i)})}shuffle(){this.count<=1||this.setOptions(Mt.shuffle(this.options.split(":")).join(":"))}static action(t,e){return M(this,null,function*(){if(t==="stack"){let i=Array.from(e),n=i.map(r=>r.options).join(":"),o=new _e(n,i[0].$parent);o.setTransform(c.average(...i.map(r=>r.posn)));for(let r of e)r.delete();i[0].$parent.selection.add(o)}else if(t==="flip")for(let i of e)i.flip();else if(t==="draw")for(let i of e)i.draw();else if(t==="shuffle")for(let i of e)i.shuffle();e[0].$parent.change({tilesChanged:e})})}static makeThumbnail(t,e){let i=d("svg",{width:60,height:74},e);d("rect",{x:5,y:2,width:50,height:70,fill:"white",rx:4},i);let n=d("g",{style:"transform: translate(30px, 37px) scale(0.55)"},i);e.onAttr("data-options",o=>Fr(n,o))}};function xe(s){let t=Math.cos(2*Math.PI/s);return 1/Math.sqrt(2-2*t)}var pn=s=>Tt(Math.round(s.angle*kt),180),bt=s=>s.map(t=>`${Nt(t.x,3)} ${Nt(t.y,3)}`).join(",");function as(s,t){let e=new c(-s/2,-t/2);return bt(new $(e,s,t).points)}var k=50,F=Math.sqrt(3)/4*k,un=new st(T,new c(0,1)),jr={"equ-triangle":new C(new c(-k/2,F),new c(k/2,F),new c(0,-F)),square:C.regular(4,k*xe(4)),"reg-pentagon":C.regular(5,k*xe(5)),"reg-hexagon":C.regular(6,k*xe(6)),"reg-heptagon":C.regular(7,k*xe(7)),"reg-octagon":C.regular(8,k*xe(8)),"reg-decagon":C.regular(10,k*xe(10)),"reg-dodecagon":C.regular(12,k*xe(12)),rectangle:new $(new c(-k,-k/2),2*k,k).polygon,trapezium:new C(new c(-k,F),new c(k,F),new c(k/2,-F),new c(-k/2,-F)),rhombus:new C(new c(-k*3/4,F),new c(k/4,F),new c(k*3/4,-F),new c(-k/4,-F)),"right-triangle":new C(new c(-k/2,-k/2),new c(k/2,-k/2),new c(-k/2,k/2)),"rhombus-2":new C(new c(k/2-F,k/4),new c(-F-k/2,k/4),new c(F-k/2,-k/4),new c(F+k/2,-k/4)),chevron:new C(new c(-.75*k,2*F),new c(.25*k,2*F),new c(.75*k,0),new c(.25*k,-2*F),new c(-.75*k,-2*F),new c(-.25*k,0)),"right-triangle-2":new C(new c(-2*F,-k/2),new c(-2*F,k/2),new c(2*F,-k/2)),kite:new C(new c(0,-k),new c(2*F,-k/2),new c(0,k),new c(-2*F,-k/2)),dart:new C(new c(2*F,.75*k),new c(0,-.75*k),new c(-2*F,.75*k),new c(0,.25*k))},Wr=["","","",u.yellow,u.blue,u.green,u.red,u.teal,u.purple,"",u.lime,"",u.orange],Kr={trapezium:u.red,"right-triangle":u.green,"rhombus-2":u.orange,chevron:u.orange,kite:u.purple,dart:u.teal},Xr={"equ-triangle":u.green,square:u.yellow,"reg-pentagon":u.blue,"reg-hexagon":"#ffd615","reg-decagon":u.red,rectangle:u.yellow,trapezium:"#cc1030",rhombus:u.blue,"rhombus-2":"#e6e2c6",chevron:"#cc1030","right-triangle-2":"#ffd615",kite:"#134791",dart:u.purple};function ls(s){if(s in jr)return jr[s];if(s.match(/^[0-9.,\-\s]+$/)){let t=s.split(",").map(e=>new c(...e.split(" ").map(i=>+i)));return new C(...t)}throw new Error("Unknown polygon type.")}var bd=["trapezium","rhombus","rhombus-2","rectangle","right-triangle","right-triangle-2"],wd=["equ-triangle","square","reg-pentagon","reg-hexagon","reg-heptagon","reg-octagon","reg-decagon","reg-dodecagon","rectangle","trapezium","kite","dart"],B=class extends S{constructor(t,e,i){super(e,i);this.type="polygon";this.options=t,this.path=ls(t),this.snapAngles=Et(this.path.edges.map(pn)),this.symmetric=wd.includes(t);let n=e.options.altColors?Xr:Kr;this.colour=n[t]||Wr[this.path.points.length];let o=$.aroundPoints(this.path.points),r=new c(o.center.x,o.p.y);this.showSelectionOutline=c.distance(r,this.path.project(r))>5;let a={class:"polygon-tile",path:this.path,fill:this.colour};this.$path=d("path",a,this.$el),this.$outline=d("path",{class:"outline",path:this.path},this.$el)}static makeThumbnail(t,e,i,n){let o=bd.includes(t)?30:40,r=ls(t),a=Math.max(...r.points.map(p=>p.length));r=r.scale(36/a).shift(40,o);let l=d("svg",{width:80,height:2*o},e),h=d("path",{class:"polygon-tile",path:r},l);i.options.watch(p=>{let g=p.altColors?Xr:Kr,y=n||g[t]||Wr[r.points.length];h.setAttr("fill",y)})}setColour(t){super.setColour(t),this.$path.setAttr("fill",O(this.colour))}flip(t){t&&(this.posn=new c(2*t.x-this.posn.x,this.posn.y)),this.rot=-this.rot,this.flipped=!this.flipped,this.symmetric||(this.path=this.path.reflect(un),this.$path.draw(this.path),this.$outline.draw(this.path)),this.transform()}static action(t,e,i){if(t==="flip"){for(let n of e)n.flip(i);e.values().next().value.$parent.selection.update()}e[0].$parent.change({tilesChanged:e})}};var xd=[[0,-.2],[1.2,-1],[.6,1],[-.6,1],[-1.2,-.2]],Yr=xd.map(s=>new c(s[0]*50,s[1]*50)),fn=class extends B{constructor(t,e,i){super(t||bt(Yr),e,i);this.type="custom-polygon";this.$handles=[];this.showSelectionOutline=!0;for(let[o,r]of this.path.points.entries())this.makeVertex(r,o);this.updatePath();let n;this.$parent.events.listen(this.$outline,{down:({posn:o})=>{o=this.relativePosn(o);let r=this.path.edges.findIndex(a=>o.distanceFromLine(a)<5);n=this.makeVertex(o,(r+1)%this.$handles.length),this.updatePath()},move:({posn:o})=>{n&&this.moveVertex(n,o)},end:()=>{n&&this.$parent.change({tilesChanged:[this]})}}),this.$outline.css("cursor","crosshair")}makeVertex(t,e){if(this.$handles.length>=24)return;let i=this.makeHandle("c",(n,o)=>this.moveVertex(i,o),()=>this.deleteVertex(i));return i.setCenter(t),i.setAttr("r",8),i.css("cursor","move"),this.$handles.splice(e,0,i),i}deleteVertex(t){t.remove(),this.$handles.splice(this.$handles.indexOf(t),1),this.updatePath()}moveVertex(t,e){var n;let i=(n=this.$parent.snap([e]))==null?void 0:n.shift;t.setCenter(this.relativePosn(i?e.add(i):e)),this.updatePath()}updatePath(){let t=this.$handles.map(e=>e.center);this.path=new C(...t),this.$path.draw(this.path),this.$outline.draw(this.path),this.transform(),this.snapAngles=Et(this.path.edges.map(pn)),this.options=bt(t),this.$parent.selection.update()}flip(t){t&&(this.posn=new c(2*t.x-this.posn.x,this.posn.y)),this.rot=-this.rot,this.transform();for(let e of this.$handles)e.setCenter(e.center.reflect(un));this.updatePath()}lock(){let t=new B(this.options,this.$parent);return t.setColour(this.colour),t.setTransform(this.posn,this.rot),this.$parent.selection.add(t),this.delete(),t}static makeThumbnail(t,e){let i=new C(...Yr).scale(.5).shift(40),n=d("svg",{width:80,height:80},e);d("path",{class:"polygon-tile",path:i,fill:u.green},n);for(let o of i.points)d("circle",{cx:o.x,cy:o.y,r:3,fill:"white"},n)}static action(t,e){if(t==="lock"){let i=[];for(let n of Array.from(e))i.push(n.lock());e[0].$parent.change({tilesAdded:i,tilesDeleted:e})}}};var mn=25/2,Qr=[[[0,2],[0,-4],[-2,-4],[-2,4],[2,4],[2,2],[0,2]],[[0,0],[0,-4],[-2,-4],[-2,2],[0,2],[0,4],[2,4],[2,0],[0,0]],[[-5,-1],[5,-1],[5,1],[-5,1]],[[-3,-2],[-3,2],[1,2],[1,0],[3,0],[3,-2],[-3,-2]],[[3,-2],[3,0],[1,0],[1,-2],[-1,-2],[-1,2],[5,2],[5,-2],[3,-2]],[[-1,-3],[-1,-1],[-3,-1],[-3,3],[-1,3],[-1,1],[1,1],[1,-1],[3,-1],[3,-3],[-1,-3]],[[1,1],[1,-3],[-1,-3],[-1,1],[-3,1],[-3,3],[3,3],[3,1],[1,1]],[[1,-1],[1,-3],[-1,-3],[-1,-1],[-3,-1],[-3,1],[-1,1],[-1,3],[1,3],[1,1],[3,1],[3,-1],[1,-1]],[[-1,-3],[-1,-1],[-3,-1],[-3,1],[-1,1],[-1,3],[1,3],[1,-1],[3,-1],[3,-3],[-1,-3]],[[-4,-2],[-4,0],[-2,0],[-2,2],[0,2],[0,0],[4,0],[4,-2],[-4,-2]],[[-1,-3],[-1,1],[-3,1],[-3,3],[1,3],[1,-1],[3,-1],[3,-3],[-1,-3]],[[-1,-3],[-1,1],[-5,1],[-5,3],[1,3],[1,-3],[-1,-3]],[[-1,2],[1,2],[1,0],[3,0],[3,-2],[-3,-2],[-3,0],[-1,0]],[[-3,2],[-3,0],[-1,0],[-1,-2],[3,-2],[3,0],[1,0],[1,2]],[[-3,2],[-3,-2],[3,-2],[3,0],[-1,0],[-1,2]],[[-2,2],[2,2],[2,-2],[-2,-2]],[[-4,1],[4,1],[4,-1],[-4,-1]]].map(s=>s.map(t=>new c(t[0]*mn,t[1]*mn))),$d=[[2,4],[4,4],[5,9],[7,2],[7,6],[11,3],[13,7],[15,3],[17,7],[20,2],[21,5],[23,7],[3,2],[7,2],[5,6],[10,4],[8,7]],Jr=[...V.rainbow(12).map(s=>s.hex),u.red,u.blue,u.green,u.yellow,u.purple],gn=class extends B{constructor(t,e,i){super(bt(Qr[+t]),e,i);this.type="pentomino";this.options=t,this.setColour(Jr[+t])}static makeThumbnail(t,e){let i=$d[+t],n=new C(...Qr[+t]).scale(10/mn);e.draw(n.shift(10*i[0],10*i[1]).shift(1,1)),e.setAttr("fill",Jr[+t])}};var ta=[[[-4,-2],[0,2],[4,-2]],[[-4,-2],[0,2],[4,-2]],[[-2,0],[0,-2],[2,0],[0,2]],[[-3,1],[1,1],[3,-1],[-1,-1]],[[0,-1],[2,1],[-2,1]],[[0,-1],[2,1],[-2,1]],[[-2,-2],[2,-2],[2,2]]],ea=[u.red,u.blue,u.green,u.yellow,u.orange,u.teal,u.purple],Td=[[2,4],[4,2],[6,4],[3,7],[7,2],[4,5],[6,6]],ia=[-90,0,0,0,-90,0,90],Sd=25,yn=class extends B{constructor(t,e,i){super(bt(ta[+t].map(n=>new c(...n).scale(Sd))),e,i);this.type="tangram";this.snapAngles=[0,45,90,135];this.options=t,this.setColour(ea[+t]),this.rot=ia[+t],this.transform()}static makeThumbnail(t,e,i,n){let o=Td[+t],r=ta[+t].map(l=>new c(...l).rotate(ia[+t]*nt).shift(...o).scale(18).shift(2,2)),a=new C(...r);e.draw(a),e.setAttr("fill",n||ea[+t])}getSnapLines(){return this.path.edges}};var sa=25,pi=(1+Math.sqrt(5))/2*sa,cs=Math.sqrt((5+Math.sqrt(5))/2)*sa,ui=pi*(Math.sqrt(5)-1)/2,na=[`0 ${-pi},${cs} ${-ui},0 ${pi},${-cs} ${-ui}`,`0 ${2*ui-pi},${cs} ${ui},0 ${-pi},${-cs} ${ui}`],oa=[["M29.4-30.9C25.3-18.2,13.4-9.5,0-9.5c-13.4,0-25.3-8.6-29.4-21.4","M29.4,0C20.8-6.2,10.6-9.5,0-9.5c-10.6,0-20.8,3.3-29.4,9.5"],["M18.2,15.5C20.1,9.6,19,3.3,15.5-1.7C11.9-6.6,6.1-9.5,0-9.5c-6.1,0-11.9,2.9-15.5,7.9c-3.6,4.9-4.6,11.3-2.7,17.1","M18.2-15.5C12.9-11.6,6.5-9.5,0-9.5c-6.5,0-12.9-2.1-18.2-5.9"]],ra=[u.red,u.blue],vn=class extends B{constructor(t,e,i){super(na[+t],e,i);this.type="penrose";this.setColour(ra[+t]),this.options=t;let n=d("g",{class:"penrose-circles"});this.$path.insertAfter(n);for(let o of oa[+t])d("path",{d:o},n)}static makeThumbnail(t,e,i,n){let o=+t,r=d("svg",{width:80,height:80,viewBox:"-50 -50 100 100"},e),a=n||ra[o];d("polygon",{points:na[o],class:"polygon-tile",fill:a},r);let l=d("g",{class:"penrose-circles"},r);for(let h of oa[o])d("path",{d:h},l)}};var aa=["M13.9-13.9,2.8-25H-2.8L-25-2.8V2.8L-2.8,25H2.8L13.9,13.9C21.6,6.6,21.6-6.6,13.9-13.9Zm-2.8,25L0,22.2-22.2,0,0-22.2,11.1-11.1A15.8,15.8,0,0,1,11.1,11.1Z","M25-2.8,13.9-13.9c-7.3-7.7-20.5-7.7-27.8,0L-25-2.8V2.8l11.1,11.1c7.3,7.7,20.5,7.7,27.8,0L25,2.8ZM11.1,11.1a15.8,15.8,0,0,1-22.2,0L-22.2,0l11.1-11.1a15.8,15.8,0,0,1,22.2,0L22.2,0Z","M-25-2.8V2.8l11.1,11.1c7.3,7.6,20.5,7.6,27.8,0s7.6-20.5,0-27.8L2.8-25H-2.8ZM15.7,0a15.9,15.9,0,0,1-4.6,11.1,15.8,15.8,0,0,1-22.2,0L-22.2,0,0-22.2,11.1-11.1A15.9,15.9,0,0,1,15.7,0Z","M-25-2.8V2.8L-2.8,25H2.8L25,2.8V-2.8L2.8-25H-2.8Zm25,25L-22.2,0,0-22.2,22.2,0Z","M0-19.7a19.5,19.5,0,0,0-13.9,5.8c-7.6,7.3-7.6,20.5,0,27.8s20.5,7.6,27.8,0C26.3,1.6,17.5-19.7,0-19.7ZM11.1,11.1c-5.8,6.1-16.3,6.1-22.2,0a15.8,15.8,0,0,1,0-22.2,15.8,15.8,0,0,1,22.2,0A15.8,15.8,0,0,1,11.1,11.1Z","M0-19.7a19.5,19.5,0,0,0-13.9,5.8L-25-2.8V2.8l11.1,11.1c7.3,7.6,20.5,7.6,27.8,0C26.3,1.6,17.5-19.7,0-19.7ZM11.1,11.1a15.8,15.8,0,0,1-22.2,0L-22.2,0l11.1-11.1c5.9-6.1,16.4-6.1,22.2,0A15.8,15.8,0,0,1,11.1,11.1Z"],bn=class extends B{constructor(t,e,i){super("square",e,i);this.type="kolam";this.setColour(u.orange),this.options=t,d("path",{d:aa[+t],fill:"white"},this.$el),d("circle",{r:3,fill:"white"},this.$el),this.$el.append(this.$outline),this.$path.css("stroke-width",".5px")}static makeThumbnail(t,e){let i=d("svg",{width:60,height:60},e);d("rect",{class:"polygon-tile",fill:u.orange,x:5,y:5,width:50,height:50},i),d("path",{d:aa[+t],fill:"white",transform:"translate(30 30)"},i),d("circle",{r:3,cx:30,cy:30,fill:"white"},i)}};var Be=["M-32.3,6.5,0,84.3H0L32.3,6.5A80.4,80.4,0,0,0,0,0,86.6,86.6,0,0,0-32.3,6.5Z","M-32.3,6.5,0,84.3H0L32.3,6.5A80.4,80.4,0,0,0,0,0,86.6,86.6,0,0,0-32.3,6.5Z","M-42.1,0A288.5,288.5,0,0,0-20.2,110.2a287.6,287.6,0,0,0,62.3,93.3V0Z","M-42.1,0V203.5a289.5,289.5,0,0,0,62.4-93.3A286.5,286.5,0,0,0,42.1,0Z","M0 0L-101.7 101.7L101.7 101.7Z","M0 0L-101.7 101.7L101.7 101.7Z","M0 0L-59.6 59.6L59.6 59.6Z","M42.1.1H-42.2l-59.5,59.6A143.4,143.4,0,0,0,0,101.8,143,143,0,0,0,101.7,59.7Z","M42.1.1H-42.2l-59.5,59.6A143.4,143.4,0,0,0,0,101.8,143,143,0,0,0,101.7,59.7Z"],la=[[66,-17.5,-22.5],[82,-17.5,22.5],[23,-36.5,45],[125,-36.5,-45],[56,47.3,135],[92,47.3,-135],[74,101,180],[41,98,45],[107,98,-45]],Md={0:1,1:1,2:3,3:2,7:8,8:7},ca=[u.lime,u.teal,u.blue,u.red,u.yellow,u.green,u.grey,u.orange,u.purple],wn=class extends B{constructor(t,e,i){super(bt(ve(Be[+t])),e,i);this.type="egg";this.snapAngles=[0,45,90,135];this.options=t,this.$path.setAttr("d",Be[+t]),this.$outline.setAttr("d",Be[+t]),this.setColour(ca[+t]),this.rot=la[+t][2],this.transform(),+t<=1&&this.snapAngles.push(22.5,67.5,112.5,157.5)}flip(t){super.flip(t);let e=this.flipped?Md[this.options]||this.options:this.options;this.$path.setAttr("d",Be[+e]),this.$outline.setAttr("d",Be[+e])}static makeThumbnail(t,e){e.setAttr("d",Be[+t]);let i=la[+t];e.css("transform",`translate(${i[0]}px, ${i[1]}px) rotate(${i[2]}deg) scale(0.5)`),e.setAttr("fill",ca[+t]),e.css("stroke-width","2px")}};var xn=1/Math.sqrt(3),Pd=50/xn,ha=[u.blue,u.purple,u.red,u.orange,u.yellow],He=C.regular(6,Pd).rotate(Math.PI/6).points;He.splice(3,1);He.splice(2,0,new c(2*He[1].x,He[0].y));var $n=class extends B{constructor(t,e,i){super(bt(He.map(n=>n.scale(xn**+t))),e,i);this.type="fractal";this.setColour(ha[+t]),this.options=t}static makeThumbnail(t,e){let i=new C(...He).scale(.6*xn**+t),n=$.aroundPoints(i.points),o=d("svg",{width:20+n.w,height:20+n.h},e);i=i.shift(10-n.center.x+n.w/2,10-n.center.y+n.h/2),d("path",{class:"polygon-tile",path:i,fill:ha[+t]},o)}};var $e=50,hs=class extends S{constructor(t,e,i){super(e,i);this.canRotate=!1;this.canDragToSelect=!1;this.$el.addClass("utensil"),this.width=+t,this.absoluteEnd=new c(this.width,0),this.setup(),this.$handles=[0,1].map(n=>this.makeHandle("c",(o,r)=>{var h;let a=n?this.posn:this.absoluteEnd,l=(h=this.$parent.snap([r]))==null?void 0:h.shift;r=l?r.add(l):r.snap(a,10),c.distance(r,a)<75&&(r=new _(a,75).project(r)),n?this.absoluteEnd=r:this.posn=r,this.rot=this.absoluteEnd.angle(this.posn)*kt,this.width=this.absoluteEnd.subtract(this.posn).length,this.update(),this.transform()})),this.update()}moveEnd(){this.absoluteEnd=new c(this.width,0).rotate(this.rot/kt).add(this.posn)}update(){this.options=""+this.width,this.$handles[1].setCenter({x:this.width,y:0})}},kd=["ruler","protractor"];function da(s){return kd.includes(s.type)}var Tn=class extends hs{constructor(){super(...arguments);this.type="ruler"}setup(){this.$glass=d("rect",{x:-20,height:60,class:"glass",rx:5},this.$el),this.$ticks=d("path",{class:"ticks"},this.$el),this.$labels=N(t=>d("text",{text:t,x:$e*t,y:31},this.$el),21)}update(){this.path=new H(T,new c(this.width,0));let t=this.path.length+.1;this.$glass.setAttr("width",t+40);let e="";for(let i=0;i<=t;i+=$e/10){let n=i%$e?i%($e/2)?0:1:2;e+=`M${i} 0L${i} ${[10,15,20][n]}`}this.$ticks.setAttr("d",e);for(let[i,n]of this.$labels.entries())n.toggle(i<=t/$e);super.update()}getSnapPoints(){let t=this.path.length;return N(e=>this.path.at(e*$e/t),t/$e)}getSnapLines(){return[this.path]}};function Cd(s){return`M0-${s}A${s},${s},0,0,0-${s},0V3a5,5,0,0,0,5,5H${s-5}a5,5,0,0,0,5-5V0A${s},${s},0,0,0,0-${s}Z`}var Sn=class extends hs{constructor(){super(...arguments);this.type="protractor"}setup(){this.$glass=d("path",{d:"",class:"glass"},this.$el),this.$ticks=d("path",{class:"ticks"},this.$el),this.$labels=N(t=>d("text",{text:t*10,transform:`rotate(${90-10*t})`},this.$el),19)}update(){let t=this.width;this.path=new jt(T,new c(-this.width,0),Math.PI),this.$glass.setAttr("d",Cd(t));let e="",i=this.width<100?5:1;for(let n=0;n<=180;n+=i){let o=!(n%10),r=c.fromPolar(-n*nt),a=t-(o?30:20);e+=`M${r.x*t} ${r.y*t}L${r.x*a} ${r.y*a}`,o&&(e+=`M${r.x*8} ${r.y*8}L${r.x*(t-50)} ${r.y*(t-50)}`)}this.$ticks.setAttr("d",e);for(let[n,o]of this.$labels.entries()){let r=t>160||!(n%3);o.toggle(r),r&&o.setAttr("y",44-t)}super.update()}getSnapPoints(){return[T,this.path.start,this.path.at(.5),this.path.end]}getSnapLines(){return[]}},Mn=class extends hs{constructor(){super(...arguments);this.type="compass"}setup(){}update(){}getSnapPoints(){return[]}getSnapLines(){return[]}};var ds=["M-25,34.4a81.3,81.3,0,0,1,50,0h0A81.1,81.1,0,0,0,40.4-13.1h.1A81.5,81.5,0,0,1,0-42.5H0A81.5,81.5,0,0,1-40.5-13.2h.1A81.1,81.1,0,0,0-25,34.4Z","M-15.4-21.3A80.5,80.5,0,0,1,0-68.8,80.5,80.5,0,0,1,15.4-21.3a80.6,80.6,0,0,1,50,0A80.3,80.3,0,0,1,25,8.1,80.4,80.4,0,0,1,40.4,55.7,80.2,80.2,0,0,1,0,26.3,80.2,80.2,0,0,1-40.4,55.7,80.4,80.4,0,0,1-25,8.1,80.3,80.3,0,0,1-65.4-21.3,80.6,80.6,0,0,1-15.4-21.3Z","M65.4-21.3A80.5,80.5,0,0,1,0,12.1,80.5,80.5,0,0,1-65.4-21.3a80.6,80.6,0,0,1,50,0A80.5,80.5,0,0,1,0-68.8,80.5,80.5,0,0,1,15.4-21.3,80.6,80.6,0,0,1,65.4-21.3Z","M80.9-47.5h0A81.5,81.5,0,0,1,40.4-76.9,80.4,80.4,0,0,0,0-47.5,80.2,80.2,0,0,0-40.5-76.9h0A80.8,80.8,0,0,1-80.9-47.6h0A80.3,80.3,0,0,1-65.5,0,80.3,80.3,0,0,1-80.9,47.5h0A80.8,80.8,0,0,1-40.5,76.9h0A80.2,80.2,0,0,0,0,47.5,80.4,80.4,0,0,0,40.4,76.9,81.5,81.5,0,0,1,80.9,47.6h0A80.3,80.3,0,0,1,65.5,0,80.3,80.3,0,0,1,80.9-47.5Z","M0-47.5A80.3,80.3,0,0,1,15.5,0,80.3,80.3,0,0,1,0,47.5,80.3,80.3,0,0,1-15.5,0,80.3,80.3,0,0,1,0-47.5Z","M130.9,153.8a80.5,80.5,0,0,1,15.4-47.5,80.2,80.2,0,0,1-40.4-29.4A80.1,80.1,0,0,1,90.5,29.4a80.6,80.6,0,0,1-50,0A80.6,80.6,0,0,1,0,0,80.3,80.3,0,0,1-40.4,29.4a80.9,80.9,0,0,1-50.1,0,80.8,80.8,0,0,1-15.4,47.5,80.9,80.9,0,0,1-40.5,29.4,79.9,79.9,0,0,1,15.5,47.5,81.3,81.3,0,0,1,50,0A80.9,80.9,0,0,1,0,72.9a80.9,80.9,0,0,1,80.9,80.9A81.3,81.3,0,0,1,130.9,153.8Z","M40.4-13.2A80.4,80.4,0,0,0,0-42.5,80.7,80.7,0,0,0-40.4-13.1,80.9,80.9,0,0,0-25,34.4a80.6,80.6,0,0,0,50,0A81.2,81.2,0,0,0,40.4-13.2Z","M40.4-13.1A82,82,0,0,1,0-42.5,81.1,81.1,0,0,1-40.5-13.2,81.3,81.3,0,0,1-25,34.4a81.3,81.3,0,0,1,50,0A81.6,81.6,0,0,1,40.4-13.1Z"],pa=["M16.2-.3a5.5,5.5,0,0,1-4.4,6.4A5.3,5.3,0,0,1,5.5,1.8,5.4,5.4,0,0,1,9.8-4.6,5.5,5.5,0,0,1,16.2-.3Zm8-8A3.8,3.8,0,0,0,28-4.5a3.7,3.7,0,0,0,3.7-3.8A3.6,3.6,0,0,0,28-12,3.7,3.7,0,0,0,24.2-8.3ZM19,23.4a4.9,4.9,0,0,0,4.8-4.8A4.8,4.8,0,0,0,19,13.9a4.7,4.7,0,0,0-4.7,4.7A4.8,4.8,0,0,0,19,23.4ZM-11.7,6.1A5.3,5.3,0,0,0-5.4,1.8,5.4,5.4,0,0,0-9.7-4.6,5.5,5.5,0,0,0-16.1-.3,5.5,5.5,0,0,0-11.7,6.1ZM-27.9-4.5a3.8,3.8,0,0,0,3.8-3.8A3.7,3.7,0,0,0-27.9-12a3.6,3.6,0,0,0-3.7,3.7A3.7,3.7,0,0,0-27.9-4.5ZM20.9-22A139.9,139.9,0,0,1,3-19.5a1.1,1.1,0,0,1-.1.5L1-15.2V30H-1V-15.2L-2.9-19a1.1,1.1,0,0,1-.1-.5,127,127,0,0,1-17.8-2.6A80.8,80.8,0,0,0,0-41.7,83.3,83.3,0,0,0,20.9-22ZM-3.8-26.7A3.2,3.2,0,0,0-7-30a3.3,3.3,0,0,0-3.3,3.3A3.2,3.2,0,0,0-7-23.5,3.2,3.2,0,0,0-3.8-26.7ZM6.5-30a3.2,3.2,0,0,0-3.2,3.3,3.2,3.2,0,0,0,3.2,3.2,3.2,3.2,0,0,0,3.3-3.2A3.3,3.3,0,0,0,6.5-30ZM-23.7,18.6a4.9,4.9,0,0,0,4.8,4.8,4.8,4.8,0,0,0,4.7-4.8,4.7,4.7,0,0,0-4.7-4.7A4.8,4.8,0,0,0-23.7,18.6Z","M-16.9-4.7l-17.7-6.1a.8.8,0,0,1-.5-.9.8.8,0,0,1,.9-.5L-16.5-6a.7.7,0,0,1,.5.9.7.7,0,0,1-.7.4ZM-24.6-13l9.7,5.4h.3a.9.9,0,0,0,.7-.3.9.9,0,0,0-.3-1l-9.7-5.4a.8.8,0,0,0-1,.2A.8.8,0,0,0-24.6-13ZM-7.8-4.9l5.9,1.2h.5c.2-.1.3-.2.3-.4l.3-1.4a.6.6,0,0,0-.5-.8L-7.2-7.7h-.6l-.3.4-.3,1.4A.8.8,0,0,0-7.8-4.9ZM2.8-2.5a.9.9,0,0,0,.7.6h.2l1.6-.3a1,1,0,0,0,.5-.4.7.7,0,0,0,.1-.5l-1.4-6a.8.8,0,0,0-.9-.6L2-9.4l-.5.3a1.3,1.3,0,0,0-.1.6ZM10.9.4a.7.7,0,0,0-.1-.5L10-1.3a.8.8,0,0,0-1-.2L4,1.9c-.2.1-.3.2-.3.4a.7.7,0,0,0,.1.5L4.6,4a.6.6,0,0,0,.6.3h.4l5-3.4ZM-4.5-1l-1.4-.3a.4.4,0,0,0-.5.1c-.2.1-.3.2-.3.4L-8.2,5.1a.7.7,0,0,0,.5.8l1.4.4h.5a.5.5,0,0,0,.3-.5L-4-.1A.7.7,0,0,0-4.5-1Zm-12.1-.6a.7.7,0,0,0,.7-.6c.1-.4-.2-.7-.6-.8l-11-1.7a.8.8,0,0,0-.8.6c0,.4.2.8.6.8l11,1.7Zm16.1,6H-1c-.2,0-.3.1-.5.3l-.8,1.1a.8.8,0,0,0,.1,1l4.9,3.6.4.2h.1l.4-.3.9-1.1c.2-.4.2-.8-.1-1Zm-9.4,8.8a.7.7,0,0,0-1,.1L-22.2,28.2a.7.7,0,0,0,.1,1l.4.2a.9.9,0,0,0,.6-.3l11.3-15A.6.6,0,0,0-9.9,13.2Zm-11.2,5.6c.2.2.3.3.5.3l.5-.2,8.2-7.6a.7.7,0,0,0,0-1,.8.8,0,0,0-1,0L-21,17.8A.7.7,0,0,0-21.1,18.8Zm14-4.9a.8.8,0,0,0-1,.4L-13,24.2a.6.6,0,0,0,.3.9h.3a.6.6,0,0,0,.6-.4l5-9.9A.8.8,0,0,0-7.1,13.9Zm17.4-.7a.8.8,0,0,0-1-.2.8.8,0,0,0-.2,1L19.9,29.4a.5.5,0,0,0,.5.3h.4a.7.7,0,0,0,.2-1ZM7,14.4A.7.7,0,0,0,6,14a.7.7,0,0,0-.3.9L10.3,25a.8.8,0,0,0,.7.4h.3a.8.8,0,0,0,.3-1Zm4-2.8,7.8,7.8.5.2.5-.2a.7.7,0,0,0,0-1L12,10.6a.7.7,0,0,0-1,1ZM34.4-11.2a.7.7,0,0,0-.8-.5l-18,5.5a.7.7,0,0,0-.4.9.6.6,0,0,0,.6.5c.1,0,.2,0,.2-.1l18-5.4A.7.7,0,0,0,34.4-11.2ZM26.7-4l-11,1.3a.6.6,0,0,0-.6.8.7.7,0,0,0,.7.6h.1l11-1.3c.4,0,.6-.4.6-.8S27.1-4,26.7-4ZM14-7.3h.3l9.8-5.1a.7.7,0,0,0,.3-1,.7.7,0,0,0-.9-.3L13.6-8.6a.8.8,0,0,0-.3,1A.8.8,0,0,0,14-7.3ZM-.5-16.6h0a.7.7,0,0,0,.7-.6L.6-36a.7.7,0,0,0-.7-.7.7.7,0,0,0-.7.7l-.4,18.7A.7.7,0,0,0-.5-16.6Zm3.2,1.2h.2a.7.7,0,0,0,.7-.6L5.7-26.9a.7.7,0,0,0-.5-.8.8.8,0,0,0-.9.6L2.2-16.3A.7.7,0,0,0,2.7-15.4Zm-6.1-.1h.1c.4-.1.7-.5.6-.8l-1.8-11c0-.4-.4-.6-.8-.6a.8.8,0,0,0-.6.8l1.8,11A.9.9,0,0,0-3.4-15.5Z","M60.8-16.2l-3.6-2.5,1.4-3.9-.9-.3-1.3,3.5h0l-9.5,3,2.8-7.8h-1l-3,8.3-9.5,3.1,4.4-11.8H39.5L35-12.5,25.5-9.4l5-14.7H29.4L24.3-9.1l-9.1,3,6-16.3-1.2.3L14-5.7l-1.8.5a50.6,50.6,0,0,0,5.3-16.2l-1.9.6-.4.2L1-9.8v-10L14.4-30.3c0-.4-.1-.8-.1-1.2L1-21.1v-10l11.7-9.1-.3-1.1L1-32.4v-10l8.9-6.9a3,3,0,0,0-.4-1L1-43.7v-10l5.2-4a4.1,4.1,0,0,0-.5-.9l-5.2,4h-1l-5.2-4a4.1,4.1,0,0,0-.5.9l5.2,4v10l-8.5-6.6a3,3,0,0,0-.4,1L-1-42.4v10l-11.4-8.9-.3,1.1L-1-31.1v10L-14.3-31.5c0,.4-.1.8-.1,1.2L-1-19.8v10L-15.2-20.6l-.4-.2-1.9-.6A50.6,50.6,0,0,0-12.2-5.2L-14-5.7l-6-16.4-1.2-.3,6,16.3-9.1-3L-29.4-24h-1.1l5,14.7L-35-12.5l-4.5-12.2h-1.1l4.4,11.8L-45.7-16l-3-8.3h-1l2.8,7.8-9.5-3h0l-1.3-3.5-.9.3,1.4,3.9-3.6,2.5.7.7,3.1-2.2v.2l9.4,3-6.8,4.8.7.7,7.3-5.1,9.6,3.1L-47.3-3.8l.9.6,10.8-7.4,9.5,3.1-13,8.9,1,.5,13.2-9,9.6,3-14.4,10,1.2.4,14.3-9.9h.4l3,1C-9.8-1-8.9.5-7.9,1.9L-18.4,9.4l1.3.3,9.8-7a64.2,64.2,0,0,0,6.6,8H.7a64.2,64.2,0,0,0,6.6-8l9.8,7,1.3-.3L7.9,1.9C8.9.5,9.8-1,10.8-2.6l3-1h.4L28.5,6.3l1.2-.4L15.3-4.1l9.6-3,13.2,9,1-.5-13-8.9,9.5-3.1L46.4-3.2l.9-.6L36.8-11l9.6-3.1L53.7-9l.7-.7-6.8-4.8,9.4-3v-.2l3.1,2.2Zm-76-3.2L-1-8.5V.6l-9.7-7.4A45.9,45.9,0,0,1-15.2-19.4ZM0,8.5A66.6,66.6,0,0,1-9.6-4.7L-1,1.8V6.3a1,1,0,0,0,1,1,1,1,0,0,0,1-1V1.8L9.6-4.7A71,71,0,0,1,0,8.5ZM10.7-6.8,1,.6V-8.5L15.2-19.4A45.9,45.9,0,0,1,10.7-6.8Z","M65-1V1.1A81.6,81.6,0,0,1,40,5c-8.9,0-12.7-.4-20.6-2.9A1,1,0,0,1,18.8.8.9.9,0,0,1,20,.2C27.7,2.7,31.2,3,40,3A79.7,79.7,0,0,0,64.7-.9ZM-64.6,1.1A82.4,82.4,0,0,0-39.4,5c8.8,0,12.6-.4,20.5-2.9A1.2,1.2,0,0,0-18.2.8,1,1,0,0,0-19.5.2C-27.2,2.7-30.7,3-39.4,3A79.9,79.9,0,0,1-64.2-.9H-65V1ZM-45.8,36a6.7,6.7,0,0,1,6.7-6.7A6.7,6.7,0,0,1-32.4,36a6.7,6.7,0,0,1-6.7,6.7A6.7,6.7,0,0,1-45.8,36Zm2,0a4.7,4.7,0,0,0,4.7,4.7A4.7,4.7,0,0,0-34.4,36a4.7,4.7,0,0,0-4.7-4.7A4.7,4.7,0,0,0-43.8,36Zm10.4-71.4a5.7,5.7,0,0,0-5.7-5.7,5.6,5.6,0,0,0-5.7,5.7,5.7,5.7,0,0,0,5.7,5.7A5.8,5.8,0,0,0-33.4-35.4ZM4.9-37.1a2.2,2.2,0,0,0,2.2,2.2,2.2,2.2,0,0,0,2.2-2.2,2.2,2.2,0,0,0-2.2-2.2A2.2,2.2,0,0,0,4.9-37.1ZM38.7,42.7h0A6.8,6.8,0,0,1,32,36a6.7,6.7,0,1,1,6.7,6.7ZM43.4,36a4.7,4.7,0,1,0-4.7,4.7h0A4.7,4.7,0,0,0,43.4,36ZM0,42.9c4.1.7,8.7-9.6,11.4-17.9A78.6,78.6,0,0,0,15.3.3c0-6.7-1.3-13.7-3.2-21.6-.6-1.6-3.4-4.2-5.8-5.1,2.2-2,1.8-2.9,2.3-3.7s.1-3.3,0-3.8c-4.5,1.1-6.3-2.7-4.3-5.5C9-44,19.3-53.3,29-55.2a6.4,6.4,0,0,0,1,1.3,3.1,3.1,0,0,0,1.8.5,2.9,2.9,0,0,0,2.4-1.2h0a3,3,0,0,0-.6-4.2,2.9,2.9,0,0,0-4.2.7,2.6,2.6,0,0,0-.5.9C19-55.4,8.7-46.5,3.6-41.5A33.5,33.5,0,0,1-.2-42.6l-3.7,1.2c-5-4.9-15.3-13.9-25.4-15.8a2.7,2.7,0,0,0-.5-1.1,3,3,0,0,0-4.2-.6,3,3,0,0,0-.6,4.2h0a3,3,0,0,0,2.4,1.2,3.2,3.2,0,0,0,1.8-.6,3.1,3.1,0,0,0,.9-1.1c10.1,2,20.8,11.8,25.2,16.3,1.3,2.5-.4,5.8-4.2,5-.1.6-.5,3,0,4s.6,1.5,2.3,3.5c-2.4.7-6,4-6.3,5.3-1.6,7-3,15.5-3,21.4a78.8,78.8,0,0,0,4,24.7C-8.8,33.3-3.5,43.8,0,42.9Zm-5.2-80a2.2,2.2,0,0,0-2.2-2.2,2.2,2.2,0,0,0-2.2,2.2,2.2,2.2,0,0,0,2.2,2.2A2.2,2.2,0,0,0-5.2-37.1ZM33-35.4a5.8,5.8,0,0,0,5.7,5.7,5.7,5.7,0,0,0,5.7-5.7,5.6,5.6,0,0,0-5.7-5.7A5.7,5.7,0,0,0,33-35.4Z","M.9,33.4v-9l12.7-9.9.3-1.4L.9,23.2v-10l14-10.9V1L.9,12V2L14.5-8.6c0-.3-.1-.7-.1-1.1L.9.8v-10l11.9-9.3a3.6,3.6,0,0,1-.2-1L.9-10.4v-10l9.2-7.1a4.2,4.2,0,0,0-.4-1L.9-21.6v-9.9h0l5.6-4.3L6-36.8.4-32.4H-.4L-6-36.8l-.5.9L-1-31.6a.1.1,0,0,0-.1.1v9.8l-8.6-6.8a4.2,4.2,0,0,0-.4,1l9,7v10l-11.5-9a3.6,3.6,0,0,1-.2,1L-1.1-9.3V.7L-14.4-9.7c0,.4-.1.8-.1,1.1L-1.1,1.9v10L-14.9,1V2.3L-1.1,13.1v10l-12.8-10,.3,1.4,12.5,9.8v9l-9.6-7.5.6,1.8,9,7v4.1a1,1,0,0,0,1,1,.9.9,0,0,0,1-1v-4l9.2-7.1.6-1.7Z","M0,.8A76.2,76.2,0,0,0,7.8,9.9c-1.6,1.9-5.4,7.6-6.6,21.6h-2C-2,17.1-6,11.4-7.6,9.7A72.7,72.7,0,0,0,0,.8ZM124.3,117.2c-6.5,4.7-6.3,16,.5,25.4a30,30,0,0,0,5.8,6,81.7,81.7,0,0,1,8.3-31.1C133.6,114.7,128.1,114.4,124.3,117.2ZM-82.6,86.3A82.8,82.8,0,0,0-104,75l-1.2,1.7A81,81,0,0,1-83.8,87.9a79.9,79.9,0,0,1,17.6,17.7l.3.5,1.3-1.7A81.3,81.3,0,0,0-82.6,86.3Zm47.3-33.1a80,80,0,0,1-3.9-23.7l-1.1.4-.9.2a83.5,83.5,0,0,0,4,23.7A79.9,79.9,0,0,0-25.8,76.6l2-.6-.3-.4A78.4,78.4,0,0,1-35.3,53.2Zm-81,62.7.6-1.9c-11.9-5.1-16.5-10-18.1-12.4a81.4,81.4,0,0,1-11.8,4.9,85.1,85.1,0,0,1,5.8,9.4C-138.6,115.3-132.2,112.1-116.3,115.9ZM-90,30.1a81.7,81.7,0,0,1-.8,11.1c2,.4,8.7,2.3,18.5,13.8l1.7-1.2c-6.9-11.4-7.6-18.1-7.4-20.9A99.4,99.4,0,0,1-90,30.1ZM38,53.8a85.2,85.2,0,0,0,4.1-23.4l-1.8-.5h-.2a81.5,81.5,0,0,1-4,23.4A81.4,81.4,0,0,1,24.6,75.5l-.4.6,2,.7h0A83,83,0,0,0,38,53.8Zm68.4,24.7-.9-1.3-.3-.4a82,82,0,0,1-17.3,17,82,82,0,0,1-22.5,11.3h-.2l1.2,1.7A85.2,85.2,0,0,0,89.1,95.4,81.6,81.6,0,0,0,106.4,78.5ZM70.8,54.6l1.6,1.2c9.9-11.4,16.5-13.4,18.5-13.7a80.8,80.8,0,0,1-.9-12,97.8,97.8,0,0,1-11.9,2.8C78.4,35.1,78.4,42.1,70.8,54.6ZM126.3,152a28,28,0,0,0-3.9-7.7,26.3,26.3,0,0,0-11.9-9.5c-4.6-1.6-8.8-1.3-12,1s-5.5,8.3-4.3,14.4A82.6,82.6,0,0,1,126.3,152Z","M0,4L5,6.6L4,1.1L8.1,-2.9L2.5,-3.7L0,-8.8L-2.5,-3.7L-8.1,-2.9L-4,1.1L-5,6.6Z","M0,4L5,6.6L4,1.1L8.1,-2.9L2.5,-3.7L0,-8.8L-2.5,-3.7L-8.1,-2.9L-4,1.1L-5,6.6Z"],ua=[u.red,u.blue,u.green,u.yellow,u.green,u.teal,u.orange,u.purple],Ad=["-30 -35 60 60","-35 -42 70 70","-35 -60 70 70","-45 -45 90 90","-15 -30 30 60","-75 28 150 100","-30 -35 60 60","-30 -35 60 60"],fa=[.7,.6,.3,.6,.3,.6,.7,.7],Pn=class extends B{constructor(t,e,i){super(bt(ve(ds[+t])),e,i);this.type="garden";this.options=t;let n=+t;this.$path.setAttr("d",ds[n]),this.$outline.setAttr("d",ds[n]);let o=d("path",{d:pa[n],fill:"black",opacity:fa[n]});this.$path.insertAfter(o),this.symmetric=!0,this.setColour(ua[n])}static makeThumbnail(t,e){let i=+t,o=d("svg",{width:i===4?40:i===5?120:80,height:80,viewBox:Ad[i]},e),r=d("g",{transform:"scale(0.5)"},o);d("path",{d:ds[i],fill:ua[i],class:"polygon-tile"},r),d("path",{d:pa[i],fill:"black",opacity:fa[i]},r)}};var Vd=["M34,0a16,16,0,0,1,6.3-12.7l-9-15.7A34.1,34.1,0,0,0,16,0,34.1,34.1,0,0,0,31.3,28.4l9-15.7A16,16,0,0,1,34,0Z","M-25,9.3a33.7,33.7,0,0,0-15.2,3.6l9,15.7A14.4,14.4,0,0,1-25,27.3a16.1,16.1,0,0,1,15.9,14h18A34,34,0,0,0-25,9.3Z","M-25-9.3a33.7,33.7,0,0,1-15.2-3.6l9-15.7A14.4,14.4,0,0,0-25-27.3a16.1,16.1,0,0,0,15.9-14h18A34,34,0,0,1-25-9.3Z","M-8.9,41.3h18A16.1,16.1,0,0,1,25,27.3a14.4,14.4,0,0,1,6.2,1.3l9-15.7A33.9,33.9,0,0,0-8.9,41.3Z","M-31.3-28.4l-9,15.6A65.9,65.9,0,0,1-9.1,41.3h18A83.7,83.7,0,0,0-31.3-28.4Z","M-8.9,41.3h18A65.9,65.9,0,0,1,40.3-12.8l-9-15.6A83.7,83.7,0,0,0-8.9,41.3Z","M-40.3 12.9L-31.3 28.4L40.3 -12.9L31.3 -28.4Z","M-40.2,12.9l9,15.6A65.7,65.7,0,0,1,0,20.6a65.7,65.7,0,0,1,31.2,7.9l9-15.6A82.6,82.6,0,0,0,0,2.6,82.6,82.6,0,0,0-40.2,12.9Z","M31.3,28.4l9-15.6A65.9,65.9,0,0,1,9.1-41.3h-18A83.7,83.7,0,0,0,31.3,28.4Z"],Ed=[[6,3,2],[6,4,8],[7,2,5],[7,5,2],[2,6,3],[8,6,4],[5,7,2],[2,7,5],[3,2,6],[4,8,6],[2,5,7],[5,2,7],[0,1,2],[0,2,1]],fi="#242436",Ld=[u.red,u.green,u.yellow];function ma(s,t){let e=Ed[s].map((i,n)=>[i,n]).sort((i,n)=>n[0]-i[0]);for(let[i,n]of e)d("path",{d:Vd[i],class:"tantrix","stroke-width":2.8,stroke:fi,fill:Ld[n]},t)}var kn=class extends B{constructor(t,e,i){super("reg-hexagon",e,i);this.type="tantrix";this.options=t,this.setColour(fi),ma(+t,this.$el)}setColour(t){super.setColour(t||fi);for(let e of this.$el.$$(".tantrix"))e.setAttr("stroke",t||fi)}static makeThumbnail(t,e){let i=d("svg",{width:60,height:60,viewBox:"-54 -54 108 108"},e);d("path",{class:"polygon-tile",path:ls("reg-hexagon"),fill:fi},i),ma(+t,i)}};var ht=25,ga={100:u.yellow,10:u.blue};function Od(s,t,e,i){let n=i.shift(s*e,0),o=n.shift(0,Math.floor(t/s)*e),r=i.shift(0,Math.ceil(t/s)*e),a=r.shift(t%s*e,0),l=a.shift(0,t%s?-e:0);return new C(i,n,o,l,a,r)}function ya(s,t,e){return d("rect",{class:"number-tile",width:s,height:s,fill:e},t)}function va(s,t,e,i,n,o){s.setAttr("x",n+t%e*i),s.setAttr("y",o+Math.floor(t/e)*i)}var ps=class extends S{constructor(t,e,i){super(e,i);this.type="number-tile";this.options=t;let[n,o]=t.split(":").map(r=>+r);this.count=o,this.colour=ga[o]||u.red,this.$tiles=N(()=>ya(ht,this.$el,this.colour),o),this.$outline=d("path",{class:"outline"},this.$el),o>1&&(this.$handle=this.makeHandle("h",r=>this.setWidth(Math.round(r.x/ht)))),this.setWidth(n,!0)}setWidth(t,e=!1){var i;if(t=E(t,1,this.count),t!==this.width){this.value=this.count,this.width=t,this.options=`${t}:${this.count}`;for(let n=0;n<this.count;++n)va(this.$tiles[n],n,t,ht,-ht/2,-ht/2);this.path=Od(t,this.count,ht,new c(-ht/2,-ht/2)),this.$outline.draw(this.path),(i=this.$handle)==null||i.setTransform(new c((t-.5)*ht,-ht/2)),this.transform(),e||this.$parent.selection.update()}}setColour(t){this.colour=t;for(let e of this.$tiles)e.setAttr("fill",O(t))}static makeThumbnail(t,e){let[i,n]=t.split(":").map(h=>+h);i=Math.min(i,n);let o=d("svg",{width:n===1?40:80,height:80},e),r=(n===1?20:40)-i/2*7,a=40-Math.ceil(n/i)/2*7,l=ga[n]||u.red;for(let h=0;h<n;++h)va(ya(7,o,l),h,i,7,r,a)}getSnapPoints(){let t=new c(-ht/2,-ht/2),e=[t];for(let n=1;n<=this.width;++n)e.push(t.shift(n*ht,0));let i=Math.ceil(this.count/this.width);for(let n=1;n<=i;++n)e.push(t.shift(0,n*ht));for(let n=0;n<this.count;++n)e.push(t.shift((n%this.width+1)*ht,Math.floor(n/this.width+1)*ht));return e}split(){if(this.count===1)return[];let t=N(e=>{let i=e%this.width*ht,n=Math.floor(e/this.width)*ht,o=this.posn.shift(i,n).rotate(this.rot*nt,this.posn);return ba(1,1,this.$parent,o,this.rot,this.colour)},this.count);return this.$parent.selection.select(t),this.delete(),t}static action(t,e){if(t==="split"){let i=[];for(let n of e)i.push(...n.split());e[0].$parent.change({tilesAdded:i,tilesDeleted:e})}else if(t==="merge"){let i=Array.from(e),n=q(i.map(g=>g.count)),o=L(Bi(i,g=>g.count)),r=o.$parent,a=Math.min(...i.map(g=>g.posn.x)),l=Math.min(...i.map(g=>g.posn.y)),h=Math.max(...i.map(g=>Math.ceil((g.posn.x-a)/ht)+g.width)),p=ba(n,h,r,new c(a,l),o.rot,o.colour);for(let g of e)g.delete();r.selection.add(p),e[0].$parent.change({tilesAdded:[p],tilesDeleted:e})}}};function ba(s,t,e,i,n,o){let r=new ps(`${t}:${s}`,e);return r.setColour(o),r.setTransform(i,n),r}var wa=[u.yellow,"#f15e19","#e1343b",u.red,"#8d2ca1","#4e53d0",u.blue,u.teal,u.green,u.lime],xa=["#e6e2c6","#cc1030",u.green,u.red,"#ffd615",u.teal,"#181824","#9a2e13",u.blue,u.yellow],$a=25,Cn=class extends B{constructor(t,e,i){super(as(+t*$a,$a),e,i);this.type="number-bar";this.options=t,this.value=+t,this.$text=d("text",{text:t,class:"polygon-label",y:6},this.$el),this.setColour((e.options.altColors?xa:wa)[+t-1])}customTransform(){this.$text.css("transform",`rotate(${-this.rot}deg)`)}static makeThumbnail(t,e,i){let n=+t,o=new $(new c(1,1),n*20,20),r=d("svg",{width:n*20+2,height:22},e),a=d("path",{class:"polygon-tile",path:o},r);d("text",{html:t,class:"polygon-label",x:n*10+1,y:16},r),i.options.watch(l=>a.setAttr("fill",(l.altColors?xa:wa)[n-1]))}};var Ta='<h3>Number Line</h3><label class="row"><div class="label">Start:</div><input class="input-field" type="number" :bind="start"></label><label class="row"><div class="label">Step Size:</div><input class="input-field" type="number" :bind="step" min="0"></label><label class="row"><div class="label">Width:</div><input class="input-field" type="number" :bind="size" min="1" max="25"></label><label class="row"><div class="label">Divisions:</div><input class="input-field" type="number" :bind="minor" min="1" max="25"></label>';var mi=25,An=class extends S{constructor(t,e,i){super(e,i);this.type="number-line";this.$el.addClass("number-line"),this.$fill=d("path",{fill:"transparent"},this.$el),this.$lines=d("path",{class:"number-line-ticks"},this.$el),this.$labels=d("g",{},this.$el),this.setColour(u.darkGrey);let[n,o,r,a,l]=t.split(":").map(y=>+y),h={start:n,step:o,width:r,size:a,minor:l},p=e.bindSettingsPanel(this,Ta,h);this.$start=this.makeHandle("h",y=>{let x=Math.round(y.x/mi/p.size);!x||(this.setTransform(this.posn.shift(x*mi*p.size,0),this.rot),p.width-=x,p.start=Nt(p.start+x*p.step,5))}),this.$start.setTransform({x:-mi,y:-2.5},Math.PI),this.$end=this.makeHandle("h",y=>{let x=y.x/mi/p.size;p.width=E(Math.round(x),1,100)});let g=!0;p.watch(()=>{p.start=Nt(p.start,4),p.step=Nt(p.step,4),p.size=Math.round(p.size),p.minor=Math.round(p.minor),this.setDimensions(p,g),g=!1})}setDimensions({start:t,step:e,width:i,size:n,minor:o},r=!1){let a=`${t}:${e}:${i}:${n}:${o}`;if(a===this.options)return;this.options=a,this.$labels.removeChildren(),n*=mi;let l=`M0 10L${i*n} 10`;for(let h=0;h<=i*o;h+=1){let p=h*n/o,g=!(h%o),y=Lt(t+h*e/o,4);l+=`M${p} ${g?0:5}L${p} ${g?20:15}`,g&&d("text",{text:y,x:p,y:40},this.$labels)}this.$lines.setAttr("d",l),this.$end.setTransform({x:i*n,y:-2.5}),this.linePoints=N(h=>new c(h*n,10),i+1),this.line=new H(new c(0,10),new c(i*n,10)),this.path=new $(T,i*n,44),this.$fill.draw(this.path),this.transform(),this.$parent.selection.update(),r||this.$parent.change({tilesChanged:[this]})}getSnapPoints(){return this.linePoints}getSnapLines(){return[this.line]}customTransform(){for(let t of this.$labels.children)t.css("transform",`rotate(${-this.rot}deg)`)}setColour(t){super.setColour(t),this.$lines.setAttr("stroke",O(t)),this.$labels.setAttr("fill",O(t))}static makeThumbnail(t,e){let i=d("svg",{width:240,height:40,class:"number-line"},e),n="M20 10L220 10";for(let o=0;o<=10;o+=1){let r=20+o*20;n+=`M${r} 5L${r} 15`,d("text",{text:o,x:r,y:30},i)}d("path",{d:n,class:"number-line-ticks"},i)}};var Sa=2*Math.PI;var Ue=50,Ma={1:u.grey,2:u.yellow,3:u.green,5:u.blue,7:u.purple},Id="M0-xAx,x,0,0,0-x,0,x,x,0,0,0,0,x,x,x,0,0,0,x,0,x,x,0,0,0,0-xZM0,yAz,z,0,0,1-y,0,z,z,0,0,1,0-y,z,z,0,0,1,y,0,z,z,0,0,1,0,yZ";function Pa(s,t,e=1){let i=s.y*t.x-s.x*t.y>0?e:1-e;return[s.x,s.y+"A"+s.length,s.length,0,i,e,t.x,t.y].join(",")}function ka(s,t,e=Ue){if(t===1)return Id.replace(/x/g,""+e).replace(/y/g,""+.4*e).replace(/z/g,""+(.4*e+.1));let i=Sa/t,n=-Math.PI/2-i/2,o=c.fromPolar(n+i*s,e),r=c.fromPolar(n+i*(s+1),e);return`M${Pa(o,r)}L${Pa(r.scale(.4),o.scale(.4),0)}Z`}function Ca(s){return s===1?[1]:Ui(s).reverse()}var Vn=class extends S{constructor(t,e,i){super(e,i);this.type="prime-disk";this.$segments=[];this.factors=[];this.path=new _(T,Ue),d("circle",{class:"prime-background",r:Ue},this.$el),this.$segmentWrap=d("g",{},this.$el),this.$label=d("text",{class:"prime-label",y:5},this.$el),this.$outline=d("path",{class:"outline",path:this.path},this.$el),this.setValue(+t)}setValue(t){t=this.value=E(Math.round(t),1,9999999),this.options=this.$label.text=""+t,this.factors=Ca(t);let e=this.factors.length;for(let i=0;i<e;++i){let n=this.getSegment(i);n.setAttr("fill",Ma[this.factors[i]]||u.red),n.setAttr("d",ka(i,e)),n.show()}for(let i=e;i<this.$segments.length;++i)this.$segments[i].hide()}multiply(t){this.setValue(+this.options*t)}getSegment(t){if(this.$segments[t])return this.$segments[t];let e=d("path",{class:"polygon-tile"},this.$segmentWrap);return this.$parent.events.listen(e,{down:()=>{this.locked||this.$parent.selection.add(this,!this.$parent.events.shiftKey)},start:()=>{!this.isActive||(this.$parent.selection.add(this,!0),e.addClass("prime-move"),this.$parent.$activeTiles.append(e))},move:i=>{!this.isActive||(e.setTransform(this.posn.add(i.posn).subtract(i.startPosn)),this.setCollision(this.findNearby("prime-disk",Ue,i.posn)))},end:i=>{if(!this.isActive)return;e.removeClass("prime-move"),e.setTransform(),this.$segmentWrap.append(e);let n=i.lastPosn.subtract(i.startPosn);if(n.length>Ue){if(this.collision)this.collision.multiply(this.factors[t]),this.$parent.selection.add(this.collision,!0),this.setCollision();else{let o=this.$parent.newTile("prime-disk",""+this.factors[t]);o.setTransform(this.posn.add(n)),this.$parent.selection.add(o,!0)}this.setValue(+this.options/this.factors[t]),this.$parent.change({tilesChanged:[this]})}},checkIfActive:()=>this.factors.length>1}),this.$segments[t]=e,e}setColour(t){if(this.colour=t,t)for(let e of this.$segments)e.setAttr("fill",O(this.colour))}highlight(t=!0){this.$outline.setClass("active",t)}move(t){super.move(t),!(this.$parent.selection.tiles.size>1)&&this.setCollision(this.findNearby("prime-disk",Ue))}collide(t){t.highlight(!1),t.multiply(+this.options),this.$parent.selection.add(t,!0),this.delete()}static makeThumbnail(t,e){let i=d("svg",{width:54,height:54},e),n=d("g",{transform:"translate(27 27)"},i),o=r=>{n.removeChildren();let a=Ca(r);for(let l=0;l<a.length;++l){let h=Ma[a[l]]||u.red,p=ka(l,a.length,25);d("path",{fill:h,d:p,class:"polygon-tile"},n),d("text",{text:r,y:4,fill:"white",style:"font-size: 11px; text-anchor: middle"},n)}};e.onAttr("data-options",r=>o(Math.round(+r)))}};var lt=25,En=class extends S{constructor(t,e,i){super(e,i);this.type="decimal-grid";this.$handles=[];this.$tiles=d("g",{},this.$el),this.$outline=d("path",{class:"outline"},this.$el),this.$handles[0]=this.makeHandle("h",a=>this.setDimensions(a.x/lt,this.height,this.size)),this.$handles[1]=this.makeHandle("v",a=>this.setDimensions(this.width,a.y/lt,this.size)),this.$handles[2]=this.makeHandle("c",a=>this.setDimensions(this.width,this.height,(a.x+a.y)/2/lt)),this.$handles[1].css("cursor","ns-resize"),this.$handles[2].css("cursor","nwse-resize");let[n,o,r]=t.split(":");this.setDimensions(+n,+o,+r)}setDimensions(t,e,i){t=this.width=E(Math.round(t),1,100),e=this.height=E(Math.round(e),1,100),i=this.size=E(Math.round(i),2,Math.max(t,e));let n=[t,e,i].join(":");if(n===this.options)return;this.options=n,this.$tiles.removeChildren();let o=Math.floor(t/i)*i,r=Math.floor(e/i)*i,a=i*lt;for(let l=0;l<o;l+=i)for(let h=0;h<r;h+=i)this.drawRect(l*lt,h*lt,a,a,u.yellow);for(let l=o;l<t;++l)for(let h=0;h<r;h+=i)this.drawRect(l*lt,h*lt,lt,a,u.blue);for(let l=0;l<o;l+=i)for(let h=r;h<e;++h)this.drawRect(l*lt,h*lt,a,lt,u.blue);for(let l=o;l<t;++l)for(let h=r;h<e;++h)this.drawRect(l*lt,h*lt,lt,lt,u.red);this.$handles[0].setTransform({x:t*lt,y:0}),this.$handles[1].setTransform({x:0,y:e*lt}),this.$handles[2].setTransform({x:a,y:a}),this.path=new $(T,t*lt,e*lt),this.$outline.draw(this.path),this.$parent.selection.update(),this.transform()}drawRect(t,e,i,n,o){d("rect",{x:t,y:e,width:i,height:n,fill:this.colour||o,class:"polygon-tile"},this.$tiles)}setColour(t){this.colour=t;for(let e of this.$tiles.children)e.setAttr("fill",O(t))}static makeThumbnail(t,e){let i=d("svg",{width:140,height:80},e),n=(o,r,a,l,h)=>d("rect",{x:5+o,y:5+r,width:a,height:l,fill:h,class:"polygon-tile"},i);for(let o=0;o<2;++o)n(50*o,0,50,50,u.yellow);for(let o=0;o<3;++o)n(100+10*o,0,10,50,u.blue);for(let o=0;o<2;++o)for(let r=0;r<2;++r)n(50*o,50+r*10,50,10,u.blue);for(let o=0;o<3;++o)for(let r=0;r<2;++r)n(100+o*10,50+r*10,10,10,u.red)}};var Aa='<h3>Dot Machine</h3><label class="row"><div class="label">Base:</div><input class="input-field" type="number" :bind="base" min="2" max="25"></label><label class="row"><div class="label">Boxes:</div><input class="input-field" type="number" :bind="boxes" min="1" max="10"></label>';var Ln=class extends S{constructor(t,e,i){super(e,i);this.type="dot-machine";this.canRotate=!1;this.canDragToSelect=!1;this.cells=[];this.isAnimating=!1;let[n,o]=t.split(":").map(a=>+a),r={base:n,boxes:o};this.model=e.bindSettingsPanel(this,Aa,r),this.$outline=d("rect",{class:"outline",rx:12},this.$el),this.model.watch(()=>this.draw(this.model)),this.setColour(u.purple),this.onMove=()=>{let a=Array.from(e.selection.tiles).filter(l=>l.type==="dot");for(let l of this.cells)l.hover(a.some(h=>l.contains(h.posn)))},this.onMoveEnd=()=>{for(let a of this.cells)a.hover(!1)},e.on("move-selection",this.onMove),e.on("move-end",this.onMoveEnd),this.onChange=()=>this.rearrangeDots(),setTimeout(()=>{this.rearrangeDots(),e.on("change",this.onChange)})}delete(){this.$parent.off("move-selection",this.onMove),this.$parent.off("move-end",this.onMoveEnd),this.$parent.off("change",this.onChange),super.delete()}select(){this.isActive=!0,this.$outline.show();for(let t of this.cells)t.hover()}deselect(){this.isActive=!1,this.$outline.hide();for(let t of this.cells)t.hover(!1);this.$parent.$tiles.prepend(this.$el)}draw(t){let e=Math.round(t.base),i=Math.round(t.boxes);if(this.options=`${e}:${i}`,this.cells.length>i){for(let o=i;o<this.cells.length;++o)this.cells[o].delete();this.cells=this.cells.slice(0,i)}else if(this.cells.length<i)for(let o=this.cells.length;o<i;++o){let r=new Va(this,o);this.cells.push(r),r.setColour(this.colour)}for(let o of this.cells)o.setBase(e);let n=150*(i-1)+10;this.path=new $(new c(-n,-10),n+160,170),this.$outline.setRect(this.path),this.transform(),this.$parent.selection.update()}getSnapPoints(){return[]}setColour(t){super.setColour(t);for(let e of this.cells)e.setColour(t)}moveEnd(){super.moveEnd();for(let t of this.cells)for(let e of[...t.dots,...t.antiDots])e.cell=void 0}rearrangeDots(){if(!this.isAnimating){for(let t of this.cells)t.clear();for(let t of this.$parent.tiles)if(!(t.type!=="dot"||t.deleted))for(let e of this.cells)(t.cell===e||!t.cell&&e.contains(t.posn))&&e.addDot(t);for(let t of this.cells)t.rearrange()}}static makeThumbnail(t,e){let i=d("svg",{width:160,height:60},e);for(let n of[105,55,5])d("rect",{x:n,y:5,width:50,height:50,class:"dot-cell",stroke:"#eee",style:"stroke-width: 6px"},i),d("circle",{cx:n+25,cy:5,r:2},i),d("circle",{cx:n+25,cy:55,r:2},i)}static action(t,e){return M(this,null,function*(){if(t==="explode")for(let i of e)i.isAnimating||i.cells[0].explode();else if(t==="annihilate")for(let i of e)i.isAnimating||i.cells[0].annihilate()})}},Va=class{constructor(t,e=0){this.machine=t;this.index=e;this.dots=[];this.antiDots=[];let i=-150*e;this.$el=d("rect",{class:"dot-cell",width:150,height:150,x:i}),this.$label=d("text",{class:"dot-label",x:75+i,y:154,"font-size":"12px"},t.$el),this.$value=d("text",{class:"dot-label",x:75+i,y:6,text:0,"font-size":"18px"},t.$el),this.bounds=new $(new c(i,0),150,150),t.$el.prepend(this.$el)}setBase(t){this.$label.text=Lt(Math.pow(t,this.index))}delete(){this.$el.remove(),this.$label.remove(),this.$value.remove()}setColour(t){this.$el.setAttr("stroke",t),this.machine.isActive&&this.$el.css("fill",t)}hover(t=!0){this.machine.isActive&&!t||this.$el.css("fill",t?this.machine.colour:"none")}contains(t){return this.bounds.translate(this.machine.posn).contains(t)}clear(){this.dots=[],this.antiDots=[]}addDot(t){(t.options==="1"?this.dots:this.antiDots).push(t),t.cell=this}rearrange(){this.$value.text=Lt(this.dots.length-this.antiDots.length);let t=[...this.dots,...this.antiDots];if(!t.length)return;let e=Math.ceil(Math.sqrt(t.length)),i=Math.ceil(t.length/e),n=t.length<=16?30:t.length<=25?25:20,o=this.bounds.center.add(this.machine.posn).shift(-n*(e-1)/2,-n*(i-1)/2),r=N(a=>o.shift(a%e*n,Math.floor(a/e)*n),t.length);return this.animatePoints(t,r)}animatePoints(t,e){let i=t.map(n=>n.posn);for(let[n,o]of t.entries())o.setTransform(e[n]);return X(n=>{var o;for(let[r,a]of t.entries()){let l=c.interpolate(i[r],e[r],tt("quad",n));a.$el.setTransform(l),a.transformed=(o=a.path)==null?void 0:o.translate(l)}this.machine.$parent.selection.update()},240).promise}getDotsToExplode(){let t=this.machine.model.base;if(this.dots.length>=t)return this.dots.splice(0,t);if(this.antiDots.length>=t)return this.antiDots.splice(0,t)}explode(){return M(this,null,function*(){let t=this.machine.cells[this.index+1];if(!t){this.machine.isAnimating=!1,this.machine.$parent.change({tilesChanged:this.dots});return}this.machine.isAnimating=!0;let e=this.getDotsToExplode();if(!e)return t.explode();t.addDot(e[0]);for(let i of e.slice(1))i.popOut();return t.rearrange(),yield qi(400),this.rearrange(),yield qi(400),this.explode()})}annihilate(){return M(this,null,function*(){this.machine.isAnimating=!0;let t=Math.min(this.dots.length,this.antiDots.length);if(t){let i=this.dots.splice(0,t),n=this.antiDots.splice(0,t);for(let o of[...i,...n])o.popOut();this.rearrange(),yield qi(600)}let e=this.machine.cells[this.index+1];if(e)return e.annihilate();this.machine.isAnimating=!1,this.machine.$parent.change({tilesChanged:this.dots})})}};var us=25/2,gi=class extends S{constructor(t,e,i){super(e,i);this.type="dot";this.deleted=!1;this.options=t,this.$path=d("circle",{r:us,class:"polygon-tile"},this.$el),this.$outline=d("circle",{r:us,class:"outline"},this.$el),this.path=new _(T,us),this.setColour(u.blue)}setColour(t){this.colour=t,this.$path.setAttr("fill",this.options==="-1"?u.red:this.colour)}getSnapPoints(){return[]}getCell(){for(let t of this.$parent.tiles)if(!(t.type!=="dot-machine"||t.isActive)){for(let e of t.cells)if(e.contains(this.posn))return e}}moveEnd(){let t=this.cell,e=this.cell=this.getCell();if(!t||!e||t===e||t.machine!==e.machine)return;let i=Math.abs(t.index-e.index),n=t.machine.model.base**i;if(t.index<e.index){let o=this.options==="1"?t.dots:t.antiDots;if(o.length<n)return this.cell=t;for(let r of o.filter(a=>!a.isActive).slice(0,n-1))r.popOut()}else for(let o=0;o<n-1;++o){let r=new gi(this.options,this.$parent);r.posn=this.posn,r.cell=e}}static makeThumbnail(t,e){let i=t==="1"?u.blue:u.red,n=d("svg",{width:40,height:40},e);d("circle",{class:"polygon-tile",cx:20,cy:20,r:us,fill:i},n)}negate(){this.options=this.options==="-1"?"1":"-1",this.setColour(u.blue)}popOut(){return M(this,null,function*(){this.deleted=!0,yield this.$path.exit("pop").promise,this.delete()})}static action(t,e){if(t==="negate"){for(let i of e)i.negate();e[0].$parent.change({tilesChanged:e})}}};function Ea(s){return s===0?u.grey:s>0?s%2?u.orange:u.blue:s%2?u.red:u.teal}function La(s){return+s.replace("\u2013","-")}function Oa(s,t,e=40,i=50){t=E(Math.round(t),-9999,9999);let o=(s.text=Lt(t)).length;return s.css("font-size",(o>=6?.625:o>=4?.75:1)*e+"px"),s.setAttr("y",(o>=6?.9:o>=4?.94:1)*i),t}var On=class extends S{constructor(t,e,i){super(e,i);this.type="number-card";this.path=new $(T,75),this.$path=d("rect",{class:"polygon-tile",rx:10,width:75,height:75},this.$el),this.$label=d("text",{x:75/2,fill:"white",style:"text-anchor: middle"},this.$el),this.$outline=d("rect",{class:"outline",rx:10,width:75,height:75},this.$el),this.setValue(La(t))}setValue(t){this.value=Oa(this.$label,t),this.options=""+this.value,this.setColour()}setColour(t){super.setColour(t||Ea(this.value)),this.$path.setAttr("fill",O(this.colour))}highlight(t=!0){this.$outline.setClass("active",t)}move(t){if(super.move(t),!this.$parent.options.mergeTiles||this.$parent.selection.tiles.size>1)return;let e=this.findNearby("number-card",40);this.setCollision(e&&ot(e.value+this.value,-9999,9999)?e:void 0)}collide(t){t.highlight(!1),t.setValue(t.value+this.value),this.$parent.selection.add(t,!0),this.delete()}static makeThumbnail(t,e){let i=d("svg",{width:60,height:60},e),n=d("rect",{x:5,y:5,width:50,height:50,class:"polygon-tile",rx:5},i),o=d("text",{fill:"white",x:30,style:"text-anchor: middle"},i);e.onAttr("data-options",r=>{let a=Oa(o,La(r),30,39);n.setAttr("fill",Ea(a))})}};var at=50,Te=14,Rd=`M-${at/2} -4.5h${at*Te}v-33h9v75h-9v-33h-${at*Te}v33h-9v-75h9Z`,In=class extends S{constructor(t,e,i){super(e,i);this.type="abacus";this.options=t,this.path=new $(new c(-at/2-9,-at/2-12.5),Te*at+18,at+25),d("path",{path:this.path,fill:"transparent"},this.$el),d("path",{d:Rd,class:"polygon-tile",fill:"#7e7c86"},this.$el),d("path",{path:this.path,class:"outline"},this.$el),this.positions=t.split(",").map(n=>+n),this.$beads=this.positions.map(n=>d("circle",{cx:n*at,r:at/2,class:"polygon-tile"},this.$el)),this.$gradients=this.positions.map(n=>d("circle",{cx:n*at,r:at/2,class:"bead-gradient"},this.$el)),this.count=this.$beads.length;for(let[n,o]of this.$beads.entries())this.setupBead(o,n);this.setColour(u.blue)}setupBead(t,e){let i=0;this.$parent.events.listen(t,{click:()=>{this.locked||this.$parent.selection.add(this,!this.$parent.events.shiftKey)},start:n=>{i=this.positions[e]-this.relativePosn(n.posn).x/at},move:n=>{let o=this.positions[e]=E(i+this.relativePosn(n.posn).x/at,e,Te-(this.count-e)),r=o;for(let l=e+1;l<this.count;++l)this.positions[l]<r+1&&(this.positions[l]=r+1),r=this.positions[l];let a=o;for(let l=e-1;l>=0;--l)this.positions[l]>a-1&&(this.positions[l]=a-1),a=this.positions[l];for(let[l,h]of this.$beads.entries())h.setAttr("cx",this.positions[l]*at),this.$gradients[l].setAttr("cx",this.positions[l]*at)},end:()=>{let n=this.options;this.options=this.positions.join(","),n!==this.options&&this.$parent.change({tilesChanged:[this]})}})}setColour(t){super.setColour(t);let e=this.$beads.length/2;for(let[i,n]of this.$beads.entries())n.setAttr("fill",i<e?t:V.mix("#fff",t,.8))}getSnapPoints(){return[new c(-at/2,-25),new c((Te-.5)*at,-25),new c(-at/2,25),new c((Te-.5)*at,25),new c(-at/2,50),new c((Te-.5)*at,50)]}static makeThumbnail(t,e){let i=d("svg",{width:240,height:40},e);d("line",{x1:5,y1:18,x2:235,y2:20,stroke:"white","stroke-width":"3px"},i),d("line",{x1:4,y1:3,x2:4,y2:37,stroke:"white","stroke-width":"3px"},i),d("line",{x1:236,y1:3,x2:236,y2:37,stroke:"white","stroke-width":"3px"},i);for(let n=0;n<10;++n){let o=n<5?u.blue:V.mix("#fff",u.blue,.7),r={cx:16+20*n,cy:20,r:10,style:"stroke-width: 0.5px"};d("circle",Zt(Zt({},r),{class:"polygon-tile",fill:o}),i),d("circle",Zt(Zt({},r),{class:"bead-gradient"}),i)}}};var Gd={1:u.yellow,x:u.green,x2:u.blue},Ia={1:1,x:5,x2:25,"-1":-1,"-x":-5,"-x2":-25},yi=25,Ra=yi*5.4,Dd="#ddd";function fs(s){return s.replace("-","\u2013").replace("2","\xB2")}function Rn(s){return s[0]==="-"?u.red:Gd[s]}function Nd(s){let t=D(s,"x2","-x2")?Ra:yi,e=D(s,"1","-1")?yi:Ra;return as(t,e)}var vi=class extends B{constructor(t,e,i){super(Nd(t.toLowerCase()),e,i);this.type="algebra-tile";this.options=t.toLowerCase(),this.value=Ia[this.options],this.$text=d("text",{text:fs(this.options),class:"polygon-label",y:6},this.$el),this.setColour(Rn(this.options))}setColour(t=this.colour){super.setColour(t),this.$path.setAttr("fill",O(this.collision?Dd:this.colour)),this.$text.text=this.collision?"0":fs(this.options)}customTransform(){this.$text.css("transform",`rotate(${-this.rot}deg)`)}setCollision(t){this.collision=t,this.setColour()}move(t){if(super.move(t),this.collision){if(c.distance(this.posn,this.collision.posn)<.95*yi)return;this.collision.setCollision(),this.setCollision()}let e=this.options[0]==="-"?this.options.slice(1):"-"+this.options;for(let i of this.$parent.tiles)if(!(!i.is("algebra-tile")||i.collision||i===this)&&i.options===e&&!(c.distance(this.posn,i.posn)>=.95*yi)){this.setCollision(i),i.setCollision(this);return}}static makeThumbnail(t,e){let i=D(t,"x2","-x2")?78:20,n=D(t,"1","-1")?20:78,o=D(t,"x2","-x2")?102:44,r=new $(new c((o-i)/2,40-n/2),i,n),a=d("svg",{width:o,height:80},e);d("path",{class:"polygon-tile",path:r,fill:Rn(t)},a),d("text",{text:fs(t),class:"polygon-label",x:o/2,y:45},a)}negate(){this.options.startsWith("-")?this.options=this.options.slice(1):this.options="-"+this.options,this.value=Ia[this.options],this.setColour(Rn(this.options)),this.$text.text=fs(this.options)}static action(t,e){if(t==="negate"){for(let i of e)i.negate();e[0].$parent.change({tilesChanged:e})}}};var Ga="M-125,0l35,252c0,11,40.3,20,90,20s90-9,90-20L125,0Z",Da=N(s=>new c(s<5?-45:45,65+40*(s%5)),10),Gn=class extends S{constructor(t,e){super(e);this.type="bucket";this.canRotate=!1;this.canDragToSelect=!1;this.isAnimating=!1;this.tiles=Ie(void 0,20);d("path",{class:"polygon-tile bucket",d:Ga,fill:"#ccc"},this.$el),d("ellipse",{class:"polygon-tile bucket",rx:125,ry:28,fill:"#888"},this.$el),this.$text=d("text",{text:0,class:"bucket-label",y:12},this.$el),this.setColour(u.grey),this.path=new C(new c(-125,0),new c(0,-28),new c(125,0),new c(90,252),new c(0,272),new c(-90,252)),this.onMoveEnd=()=>this.recompute(),e.on("change",this.onMoveEnd)}delete(){this.$parent.off("change",this.onMoveEnd),super.delete()}select(){this.isActive=!0,this.$el.addClass("active")}deselect(){this.isActive=!1,this.$el.removeClass("active"),this.$parent.$tiles.prepend(this.$el)}getSnapPoints(){return[]}recompute(){return M(this,null,function*(){var e;if(this.isAnimating)return;let t=[];for(let[i,n]of this.tiles.entries())n&&!this.$parent.tiles.has(n)&&(this.tiles[i]=void 0);for(let i of this.$parent.tiles){if(!i.is("algebra-tile")||!i.options.endsWith("1"))continue;let n=i.options!=="1",o=(e=this.transformed)==null?void 0:e.contains(i.posn),r=this.tiles.indexOf(i);if(r>=0&&!o&&(this.tiles[r]=void 0),!o)continue;if((n?r>=0&&r<10:r>=10)&&(this.tiles[r]=void 0,r=-1),r<0&&(r=this.tiles.findIndex((l,h)=>!l&&(n?h>=10:h<10))),r<0)return;this.tiles[r]=i;let a=Da[r%10].shift(n?15:-15,0).add(this.posn);a.equals(i.posn)||t.push({tile:i,from:i.posn,to:a})}if(this.$text.text=Lt(q(this.tiles.map((i,n)=>i?n<10?1:-1:0))),t.length){this.isAnimating=!0,yield X(i=>{var o;let n=tt("quad",i);for(let{tile:r,from:a,to:l}of t){let h=c.interpolate(a,l,n);r.posn=h,r.$el.setTransform(h,r.rot*nt),r.transformed=(o=r.path)==null?void 0:o.translate(h)}this.$parent.selection.update()},240).promise;for(let i of t)i.tile.transform(),i.tile.move();this.isAnimating=!1}})}fill(){if(this.isAnimating)return[];this.$parent.$tiles.prepend(this.$el);let t=[];for(let[e,i]of this.tiles.entries()){if(i)continue;let n=new vi(e<10?"1":"-1",this.$parent);n.setTransform(Da[e%10].shift(e<10?-15:15,0).add(this.posn)),this.tiles[e]=n,t.push(n)}return this.$text.text="0",t}static makeThumbnail(t,e){let i=d("svg",{width:120,height:140,viewBox:"-140 -40 280 320"},e);d("path",{class:"polygon-tile bucket",d:Ga,fill:"#ccc",style:"stroke-width: 2px"},i),d("ellipse",{class:"polygon-tile bucket",rx:125,ry:28,fill:"#888",style:"stroke-width: 2px"},i)}static action(t,e){return M(this,null,function*(){if(t==="fill"){let i=[];for(let n of e)i.push(...n.fill())}})}};var Ut=50,bi=[u.yellow,"#f15e19","#e1343b",u.red,"#8d2ca1","#4e53d0",u.blue,"#0595bf","#0ba27b",u.green,"#8bba18","#dbc607"];function ms(s,t,e,i,n=0){let o=`1 over ${s}`,r=d("g",{class:"fraction","aria-label":o},i);d("text",{text:1,x:t,y:.42*e+n},r),d("text",{text:s,x:t,y:2.5+.77*e+n},r);let a=s>=10?.2:.14;return d("line",{x1:t-a*e,y1:e/2+n,x2:t+a*e,y2:e/2+n},r),r}function Na(s,t,e,i,n,o,r=-t/2,a=-t/2){let l=`translate(${s*i+r} ${a})`,h=d("g",{transform:l},n),p=d("rect",{width:s,height:t,fill:o,class:"polygon-tile"},h),g=ms(e,s/2,t,h);return[h,p,g]}var Ze=class extends S{constructor(t,e,i){super(e,i);this.type="fraction-bar";this.count=0;this.$parts=[];this.options=t;let[n,o]=t.split(":").map(r=>+r);this.denominator=n,this.tileWidth=10*Ut/n,this.colour=bi[n-1],this.$fraction=d("g",{},this.$el),this.$outline=d("path",{class:"outline"},this.$el),this.$handle=this.makeHandle("h",r=>this.setCount(Math.round(r.x/this.tileWidth))),this.setCount(o)}setCount(t){if(t=E(t,1,20),t!==this.count){if(this.value=t/this.denominator,t<this.count){for(let e=t;e<this.count;e+=1)this.$parts[e][0].remove();this.$parts=this.$parts.slice(0,t)}else for(let e=this.count;e<t;e+=1)this.$parts.push(Na(this.tileWidth,Ut,this.denominator,e,this.$fraction,this.colour));this.count=t,this.options=`${this.denominator}:${t}`,this.path=new $(new c(-Ut/2,-Ut/2),t*this.tileWidth,Ut),this.$outline.draw(this.path),this.$handle.setTransform(new c(t*this.tileWidth-Ut/2,-Ut/2)),this.transform(),this.$parent.selection.update()}}setColour(t){this.colour=t;for(let e of this.$parts)e[1].setAttr("fill",O(t))}customTransform(){for(let t of this.$parts)t[2].css("transform",`rotate(${-this.rot}deg)`)}static makeThumbnail(t,e){let[i,n]=t.split(":").map(l=>+l),o=d("svg",{width:222,height:22},e),r=bi[i-1],a=220/i;for(let l=0;l<n;++l)Na(a,20,i,l,o,r,1,1)}getSnapPoints(){let t=[];for(let e=0;e<=this.count;e+=1)t.push(new c(e*this.tileWidth-Ut/2,-Ut/2)),t.push(new c(e*this.tileWidth-Ut/2,Ut/2));return t}split(){if(this.count===1)return[];let t=N(e=>{let i=this.posn.shift(e*this.tileWidth,0).rotate(this.rot*nt,this.posn),n=new Ze(`${this.denominator}:${1}`,this.$parent);return n.setTransform(i,this.rot),n.setColour(this.colour),n},this.count);return this.$parent.selection.select(t),this.delete(),t}static action(t,e){if(t==="split"){let i=[];for(let n of e)i.push(...n.split());e[0].$parent.change({tilesAdded:i,tilesDeleted:e})}else if(t==="merge"){let i=Array.from(e),n=Math.min(...i.map(h=>h.posn.x)),o=Math.min(...i.map(h=>h.posn.y)),r=i.map(h=>h.count),a=q(r),l=new Ze(`${i[0].denominator}:${a}`,i[0].$parent);l.setColour(V.mixMany(i.map(h=>V.from(h.colour)),r).hex),l.setTransform(new c(n,o),i[0].rot);for(let h of e)h.delete();i[0].$parent.selection.add(l),e[0].$parent.change({tilesAdded:[l],tilesDeleted:e})}}};var Dn=100,Nn=class extends S{constructor(t,e,i){super(e,i);this.type="fraction-circle";this.rotateAroundOrigin=!0;this.options=t;let n={class:"polygon-tile",path:this.path,fill:this.colour};this.$path=d("path",n,this.$el),this.$outline=d("path",{class:"outline",path:this.path},this.$el);let o=+t;if(this.value=1/o,o>1){let r=new c(0,-Dn).rotate(-Math.PI/o),a=this.path=new re(T,r,2*Math.PI/o);this.snapAngles=[0,me(r)*kt,me(a.end)*kt]}else this.path=new _(T,Dn);if(this.$path.draw(this.path),this.$outline.draw(this.path),o>1){let r=-Dn/2-25-(o-2)*2.5;this.$label=ms(o,0,50,this.$el,r)}this.colour=bi[o-1],this.$path.setAttr("fill",this.colour)}customTransform(){var t;(t=this.$label)==null||t.css("transform",`rotate(${-this.rot}deg)`)}setColour(t){this.colour=t,this.$path.setAttr("fill",O(t))}static makeThumbnail(t,e){let i=+t,n=d("svg",{width:80,height:44},e),o=d("path",{class:"polygon-tile"},n),r=new c(40,2).rotate(-Math.PI/i,new c(40,42)),a=i>1?new re(new c(40,42),r,2*Math.PI/i):new _(new c(40,22),20);if(o.draw(a),o.setAttr("fill",bi[i-1]),i>1){let l=d("g",{class:"fraction"},n);l.translate(40,12-i),ms(i,0,25,l)}}};var ie=25;function zn(s,t,e,i,n){return new C(new c(-n,-n),new c(-n,s),new c(n,s),new c(n,-n),new c(t,-n),new c(t,n),new c(n,n),new c(n,e),new c(-n,e),new c(-n,n),new c(i,n),new c(i,-n))}var qn=class extends S{constructor(t,e,i){super(e,i);this.type="grid";this.showSelectionOutline=!0;this.canDragToSelect=!1;this.options=t,this.dimensions=new c,this.$axes=N(()=>d("line",{class:"grid-axis",stroke:"#777"},this.$el),2),this.$fill=d("path",{fill:"transparent"},this.$el),this.$handles=[0,1].map(o=>this.makeHandle("c",r=>{let a=o?this.dimensions.x:Math.round(r.x/ie-1),l=o?Math.round(r.y/ie-1):this.dimensions.y;this.setDimensions(a,l)})),this.$handles[1].css("cursor","ns-resize");let n=t.split(":");this.setDimensions(+n[0],+n[1])}setDimensions(t,e){t=E(t,1,100),e=E(e,1,100),!(t===this.dimensions.x&&e===this.dimensions.y)&&(this.dimensions=new c(t,e),this.options=`${t}:${e}`,this.path=zn(-1.5,t+1,e+1,-1.5,.5).scale(ie),this.$axes[0].setLine({x:-1.5*ie,y:0},{x:(t+1)*ie,y:0}),this.$axes[1].setLine({x:0,y:-1.5*ie},{x:0,y:(e+1)*ie}),this.$handles[0].setCenter({x:(t+1)*ie,y:0}),this.$handles[1].setCenter({x:0,y:(e+1)*ie}),this.$fill.draw(this.path),this.transform(),this.$parent.selection.update())}setColour(t){this.colour=t;for(let e of this.$axes)e.setAttr("stroke",O(t))}static makeThumbnail(t,e){let i=d("svg",{width:80,height:80},e);d("line",{x1:20,y1:0,x2:20,y2:80,stroke:"white","stroke-width":2},i),d("line",{x1:0,y1:20,x2:80,y2:20,stroke:"white","stroke-width":2},i)}};var gs=new Map,_n=s=>s.type+s.options+s.colour,Bn=s=>{var t,e;return(e=(t=s.value)!=null?t:gs.get(_n(s)))!=null?e:1};function zd(s,t){let e={},i=0,n=(l,h=1)=>{i+=h*Bn(l),l.value===void 0&&(e[_n(l)]=(e[_n(l)]||0)+h)};for(let l of s)n(l,1);for(let l of t)n(l,-1);if(A(i,0))return;let o=Object.keys(e).filter(l=>e[l]),r=o.filter(l=>!gs.has(l))[0]||L(o);if(!r)return!0;let a=gs.get(r)||1;gs.set(r,a-i/e[r])}var ys="M120,0C120,16,66.3,20,0,20S-120,16-120,0Z",za="M0,26A18.1,18.1,0,0,0-18,44V72H18V44A18.1,18.1,0,0,0,0,26Z",qa=["text","grid","number-line","spinner","decimal-grid","axes","custom-spinner","ruler","protractor","compass","geo","dot-machine","abacus","equation"],vs=new $(new c(0,-180),240,180),Se=15;function _a(s,t){var i;let e=s.posn.shift(0,t);s.$el.setTransform(e,s.rot*nt),s.transformed=(i=s.path)==null?void 0:i.rotate(s.rot).translate(e)}var Hn=class extends S{constructor(t,e,i){super(e,i);this.type="balance";this.canRotate=!1;this.canDragToSelect=!1;this.level=0;this.left=[];this.right=[];this.isAnimating=!1;this.level=+t||0,this.options=t||"0",this.$beam=d("path",{class:"balance-beam"},this.$el),this.$left=d("path",{d:ys,class:"balance"},this.$el),this.$right=d("path",{d:ys,class:"balance"},this.$el),this.$base=d("path",{d:za,class:"balance"},this.$el),this.setColour("#bbb"),this.customTransform(),this.draw();let n=d("path",{path:vs,class:"balance-target"},this.$el),o=d("path",{path:vs,class:"balance-target"},this.$el);this.onMoveStart=()=>{if(!Qo(e.selection.tiles,r=>qa.includes(r.type))){n.setTransform({x:-280,y:this.level*Se}),o.setTransform({x:40,y:-this.level*Se});for(let r of[n,o])r.show()}},this.onMoveEnd=()=>{for(let r of[n,o])r.hide()},this.onChange=r=>{this.checkTileOverlaps(),this.rebalance(400,r)},e.on("move-start",this.onMoveStart),e.on("move-end",this.onMoveEnd),setTimeout(()=>{this.checkTileOverlaps(),e.on("change-internal",this.onChange)})}delete(){this.$parent.off("move-start",this.onMoveStart),this.$parent.off("move-end",this.onMoveEnd),this.$parent.off("change-internal",this.onChange),super.delete()}checkTileOverlaps(){let t=vs.translate(this.posn).shift(-280,this.level*Se),e=vs.translate(this.posn).shift(40,-this.level*Se);this.left=[],this.right=[];for(let i of this.$parent.tiles)!i.transformed||i.type==="balance"||qa.includes(i.type)||(ci(t,i.transformed)?this.left.push(i):ci(e,i.transformed)&&this.right.push(i))}draw(t=this.level){let e=new c(-160,t*15),i=new c(160,-t*15);this.$beam.draw(new ae(e.shift(0,10),e.shift(0,44),i.shift(0,44),i.shift(0,10))),this.$left.setTransform(e),this.$right.setTransform(i)}rebalance(t=400,e){return M(this,null,function*(){let i=q(this.left.map(h=>Bn(h))),n=q(this.right.map(h=>Bn(h))),o=A(i,n)?0:i<n?-1:1;if(o===this.level||this.isAnimating)return;let r=this.level,a=(o-r)*Se;this.level=o;let l=o.toString();e&&l!==this.options&&(e.tilesChanged||(e.tilesChanged=[]),e.tilesChanged.includes(this)||e.tilesChanged.push(this)),this.options=l;for(let h of this.left)h.setTransform(h.posn.shift(0,a));for(let h of this.right)h.setTransform(h.posn.shift(0,-a));this.isAnimating=!0,yield X(h=>{this.draw(gt(r,o,h));for(let p of this.left)_a(p,(h-1)*a);for(let p of this.right)_a(p,(1-h)*a);this.$parent.selection.update()},t).promise,this.isAnimating=!1,this.transform(),this.$parent.selection.update()})}customTransform(){let t=this.level*Se;this.path=new C(new c(-280,t),new c(-40,t),new c(-40,25),new c(40,25),new c(40,-t),new c(280,-t),new c(280,-t+48),new c(40,-t+48),new c(40,72),new c(-40,72),new c(-40,t+48),new c(-280,t+48))}getSnapPoints(){return[]}getSnapLines(){let t=this.level*Se;return[new H(new c(-280,t),new c(-40,t)),new H(new c(40,-t),new c(280,-t))]}setColour(t){this.colour=t,this.$beam.css("stroke",t);for(let e of[this.$base,this.$left,this.$right])e.css("fill",O(t))}static makeThumbnail(t,e){let i=d("svg",{width:250,height:50,viewBox:"-290 -10 580 82",class:"scale"},e);d("path",{d:"M-160 10v34h320v-34",fill:"transparent",stroke:"#bbb","stroke-width":10},i),d("path",{d:ys,transform:"translate(-160 0)",fill:"#bbb"},i),d("path",{d:ys,transform:"translate(160 0)",fill:"#bbb"},i),d("path",{d:za,fill:"#bbb"},i)}static action(t,e){return M(this,null,function*(){if(t==="balance"){for(let i of e)zd(i.left,i.right)&&Ct("balance-error"),i.rebalance();e[0].$parent.change({tilesChanged:e})}})}};var Un={circle:"M -25 0a25,25 0 1 0 50 0a25 25 0 1 0 -50 0",square:"M0 -25L25 0L0 25L-25 0Z",cross:"M25 -9L9 -9L9 -25L-9 -25L-9 -9L-25 -9L-25 9L-9 9L-9 25L9 25L9 9L25 9L25 -9Z",weight:"M24.3,22.1,17.7-6.1A4,4,0,0,0,14-9H8a10.3,10.3,0,0,0,2-6A10,10,0,0,0,0-25,10,10,0,0,0-10-15,10.3,10.3,0,0,0-8-9h-6a4,4,0,0,0-3.7,2.9l-6.6,28.2A2.2,2.2,0,0,0-22,25H22A2.2,2.2,0,0,0,24.3,22.1ZM0-11a4,4,0,0,1-4-4,4,4,0,0,1,4-4,4,4,0,0,1,4,4A4,4,0,0,1,0-11Z",star:"M0 15.7L15.5 23.8L12.5 6.6L25 -5.6L7.7 -8.1L0 -23.8L-7.7 -8.1L-25 -5.6L-12.5 6.6L-15.5 23.8L0 15.7Z",heart:"M3.4,20.8a4.9,4.9,0,0,1-6.7-.1l-.3-.2C-16.7,8.6-25.3.8-25-8.9a13.7,13.7,0,0,1,5.9-10.7A14.4,14.4,0,0,1,0-16.8a14.4,14.4,0,0,1,19.1-2.8A13.7,13.7,0,0,1,25-8.9C25.3.8,16.7,8.6,3.6,20.5Z"},qd={weight:"M24.3,22.1,17.7-6.1A4,4,0,0,0,14-9H8a10.3,10.3,0,0,0,2-6A10,10,0,0,0,0-25,10,10,0,0,0-10-15,10.3,10.3,0,0,0-8-9h-6a4,4,0,0,0-3.7,2.9l-6.6,28.2A2.2,2.2,0,0,0-22,25H22A2.2,2.2,0,0,0,24.3,22.1Z"},Ba={circle:u.orange,square:u.purple,cross:u.green,weight:u.blue,star:u.yellow,heart:u.red},Zn=class extends B{constructor(t,e,i){super("square",e,i);this.type="token";this.options=t,this.$path.setAttr("d",Un[t]),this.$outline.setAttr("d",qd[t]||Un[t]),this.setColour(Ba[t])}static makeThumbnail(t,e){let i=d("svg",{width:36,height:36},e),n=d("path",{d:Un[t],class:"polygon-tile"},i);n.setTransform({x:18,y:18},0,.6),n.setAttr("fill",Ba[t])}};var z=class extends Error{constructor(t,e){super(e);this.name=t}static undefinedVariable(t){return new z("EvalError",`Undefined variable \u201C${t}\u201D.`)}static undefinedFunction(t){return new z("EvalError",`Undefined function \u201C${t}\u201D.`)}static invalidCharacter(t){return new z("SyntaxError",`Unknown symbol \u201C${t}\u201D.`)}static conflictingBrackets(t){return new z("SyntaxError",`Conflicting brackets \u201C${t}\u201D.`)}static unclosedBracket(t){return new z("SyntaxError",`Unclosed bracket \u201C${t}\u201D.`)}static startOperator(t){return new z("SyntaxError",`A term cannot start with a \u201C${t}\u201D.`)}static endOperator(t){return new z("SyntaxError",`A term cannot end with a \u201C${t}\u201D.`)}static consecutiveOperators(t,e){return new z("SyntaxError",`A \u201C${t}\u201D cannot be followed by a \u201C${e}\u201D.`)}static invalidExpression(){return new z("SyntaxError","This expression is invalid.")}},bs={pi:Math.PI,\u03C0:Math.PI,e:Math.E},Fn={"(":")","[":"]","{":"}"},Fe={"*":"\xB7","**":"\u2217","//":"//","+-":"\xB1","\u2013":"\u2212","-":"\u2212",xx:"\xD7",sum:"\u2211",prod:"\u220F",int:"\u222B",del:"\u2202",grad:"\u2207",aleph:"\u2135",not:"\xAC",AA:"\u2200",EE:"\u2203","'":"\u2019","!=":"\u2260","<=":"\u2264",">=":"\u2265",in:"\u2208","!in":"\u2209","==":"\u2261","~=":"\u2245","~~":"\u2248",sub:"\u2282",sube:"\u2286",prop:"\u221D",oo:"\u221E",cap:"\u2229",cup:"\u222A","<-":"\u2190","->":"\u2192","=>":"\u21D2","<=>":"\u21D4","|->":"\u21A6",uarr:"\u2191",darr:"\u2193",lArr:"\u21D0"},wi={Gamma:"\u0393",Delta:"\u0394",Theta:"\u0398",Lambda:"\u039B",Xi:"\u039E",Pi:"\u03A0",Sigma:"\u03A3",Phi:"\u03A6",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u025B",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",pi:"\u03C0",rho:"\u03C1",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",CC:"\u2102",NN:"\u2115",QQ:"\u211A",RR:"\u211D",ZZ:"\u2124"},Ha="abcdefghijklmnopqrstuvwxyz",_d=Ha.split(""),Bd=Ha.toUpperCase().split(""),Hd=Object.values(wi),Ud=[..._d,...Bd,...Hd,"$"],Zd="|()[]{}\xF7,!<>=*/+-\u2013\u2212~^_\u2026\xB0\u2022\u2225\u22A5'\u2220:%\u223C\u25B3",Fd=Object.values(Fe),jd=[...Zd,...Fd],Wd={_:"sub","^":"sup","//":"/","\xF7":"/"},Ua={"<":"&lt;",">":"&gt;"};function Za(s){return s in Ua?Ua[s]:s}var Kd=["abs","round","floor","ceil","max","min","mod","lcm","gcd","gcf","log","exp","ln","sqrt","root","sin","cos","tan","sec","csc","cot","cosec","cotan","arcsin","arccos","arctan","sinh","cosh","tanh","sech","csch","coth","cosech"];function xi(s){return Kd.includes(s)}var je={"+":"plus","\u2212":"minus","\xB7":"times","\xD7":"times","/":"over","//":"divided by","%":"percent","!":"factorial","\xB1":"plus-minus","=":"equals","\u2260":"does not equal","<":"is less than",">":"is greater than","\u2264":"is less than or equal to","\u2265":"is greater than or equal to",\u03C0:"pi","\u2245":"is congruent to","\u2225":"is parallel to","\u22A5":"is perpendicular to"};for(let s of Object.keys(wi))je[wi[s]]=s;var de=class{evaluate(t={}){return NaN}interval(t={}){return[this.evaluate(t),this.evaluate(t)]}substitute(t={}){return this}get simplified(){return this}get variables(){return[]}get functions(){return[]}collapse(){return this}toString(){return""}toVoice(t={}){return""}toMathML(t={}){return""}},$i=class extends de{constructor(t){super();this.n=t}evaluate(){return this.n}toString(){return""+this.n}toVoice(){return""+this.n}toMathML(){return`<mn>${this.n}</mn>`}},ws=class extends de{constructor(t){super();this.i=t}evaluate(t={}){if(this.i in t)return t[this.i];if(this.i in bs)return bs[this.i];throw z.undefinedVariable(this.i)}interval(t={}){var e;let i=(e=t[this.i])!==null&&e!==void 0?e:bs[this.i];if(Array.isArray(i))return i;if(typeof i=="number")return[i,i];throw z.undefinedVariable(this.i)}toMathML(){return`<mi${xi(this.i)?' mathvariant="normal"':""}>${this.i}</mi>`}substitute(t={}){return t[this.i]||this}get variables(){return[this.i]}toString(){return this.i}toVoice(){return this.i in je?je[this.i]:this.i.length===1?`_${this.i}_`:this.i}},Fa=class extends de{constructor(t){super();this.s=t}evaluate(t={}){if(this.s in t)return t[this.s];throw z.undefinedVariable(this.s)}toString(){return'"'+this.s+'"'}toVoice(){return this.s}toMathML(){return`<mtext>${this.s}</mtext>`}},jn=class extends de{toString(){return" "}toMathML(){return"<mspace></mspace>"}},Yt=class extends de{constructor(t){super();this.o=t}toString(){return this.o.replace("//","/")}toVoice(){return je[this.o]||this.o}get functions(){return[this.o]}toMathML(){let t=Za(this.toString());return`<mo value="${t}">${t}</mo>`}},ja=[-Infinity,Infinity],We=[NaN,NaN],Me=Math.PI/2,Wn=Math.PI*2,W=(s,t)=>[s-Number.EPSILON,t+Number.EPSILON],Ke=(...s)=>W(Math.min(...s),Math.max(...s)),Xd=s=>Math.abs(s[1]-s[0]),Xe=s=>isNaN(s[0])||isNaN(s[1]),Wa=s=>!isFinite(s[0])&&s[0]===s[1],Yd=(s,t)=>ot(t,s[0]-Number.EPSILON,s[1]+Number.EPSILON),xs=s=>Yd(s,0),se={add:(...s)=>s.reduce((t,e)=>t+e,0),sub:(...s)=>s.length>1?s[0]-s[1]:-s[0],mul:(...s)=>s.reduce((t,e)=>t*e,1),div:(s,t)=>s/t,abs:s=>Math.abs(s),round:s=>Math.round(s),floor:s=>Math.floor(s),ceil:s=>Math.ceil(s),max:(...s)=>Math.max(...s),min:(...s)=>Math.min(...s),mod:(s,t)=>s%t,lcm:(...s)=>si(...s),gcd:(...s)=>fe(...s),gcf:(...s)=>fe(...s),sup:(s,t)=>Math.pow(s,t),log:(s,t)=>Math.log(s)/(t===void 0?1:Math.log(t)),exp:s=>Math.exp(s),ln:s=>Math.log(s),sqrt:s=>Math.sqrt(s),root:(s,t)=>Math.pow(s,1/t),sin:s=>Math.sin(s),cos:s=>Math.cos(s),tan:s=>Math.tan(s),sec:s=>1/Math.cos(s),csc:s=>1/Math.sin(s),cot:s=>1/Math.tan(s),cosec:s=>se.csc(s),cotan:s=>se.cot(s),arcsin:s=>Math.asin(s),arccos:s=>Math.acos(s),arctan:s=>Math.atan(s),sinh:s=>Math.sinh(s),cosh:s=>Math.cosh(s),tanh:s=>Math.tanh(s),sech:s=>1/Math.cosh(s),csch:s=>1/Math.sinh(s),coth:s=>1/Math.tanh(s),cosech:s=>se.csch(s)};function $s(s,t){if(s[0]>0)return t[0]>=0?W(s[0]**t[0],s[1]**t[1]):Ke(s[0]**t[0],s[0]**t[1],s[1]**t[0],s[1]**t[1]);let e=t[0];return Number.isInteger(e)&&e===t[1]?e===0?[xs(s)?0:1,1]:e%2?W(s[0]**e,s[1]**e):xs(s)?[0,Math.max(s[0]**e,s[1]**e)]:[s[1]**e,s[0]**e]:We}function Ka(s,t=Wn){let e=Math.floor(s[0]/t)*t;return[s[0]-e,s[1]-e]}var R={add:(s,t)=>W(s[0]+t[0],s[1]+t[1]),sub:(s,t)=>t!==void 0?W(s[0]-t[1],s[1]-t[0]):W(-s[1],-s[0]),mul:(s,t)=>Ke(s[0]*t[0],s[0]*t[1],s[1]*t[0],s[1]*t[1]),div:(s,t)=>xs(t)?ja:Ke(s[0]/t[0],s[0]/t[1],s[1]/t[0],s[1]/t[1]),abs:s=>xs(s)?W(0,Math.max(-s[0],s[1])):Ke(Math.abs(s[0]),Math.abs(s[1])),round:s=>W(Math.round(s[0]),Math.round(s[1])),floor:s=>W(Math.floor(s[0]),Math.floor(s[1])),ceil:s=>W(Math.ceil(s[0]),Math.ceil(s[1])),max:(...s)=>W(Math.max(...s.map(t=>t[0])),Math.max(...s.map(t=>t[1]))),min:(...s)=>W(Math.min(...s.map(t=>t[0])),Math.min(...s.map(t=>t[1]))),mod:(s,t)=>{if(Xe(s)||Xe(t))return We;let e=s[0]/(s[0]<0?t[0]:t[1]);return e=e<0?Math.ceil(e):Math.floor(e),R.sub(s,R.mul(t,[e,e]))},lcm:(...s)=>Ke(si(...s.map(t=>t[0]))),gcd:(...s)=>Ke(fe(...s.map(t=>t[0]))),gcf:(...s)=>R.gcd(...s),sup:(s,t)=>$s(s,t),log:(s,t)=>(t!==void 0&&R.div(R.log(s),R.log(t)),W(s[0]<=0?-Infinity:Math.log(s[0]),Math.log(s[1]))),exp:s=>$s([Math.E,Math.E],s),ln:s=>R.log(s),sqrt:s=>$s(s,[.5,.5]),root:(s,t)=>$s(s,R.div([1,1],t)),sin:s=>R.cos(R.sub(s,[Me,Me])),cos:s=>Xe(s)||Wa(s)?We:Xd(s)>=Wn-Number.EPSILON?[-1,1]:(s=Ka(s),s[0]>=Math.PI?R.sub(R.cos(R.sub(s,[Math.PI,Math.PI]))):s[1]<=Math.PI?W(Math.cos(s[1]),Math.cos(s[0])):s[1]<=Wn?W(-1,Math.max(Math.cos(s[1]),Math.cos(s[0]))):W(-1,1)),tan:s=>Xe(s)||Wa(s)?We:(s=Ka(s,Math.PI),s[0]>=Me&&(s=R.sub(s,[Math.PI,Math.PI])),s[0]<=-Me||s[1]>=Me?ja:W(Math.tan(s[0]),Math.tan(s[1]))),sec:s=>R.div([1,1],R.cos(s)),csc:s=>R.div([1,1],R.sin(s)),cot:s=>R.div([1,1],R.tan(s)),cosec:s=>R.csc(s),cotan:s=>R.cot(s),arcsin:s=>Xe(s)||s[1]<-1||s[0]>1?We:W(s[0]<=-1?-Me:Math.asin(s[0]),s[1]>=1?Me:Math.asin(s[1])),arccos:s=>Xe(s)||s[1]<-1||s[0]>1?We:W(s[1]>=1?0:Math.acos(s[1]),s[0]<=-1?Math.PI:Math.acos(s[0])),arctan:s=>W(Math.atan(s[0]),Math.atan(s[1])),sinh:s=>W(Math.sinh(s[0]),Math.sinh(s[1])),cosh:s=>s[1]<0?W(Math.cosh(s[1]),Math.cosh(s[0])):s[0]>0?W(Math.cosh(s[0]),Math.cosh(s[1])):W(1,Math.cosh(Math.max(-s[0],s[1]))),tanh:s=>W(Math.tanh(s[0]),Math.tanh(s[1])),sech:s=>R.div([1,1],R.cosh(s)),csch:s=>R.div([1,1],R.sinh(s)),coth:s=>R.div([1,1],R.tanh(s)),cosech:s=>R.csch(s)},Ts=ct("+ \u2212 * \xD7 \xB7 / \xF7 // sup sub subsup"),Xa=ct("sub sup subsup"),Kn='<mo value="," lspace="0">,</mo>';function Ya(s,t){return Ts.includes(t)?s instanceof Ti?!0:!(s instanceof At)||!Ts.includes(s.fn)?!1:Xa.includes(s.fn)&&Xa.includes(t)?!0:Ts.indexOf(t)>Ts.indexOf(s.fn):!1}function Qd(s,t,e){return Ya(s,t)?`<mfenced>${e}</mfenced>`:e}function pe(s,t){return s instanceof Ti||s instanceof At?`<mrow>${t}</mrow>`:t}function Qa(s){return s==="2"?"squared":s==="3"?"cubed":`to the power of ${s}`}var At=class extends de{constructor(t,e=[]){super();this.fn=t,this.args=e}evaluate(t={}){let e=this.args.map(i=>i.evaluate(t));if(this.fn in t)return t[this.fn](...e);if(this.fn==="+")return se.add(...e);if(this.fn==="\u2212")return se.sub(...e);if(["*","\xB7","\xD7"].includes(this.fn))return se.mul(...e);if(this.fn==="/")return se.div(...e);if(this.fn==="sup")return se.sup(...e);if(xi(this.fn))return se[this.fn](...e);if(this.fn==="(")return e[0];throw z.undefinedFunction(this.fn)}interval(t={}){if(this.fn in t)return Ie(this.evaluate(t),2);let e=this.args.map(i=>i.interval(t));if(this.fn==="+")return R.add(...e);if(this.fn==="\u2212")return R.sub(...e);if(["*","\xB7","\xD7"].includes(this.fn))return R.mul(...e);if(this.fn==="/")return R.div(...e);if(this.fn==="sup")return R.sup(...e);if(xi(this.fn))return R[this.fn](...e);if(this.fn==="(")return e[0];throw z.undefinedFunction(this.fn)}substitute(t={}){return new At(this.fn,this.args.map(e=>e.substitute(t)))}collapse(){return this.fn==="("?this.args[0].collapse():new At(this.fn,this.args.map(t=>t.collapse()))}get simplified(){return this}get variables(){return Et(Ft(this.args.map(t=>t.variables)))}get functions(){return Et([this.fn,...Ft(this.args.map(t=>t.functions))])}toString(){let t=this.args.map(e=>Ya(e,this.fn)?"("+e.toString()+")":e.toString());return this.fn==="\u2212"?t.length>1?t.join(" \u2212 "):"\u2212"+t[0]:this.fn==="sup"?t.join("^"):this.fn==="sub"?t.join("_"):this.fn==="subsup"?`${t[0]}_${t[1]}^${t[2]}`:ct("+ * \xD7 \xB7 / = < > \u2264 \u2265 \u2248").includes(this.fn)?t.join(" "+this.fn+" "):D(this.fn,"(","[","{")?this.fn+this.args.join(", ")+Fn[this.fn]:this.fn==="abs"?`|${this.args.join(", ")}|`:D(this.fn,"!","%")?t[0]+this.fn:`${this.fn}(${t.join(", ")})`}toMathML(t={}){let e=this.args.map(o=>o.toMathML(t)),i=this.args.map((o,r)=>Qd(o,this.fn,e[r]));if(this.fn in t){let o=e.map((r,a)=>({toString:()=>r,val:this.args[a]}));return t[this.fn](...o)}if(this.fn==="\u2212")return i.length>1?i.join('<mo value="\u2212">\u2212</mo>'):'<mo rspace="0" value="\u2212">\u2212</mo>'+i[0];if(D(this.fn,"+","=","<",">","\u2264","\u2265","\u2248")){let o=Za(this.fn);return i.join(`<mo value="${o}">${o}</mo>`)}if(D(this.fn,"*","\xD7","\xB7")){let o=i[0];for(let r=1;r<i.length-1;++r)o+=(this.args[0]instanceof $i&&this.args[1]instanceof $i?'<mo value="\xD7">\xD7</mo>':"")+i[1];return o}if(this.fn==="//")return i.join('<mo value="/">/</mo>');if(this.fn==="sqrt")return`<msqrt>${i[0]}</msqrt>`;if(D(this.fn,"/","root")){let o=this.fn==="/"?"mfrac":"mroot",r=this.args.map((a,l)=>pe(a,e[l]));return`<${o}>${r.join("")}</${o}>`}if(D(this.fn,"sup","sub")){let o=[pe(this.args[0],i[0]),pe(this.args[1],e[1])];return`<m${this.fn}>${o.join("")}</m${this.fn}>`}return this.fn==="subsup"?`<msubsup>${[pe(this.args[0],i[0]),pe(this.args[1],e[1]),pe(this.args[2],e[2])].join("")}</msubsup>`:D(this.fn,"(","[","{")?`<mfenced open="${this.fn}" close="${Fn[this.fn]}">${i.join(Kn)}</mfenced>`:D(this.fn,"!","%")?i[0]+`<mo value="${this.fn}" lspace="0">${this.fn}</mo>`:this.fn==="abs"?`<mfenced open="|" close="|">${i.join(Kn)}</mfenced>`:this.fn==="bar"?`<mover>${pe(this.args[0],i[0])}<mo value="\u203E">\u203E</mo></mover>`:this.fn==="vec"?`<mover>${pe(this.args[0],i[0])}<mo value="\u2192">\u2192</mo></mover>`:`<mi${xi(this.fn)?' mathvariant="normal"':""}>${this.fn}</mi><mfenced>${i.join(Kn)}</mfenced>`}toVoice(t={}){let e=this.args.map(n=>n.toVoice(t)),i=e.join(" ");if(this.fn in t){let n=e.map((o,r)=>({toString:()=>o,val:this.args[r]}));return t[this.fn](...n)}return D(this.fn,"(","[","{")?i:this.fn==="sqrt"?`square root of ${i}`:this.fn==="%"?`${i} percent`:this.fn==="!"?`${i} factorial`:this.fn==="/"?`${e[0]} over ${e[1]}`:this.fn==="//"?`${e[0]} divided by ${e[1]}`:this.fn==="sub"?i:this.fn==="subsup"?`${e[0]} ${e[1]} ${Qa(e[2])}`:this.fn==="sup"?`${e[0]} ${Qa(e[1])}`:je[this.fn]?e.join(` ${je[this.fn]} `):xi(this.fn)?`${this.fn} ${i}`:`${this.fn} of ${i}`}},Ti=class extends de{constructor(t){super();this.items=t}evaluate(t={}){return this.collapse().evaluate(t)}substitute(t={}){return this.collapse().substitute(t)}get simplified(){return this.collapse().simplified}get variables(){return Et(Hi(...this.items.map(t=>t.variables)))}get functions(){return this.collapse().functions}toString(){return this.items.map(t=>t.toString()).join(" ")}toMathML(t={}){return this.items.map(e=>e.toMathML(t)).join("")}toVoice(t={}){return this.items.map(e=>e.toVoice(t)).join(" ")}collapse(){return Jd(this.items).collapse()}},K;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.SPACE=1]="SPACE",s[s.STR=2]="STR",s[s.NUM=3]="NUM",s[s.VAR=4]="VAR",s[s.OP=5]="OP"})(K||(K={}));function Xn(s,t){if(t===K.STR)return new Fa(s);if(!(!s||!t)){if(t===K.SPACE&&s.length>1)return new jn;if(t===K.NUM){if(isNaN(+s))throw z.invalidExpression();return new $i(+s)}if(t===K.VAR)return s in wi?new ws(wi[s]):s in Fe?new Yt(Fe[s]):new ws(s);if(t===K.OP)return s in Fe?new Yt(Fe[s]):new Yt(s)}}function tp(s){let t=[],e="",i=K.UNKNOWN;for(let o of s){if(o==='"'){let a=i===K.STR?K.UNKNOWN:K.STR,l=Xn(e,i);l&&t.push(l),e="",i=a;continue}else if(i===K.STR){e+=o;continue}let r=o.match(/[0-9.]/)?K.NUM:Ud.includes(o)?K.VAR:jd.includes(o)?K.OP:o.match(/\s/)?K.SPACE:K.UNKNOWN;if(!r)throw z.invalidCharacter(o);if(!i||i===K.NUM&&r!==K.NUM||i===K.VAR&&r!==K.VAR&&r!==K.NUM||i===K.OP&&!(e+o in Fe)||i===K.SPACE&&r!==K.SPACE){let a=Xn(e,i);a&&t.push(a),e="",i=r}e+=o}let n=Xn(e,i);return n&&t.push(n),t}function ep(s){return s.length>1?new Ti(s):s[0]instanceof Yt?new Ti(s):s[0]}function ip(s,t){let e=[[]];for(let i of s)t(i)?e.push([]):L(e).push(i);return e}function xt(s,t){return s instanceof Yt&&ct(t).includes(s.o)}function Si(s){return s instanceof At&&s.fn==="("?s.args[0]:s}function Mi(s,t){if(xt(s[0],t))throw z.startOperator(s[0]);if(xt(L(s),t))throw z.endOperator(L(s));for(let e=1;e<s.length-1;++e){if(!xt(s[e],t))continue;let i=s[e],n=s[e-1],o=s[e+1];if(n instanceof Yt)throw z.consecutiveOperators(n.o,i.o);if(o instanceof Yt)throw z.consecutiveOperators(i.o,o.o);let r=s[e+2];if(t==="^ _"&&xt(i,"_ ^")&&xt(r,"_ ^")&&i.o!==r.o){let a=s[e+3];if(a instanceof Yt)throw z.consecutiveOperators(r.o,a.o);let l=[Si(n),Si(o),Si(a)];i.o==="^"&&([l[1],l[2]]=[l[2],l[1]]),s.splice(e-1,5,new At("subsup",l)),e-=4}else{let a=Wd[i.o]||i.o,l=[Si(n),Si(o)];s.splice(e-1,3,new At(a,l)),e-=2}}}function Ja(s){return Mi(s,"^ _"),Mi(s,"/"),ep(s)}function sp(s,t){let e=[[]],i=["\u03C0",...(t==null?void 0:t.variables)||[]];for(let n of s){let o=L(e).length?L(e)[0].o:void 0;if(xt(n,") ] }")){if(!xt(n,Fn[o]))throw z.conflictingBrackets(n.o);let r=e.pop(),a=L(e),l=L(a),p=xt(n,")")&&l instanceof ws&&!i.includes(l.i)?a.pop().i:r[0].o,g=ip(r.slice(1),y=>xt(y,","));a.push(new At(p,g.map(Ja)))}else xt(n,"( [ {")?e.push([n]):L(e).push(n)}if(e.length>1)throw z.unclosedBracket(L(e)[0].o);return Ja(e[0])}function tl(s,t,e=!1){let i=[],n=[],o=!1;function r(){if(o)throw z.invalidExpression();!n.length||(i.push(n.length>1?new At(t[0],n):n[0]),n=[])}for(let a of s)if(xt(a,t)){if(o||!n.length)throw z.invalidExpression();o=!0}else if(a instanceof Yt)r(),i.push(a),o=!1;else{let l=!e||a instanceof $i;if(n.length&&!o&&l)throw z.invalidExpression();n.push(a),o=!1}return r(),i}function Jd(s){if(s=s.filter(t=>!(t instanceof jn)),!s.length)throw z.invalidExpression();if(xt(s[0],"%!"))throw z.startOperator(s[0]);for(let t=0;t<s.length;++t)!xt(s[t],"%!")||(s.splice(t-1,2,new At(s[t].o,[s[t-1]])),t-=1);if(Mi(s,"// \xF7"),s=tl(s,"\xD7 * \xB7",!0),xt(s[0],"\u2212 \xB1")&&s.splice(0,2,new At(s[0].o,[s[1]])),Mi(s,"\u2212 \xB1"),xt(s[0],"+")&&(s=s.slice(1)),s=tl(s,"+"),Mi(s,"= < > \u2264 \u2265"),s.length>1)throw z.invalidExpression();return s[0]}function np(s,t=!1,e){let i=sp(tp(s),e);return t?i.collapse():i}function op(s,t){try{let e=Et([...s.variables,...t.variables]),i=s.collapse(),n=t.collapse(),o=0;for(let r=0;r<5;++r){let a={};for(let p of e)a[p]=bs[p]||Math.random()*5;let l=i.evaluate(a),h=n.evaluate(a);if(!(isNaN(l)||isNaN(h))){if(!A(l,h))return!1;o+=1}}return!!o}catch(e){return!1}}var Pi={numEquals:op,parse:_i(np)};var el='<h3>Coordinate System</h3><label class="row"><div class="label">X Step:</div><input class="input-field" type="number" :bind="xStep" min="0"></label><label class="row"><div class="label">Y Step:</div><input class="input-field" type="number" :bind="yStep" min="0"></label>';var dt=50,Yn=class extends S{constructor(t,e,i){super(e,i);this.type="axes";this.canRotate=!1;this.canDragToSelect=!1;this.functions=[];this.$fill=d("path",{fill:"transparent"},this.$el),this.$grid=d("path",{class:"axis-gridlines"},this.$el),this.$axes=d("path",{class:"grid-axis"},this.$el),this.$functions=d("g",{},this.$el),this.$labels=d("g",{class:"axis-labels"},this.$el),this.setColour(u.darkGrey),e.options.watch(x=>this.$grid.toggle(x.grid==="none"));let[n,o,r,a,l,h]=t.split(":").map(x=>+x),p={xMin:n,xMax:r,xStep:o,yMin:a,yMax:h,yStep:l},g=this.model=e.bindSettingsPanel(this,el,p);this.$handles=[this.makeHandle("c",x=>g.xMin=E(Math.round(x.x/dt),-20,0)),this.makeHandle("c",x=>g.xMax=E(Math.round(x.x/dt),0,20)),this.makeHandle("c",x=>g.yMin=E(Math.round(-x.y/dt),-20,0)),this.makeHandle("c",x=>g.yMax=E(Math.round(-x.y/dt),0,20))];for(let x of[2,3])this.$handles[x].css("cursor","ns-resize");let y=!0;g.watch(()=>{this.setSizes(g,y),y=!1})}setSizes({xMin:t,xMax:e,yMin:i,yMax:n,xStep:o,yStep:r},a=!1){let l=`${t}:${o}:${e}:${i}:${r}:${n}`;if(l===this.options)return;this.options=l;let h=dt;this.$handles[0].setCenter({x:t*h,y:0}),this.$handles[1].setCenter({x:e*h,y:0}),this.$handles[2].setCenter({x:0,y:-i*h}),this.$handles[3].setCenter({x:0,y:-n*h}),this.$labels.removeChildren();let p="",g=`M${t*h} 0L${e*h} 0M0 ${-i*h}L0 ${-n*h}`;g+=`M0 ${-n*h-3}l5 8h-10ZM${e*h+3} 0l-8 5v-10Z`;for(let y=t+1;y<e;++y)!y||(g+=`M${y*h} 0L${y*h} 5`,p+=`M${y*h} ${-i*h}L${y*h} ${-n*h}`,d("text",{text:Lt(y*o,4),x:y*h,y:21,"text-anchor":"middle"},this.$labels));for(let y=i+1;y<n;++y)!y||(g+=`M0 ${-y*h}L-5 ${-y*h}`,p+=`M${t*h} ${-y*h}L${e*h} ${-y*h}`,d("text",{text:Lt(y*r,4),x:-10,y:-y*h+5,"text-anchor":"end"},this.$labels));this.$axes.setAttr("d",g),this.$grid.setAttr("d",p),this.path=zn(-n*dt,e*dt,-i*dt,t*dt,15),this.$fill.draw(this.path);for(let y of this.functions)this.drawFunctions(y);this.transform(),this.$parent.selection.update(),a||this.$parent.change({tilesChanged:[this]})}addFunction(t){this.functions.push(Pi.parse(t))}drawFunctions(t){let{xMin:e,xMax:i,yMin:n,yMax:o,xStep:r,yStep:a}=this.model,l=t.variables[0]||"x",h="",p=!1;for(let g=e;g<i;g+=.05){let y=g*dt,x=t.evaluate({[l]:g*r})/a*dt,G=ot(x,n*dt-.01,o*dt+.01);G&&(h+=(p?"L":"M")+`${y},${-x}`),p=G}d("path",{d:h,class:"geo-path",style:"color:red"},this.$labels)}getSnapPoints(){let{xMin:t,xMax:e,yMin:i,yMax:n}=this.model,o=[];for(let r=t;r<=e;++r)for(let a=i;a<=n;++a)o.push(new c(r*dt,-a*dt));return o}getSnapLines(){let{xMin:t,xMax:e,yMin:i,yMax:n}=this.model;return[new H(new c(t*dt,0),new c(e*dt,0)),new H(new c(0,-i*dt),new c(0,-n*dt))]}setColour(t){super.setColour(t);for(let e of[this.$axes,this.$labels])e.setAttr("fill",O(t));for(let e of[this.$axes,this.$grid])e.setAttr("stroke",O(t))}static makeThumbnail(t,e){let i=d("svg",{width:180,height:180},e);d("path",{d:"M30 10v160M60 10v160M120 10v160M150 10v160M10 30h160M10 60h160M10 120h160M10 150h160",class:"axis-gridlines",stroke:"white"},i),d("path",{d:"M10 90h160M90 10v160M90 8l4 6h-8ZM172 90l-6 4v-8Z",class:"grid-axis",fill:"white"},i)}};var rp=2*Math.PI,Qn=class{constructor(){this.translation=new ue(0,0,0);this.rotation=new ue(0,0,0);this.scale=new ue(1,1,1)}},ue=class{constructor(t,e,i){this.x=t;this.y=e;this.z=i}rotate(t){this.rotateProperty(t.z,"x","y"),this.rotateProperty(t.y,"x","z"),this.rotateProperty(t.x,"y","z")}rotateProperty(t,e,i){if(!t||A(t%rp,0))return;let n=Math.cos(t),o=Math.sin(t),r=this[e],a=this[i];this[e]=r*n-a*o,this[i]=a*n+r*o}equals(t){return A(this.x,t.x)&&A(this.y,t.y)&&A(this.z,t.z)}add(t){return this.x+=t.x||0,this.y+=t.y||0,this.z+=t.z||0,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}transform(t){return this.multiply(t.scale),this.rotate(t.rotation),this.add(t.translation),this}lerp(t,e){return new ue(gt(this.x,t.x||0,e),gt(this.y,t.y||0,e),gt(this.z,t.z||0,e))}};var ap=new V(0,0,0);function lp(s){let t=s.r,e=s.c.x,i=s.c.y,n=.5523*t;return`M${e} ${i-t}C${e+n} ${i-t} ${e+t} ${i-n} ${e+t} ${i}C${e+t} ${i+n} ${e+n} ${i+t} ${e} ${i+t}C${e-n} ${i+t} ${e-t} ${i+n} ${e-t} ${i}C${e-t} ${i-n} ${e-n} ${i-t} ${e} ${i-t}`}var Jn=class{constructor(){this.transform=new Qn;this.visible=!0}},Pe=class extends Jn{constructor(t,e={},i){super();this.children=[];this.sorting=!1;this.$el=d("g",e,i);for(let n of t)this.addChild(n)}addChild(t){t.parent&&t.parent.removeChild(t),this.children.push(t),this.$el&&t.$el&&this.$el.append(t.$el),t.parent=this}removeChild(t){let e=this.children.indexOf(t);e>=0&&this.children.splice(e,1),t.$el&&t.$el.remove(),t.parent=void 0}render(){if(!!this.visible){if(this.sorting)for(let t of Bi(this.children,e=>e.zIndex))this.$el.append(t.$el);for(let t of this.children)t.render()}}get zIndex(){return pr(this.children.map(t=>t.zIndex))}},Ss=class extends Jn{constructor(t,e={}){super();this.path=t;this.backface=!0;this.perspective=120;this.commands=Js(t),this.$el=d("path",e)}getTransformed(t,e=0,i=!1){let n=new ue(t.x,t.y,e),o=this;do i?n.rotate(o.transform.rotation):n.transform(o.transform);while(o=o.parent);return n}project(t){let e=Math.exp(t.z/this.perspective);return t.x*e+","+t.y*e}render(){if(!this.visible)return;if(!this.backface){let e=this.getTransformed(T,1).z>this.zIndex;if(this.$el.toggle(e),!e)return}if(this.color){let e=this.getTransformed(T,1,!0).z,i=V.mix(this.color,ap,(e+1)/2);this.$el.setAttr("fill",i),this.$el.setAttr("stroke",i)}let t=this.commands.map(e=>e.type+e.points.map(i=>this.project(this.getTransformed(i))).join(",")).join("");this.$el.setAttr("d",t)}get zIndex(){return this.getTransformed(T).z}},Ye=class extends Ss{constructor(t,e={}){super(rt(t)?lp(t):le(t),e)}};var Vt=19,to=[[],[[0,0]],[[-.9,-.9],[.9,.9]],[[-1,-1],[0,0],[1,1]],[[-.9,-.9],[.9,-.9],[.9,.9],[-.9,.9]],[[-1,-1],[1,-1],[1,1],[-1,1],[0,0]],[[-.9,-1.1],[-.9,0],[-.9,1.1],[.9,-1.1],[.9,0],[.9,1.1]],[[0,-1.2],[0,0],[0,1.2],[1,-.6],[1,.6],[-1,-.6],[-1,.6]],[[0,-1.1],[0,1.1],[-1.1,-1.1],[-1.1,0],[-1.1,1.1],[1.1,-1.1],[1.1,0],[1.1,1.1]],[[0,-1.1],[0,0],[0,1.1],[-1.1,-1.1],[-1.1,0],[-1.1,1.1],[1.1,-1.1],[1.1,0],[1.1,1.1]]],cp=new $(new c(-Vt,-Vt),2*Vt,2*Vt),ki=[[0,0],[0,-Math.PI/2],[Math.PI/2,0],[-Math.PI/2,0],[0,Math.PI/2],[Math.PI,0]],eo=["#656073",u.teal,u.blue,u.purple,u.red,u.orange,u.yellow,u.lime,u.green,u.teal],io=class extends S{constructor(t,e,i){super(e,i);this.type="dice";this.isAnimating=!1;this.options=t;let[n,o]=t.split(":");this.faces=o||"1,2,3,4,5,6";let r=this.faces.split(",").map(a=>{let l=new Ye(cp,{class:"dice-face",fill:eo[+a],stroke:eo[+a]}),h=to[+a].map(p=>new Ye(new _(new c(p[0]*Vt/2,p[1]*Vt/2),4),{class:"dice-dot"}));for(let p of h)p.transform.translation.z=2;return new Pe([l,...h])});r[0].transform.translation.z=Vt,r[1].transform.translation.x=-Vt,r[1].transform.rotation.y=Math.PI/2,r[2].transform.translation.y=Vt,r[2].transform.rotation.x=-Math.PI/2,r[3].transform.translation.y=-Vt,r[3].transform.rotation.x=Math.PI/2,r[4].transform.translation.x=Vt,r[4].transform.rotation.y=-Math.PI/2,r[5].transform.translation.z=-Vt,r[5].transform.rotation.y=Math.PI,this.die=new Pe(r,{},this.$el),this.die.sorting=!0,this.setValue(+n||Mt.integer(1,6)),this.path=new $(new c(-25,-25),50,50),this.$outline=d("path",{class:"outline",path:this.path},this.$el)}setColour(t){this.colour=t==="#000"||t==="#000000"?"":t;for(let e of this.die.children)e.children[0].color=O(this.colour);this.die.render()}setValue(t){this.value!==t&&(this.value=t,this.options=`${t}:${this.faces}`,this.die.transform.rotation.x=ki[t-1][0],this.die.transform.rotation.y=ki[t-1][1],this.die.render())}roll(t=2e3){return M(this,null,function*(){if(this.isAnimating)return;this.isAnimating=!0;let e=Mt.integer(1,6),i=ki[this.value-1],n=4*Math.PI+ki[e-1][0]-i[0],o=4*Math.PI+ki[e-1][1]-i[1];yield X(r=>{let a=tt("sine",r);this.die.transform.translation.z=4*a*(1-a)*Vt,this.die.transform.rotation.x=i[0]+a*n,this.die.transform.rotation.y=i[1]+a*o,this.die.render()},t).promise,this.setValue(e),this.isAnimating=!1})}static makeThumbnail(t,e){if(e.data.thumb==="net"){let i=d("svg",{width:58,height:76},e),n=t.split(":")[1].split(",").map(a=>+a),o=e.data.colour,r=[new c(20,2),new c(20,20),new c(20,38),new c(20,56),new c(2,20),new c(38,20)];for(let[a,l]of r.entries()){let h=o||eo[+n[a]];d("path",{path:new $(l,18,18),class:"polygon-tile",fill:h},i);for(let p of to[n[a]])d("circle",{cx:l.x+9+p[0]*4.5,cy:l.y+9+p[1]*4.5,r:1.8,class:"dice-dot"},i)}}else{let i=d("svg",{width:60,height:60},e);d("rect",{x:6,y:6,width:48,height:48,rx:4,class:"polygon-tile",fill:u.orange},i);for(let n of to[5])d("circle",{cx:30+n[0]*12,cy:30+n[1]*12,r:4,class:"dice-dot"},i)}}static action(t,e){return M(this,null,function*(){if(t==="roll"){let i=Array.from(e);e[0].$parent.selection.clear(),yield Promise.all(i.map(n=>n.roll())),e[0].$parent.selection.select(i),e[0].$parent.change({tilesChanged:e})}})}};var hp="M0 7.4L8.6 12L7 2.4L13.9 -4.4L4.3 -5.8L0 -14.5L-4.3 -5.8L-13.9 -4.4L-7 2.4L-8.6 12L0 7.4",il="M12.9,9.7C13.9,3,4,5.3,4,1.2H4C9.4-3.7,7.6-14,.1-14.3S-9.3-3.9-4,1.3c-.1,3.8-9.8,1.9-8.9,8.4h0C-5.5,13.2,5.2,13.2,12.9,9.7Z",sl=23,dp=[u.red,u.blue],pp=[hp,il],so=class extends S{constructor(t,e,i){super(e,i);this.type="coin";this.isAnimating=!1;let n=new _(T,sl),o=dp.map((r,a)=>{let l=new Ye(n,{class:"dice-face",fill:r,stroke:r}),h=new Ss(pp[a],{class:"dice-dot"});return h.transform.translation.z=1,new Pe([l,h])});o[0].transform.translation.z=.5,o[1].transform.rotation.x=Math.PI,o[1].transform.translation.z=-.5,this.coin=new Pe(o,{},this.$el),this.coin.sorting=!0,this.setValue(t?+t:Mt.integer(0,1)),this.path=new _(T,25),this.$outline=d("path",{class:"outline",path:this.path},this.$el)}setValue(t){this.value!==t&&(this.value=t,this.options=""+t,this.coin.transform.rotation.x=t?Math.PI:0,this.coin.render())}setColour(t){this.colour=t}roll(t=2e3){return M(this,null,function*(){if(this.isAnimating)return;this.isAnimating=!0;let e=Mt.integer(0,1),i=this.value?Math.PI:0,n=6*Math.PI+(e?Math.PI:0)-i;yield X(o=>{let r=tt("sine",o);this.coin.transform.translation.z=4*r*(1-r)*sl,this.coin.transform.rotation.x=i+r*n,this.coin.transform.rotation.y=.4*Math.sin(r*8*Math.PI),this.coin.render()},t).promise,this.setValue(e),this.isAnimating=!1})}static makeThumbnail(t,e){let i=d("svg",{width:60,height:60},e);d("circle",{cx:30,cy:30,r:28,class:"polygon-tile",fill:u.blue},i),d("path",{d:il,class:"dice-dot"},i).setTransform({x:30,y:30},0,1.2)}};var no=75,Ci=2*Math.PI,Ai=Math.PI/2,Ms="M9.8-39.1,0-63-9.8-39.1-3-43V60a2.9,2.9,0,0,0,3,3,2.9,2.9,0,0,0,3-3V-43Z";function Vi(s,t,e,i=no,n=T){let o=e?V.shades(e,t.length):V.rainbow(t.length);s.removeChildren();for(let[r,a]of t.entries()){let l=t[r+1]?t[r+1]-a:Ci-a+t[0],h=new re(n,c.fromPolar(a-Ai,i).add(n),l),p=o[r];d("path",{path:h,class:"polygon-tile",fill:p},s)}}var Ei=class extends S{constructor(t,e,i){super(e,i);this.type="spinner";this.angle=0;this.isAnimating=!1;this.path=new _(T,no),this.$sectors=d("g",{},this.$el),this.$arrow=d("path",{d:Ms,class:"spinner"},this.$el),this.$outline=d("path",{class:"outline",path:this.path},this.$el),this.setupHandles(),d("circle",{r:4,class:"spinner"},this.$el),e.events.listen(this.$arrow,{move:({posn:r})=>{let a=this.relativePosn(r).angle()+Ai;this.$arrow.setTransform(void 0,a)},end:({lastPosn:r})=>{let a=this.relativePosn(r).angle()+Ai;this.setValue(a*kt)},click:()=>this.roll()}),this.$arrow.css("cursor","pointer");let[n,o]=t.split(":");this.drawSectors(+o),this.setValue(+n||0)}setupHandles(){this.$handle=this.makeHandle("c",t=>{let e=(t.angle()+Ai)%Ci;this.drawSectors(Ci/e)}),this.$handle.css("cursor","move")}drawSectors(t){let e=E(Math.round(t),2,16);if(e===this.sectors)return;this.sectors=e,this.options=`${this.angle}:${e}`;let i=Ci/e;Vi(this.$sectors,N(n=>i*n,e),this.colour),this.$handle.setCenter(c.fromPolar(i-Ai,no))}setColour(t){this.colour=t;let e=this.$sectors.children,i=V.shades(t,e.length);for(let[n,o]of e.entries())o.setAttr("fill",i[n])}setValue(t){t=Tt(Math.round(t),360),this.angle!==t&&(this.angle=t,this.options=`${t}:${this.sectors}`,this.$arrow.setTransform(void 0,this.angle*nt))}roll(t=2e3){return M(this,null,function*(){if(this.isAnimating)return;this.isAnimating=!0;let e=this.angle,i=(4+Math.random())*360;yield X(n=>{let o=gt(e,i,tt("sine",n));this.$arrow.setTransform(void 0,o*nt)},t).promise,this.setValue(i),this.isAnimating=!1})}static makeThumbnail(t,e){let i=d("svg",{width:80,height:80},e),n=new c(40,40);Vi(i,N(r=>Ci/5*r,5),"",36,n),d("path",{d:Ms,class:"spinner"},i).setTransform(n,-.8,.5)}};var up=2*Math.PI,oo=Math.PI/2,ro=75,ao=class extends Ei{constructor(t,e,i){super(`${t.split(":")[0]}:1`,e,i);this.type="custom-spinner";this.$handles=[];for(let n of t.split(":")[1].split(","))this.makeVertex(c.fromPolar(+n*nt-oo,ro))}setupHandles(){let t;this.$parent.events.listen(this.$outline,{down:({posn:e})=>t=this.makeVertex(this.relativePosn(e)),move:({posn:e})=>this.moveVertex(this.relativePosn(e),t),end:()=>this.$parent.change({tilesChanged:[this]})}),this.$outline.css("cursor","crosshair")}drawSectors(){if(!this.$handles||this.$handles.length<2)return;let t=this.$handles.map(i=>(i.center.angle()+oo)%up).sort();this.sectors=t.map(i=>Math.round(i*kt)).join(",");let e=`${this.angle}:${this.sectors}`;e!==this.options&&(this.options=e,Vi(this.$sectors,t,this.colour))}makeVertex(t){if(this.$handles.length>=24)return;let e=this.makeHandle("c",i=>{!e||(i.length>2*ro?(this.deleteVertex(e),e=void 0):this.moveVertex(i,e))},()=>{e&&this.deleteVertex(e)});return e.setAttr("r",8),e.css("cursor","move"),this.$handles.push(e),this.moveVertex(t,e),e}deleteVertex(t){this.$handles.length<=2||(t.remove(),this.$handles.splice(this.$handles.indexOf(t),1),this.drawSectors())}moveVertex(t,e){if(!e)return;let i=pt(t.angle()*kt,10)*nt;e.setCenter(c.fromPolar(i,ro)),this.drawSectors()}static makeThumbnail(t,e){let i=d("svg",{width:80,height:80},e),n=new c(40,40),o=t.split(":")[1].split(",").map(a=>+a*nt);Vi(i,o,"",36,n),d("path",{d:Ms,class:"spinner"},i).setTransform(n,.4,.5);for(let a of o){let l=c.fromPolar(a-oo,36).add(n);d("circle",{cx:l.x,cy:l.y,r:3,fill:"white"},i)}}};var fp=Ko(["#cd0e66","#0f82f2","#22ab24","#fd8c00"]),nl=class{constructor(t){this.index=t;this.color=fp();this.tilt=Math.floor(Math.random()*10)-10;this.tiltAngleIncrement=Math.random()*.07+.05;this.tiltAngle=0;this.x=Math.random()*w.width;this.y=(Math.random()-1)*w.height;this.r=Mt.uniform(10,30)}draw(t){t.beginPath(),t.lineWidth=this.r/2,t.strokeStyle=this.color,t.moveTo(this.x+this.tilt+this.r/4,this.y),t.lineTo(this.x+this.tilt,this.y+this.tilt+this.r/4),t.stroke()}update(t,e){this.tiltAngle+=this.tiltAngleIncrement,this.y+=(Math.cos(t)+3+this.r/2)/2,this.x+=Math.sin(t),this.tilt=Math.sin(this.tiltAngle-this.index/3)*15,this.x<-20?(this.x=-20,this.y=Math.random()*w.height,this.tilt=Math.floor(Math.random()*10)-20):this.x>w.width+20?(this.x=w.width+20,this.y=Math.random()*w.height,this.tilt=Math.floor(Math.random()*10)-20):e&&this.y>w.height&&(this.x=Math.random()*w.width,this.y=-10,this.tilt=Math.floor(Math.random()*10)-20)}},mp="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999",ke;function lo(s=2e3,t=150){ke||(ke=d("canvas",{style:mp},U)),ke.setAttr("width",w.width),ke.setAttr("height",w.height),ke.show();let e=ke.ctx,i=N(o=>new nl(o),t),n=X(o=>{e.clearRect(0,0,w.width,w.height);let r=o<s,a=0;for(let l of i)l.draw(e),l.update(o,r),l.y<w.height&&(a+=1);a||(n.cancel(),ke.hide())})}var Ps=class extends te{constructor(t,e={}){super();this.$el=t;this.startPos=new c(0,0);this.position=new c(0,0);this.disabled=!1;this.options=Ni(e,{moveX:!0,moveY:!0,withinBounds:!0}),w.onResize(()=>this.updateBounds()),$r(t,{start:()=>{this.disabled||(this.startPos=this.position,this.trigger("start"),Bt.addClass("grabbing"))},move:(i,n)=>{this.disabled||(this.setPosition(this.startPos.x+i.x-n.x,this.startPos.y+i.y-n.y),this.trigger("drag",{posn:this.position,pointerPosn:i}),this.checkTarget(i))},end:(i,n)=>{this.disabled||(this.trigger(i.equals(n)?"click":"end",{$target:this.$over}),this.options.$targets&&!this.$over&&this.options.resetOnMiss&&this.resetPosition(),this.$over=void 0,Bt.removeClass("grabbing"))},click:()=>this.trigger("click"),accessible:!0})}addTarget(t){var e;this.options.$targets||(this.options.$targets=[]),(e=this.options.$targets)==null||e.push(t)}removeTarget(t){var e,i;this.options.$targets=(e=this.options.$targets)==null?void 0:e.filter(n=>n!=t),((i=this.options.$targets)==null?void 0:i.length)||(this.options.$targets=void 0)}checkTarget(t){if(!this.options.$targets)return;let e=this.options.$targets.find(i=>i.boundsRect.contains(t));e!==this.$over&&(this.$over&&this.trigger("exit-target",{$target:this.$over}),e&&this.trigger("enter-target",{$target:e}),this.$over=e)}updateBounds(){if(!this.options.withinBounds)return this.bounds=void 0;if(this.options.bounds)return this.bounds=this.options.bounds;let t=this.bounds,e=this.options.$parent||this.$el.parent,i=e.type==="svg"?e.svgWidth:e.width,n=e.type==="svg"?e.svgHeight:e.height;this.bounds=new vt(0,i,0,n),!i&&!n&&setTimeout(()=>this.updateBounds()),t&&this.setPosition(this.position.x*this.bounds.dx/t.dx||0,this.position.y*this.bounds.dy/t.dy||0)}setPosition(t,e){var n;let i=new c(this.options.moveX?t:0,this.options.moveY?e:0);this.bounds&&(i=i.clamp(this.bounds,(n=this.options.margin)!=null?n:0)),i=i.round(this.options.snap||1),this.options.round&&(i=this.options.round(i)),!i.equals(this.position)&&(this.position=i,this.options.useTransform?this.$el.translate(i.x,i.y):(this.options.moveX&&this.$el.css("left",i.x+"px"),this.options.moveY&&this.$el.css("top",i.y+"px")),this.trigger("move",{posn:i}))}resetPosition(t=250){return M(this,null,function*(){let e=this.position;this.$el.css({"pointer-events":"none"}),yield X(i=>{let n=c.interpolate(e,this.startPos,i);this.setPosition(n.x,n.y)},t).promise,this.$el.css({"pointer-events":"initial"})})}};var gp="M7,4,2.3-.3,6.6-5a1.2,1.2,0,0,0,0-1.5l-.4-.3a1,1,0,0,0-1.4,0L0-2.5-4.8-6.8a1,1,0,0,0-1.4,0l-.4.3A1.2,1.2,0,0,0-6.6-5L-2.3-.3-7,4a1.1,1.1,0,0,0-.1,1.4l1.5,1.4a.9.9,0,0,0,1.3,0L0,2.1,4.3,6.8a.9.9,0,0,0,1.3,0L7.1,5.4A1.1,1.1,0,0,0,7,4Z",ol="M7.7-5.7l-.2-.4-.3-.2c-.1-.1-.3,0-.4,0A36.6,36.6,0,0,0-3,2.1,36.1,36.1,0,0,0-7.8-.8h-.5l-1,.9a.4.4,0,0,0-.1.3c0,.2,0,.3.1.4a72.1,72.1,0,0,1,6.6,7h.4l.4-.2C1.9,1,3.8-1.8,7.5-5.2,7.7-5.3,7.7-5.5,7.7-5.7Z",rl={fill:"none",style:"touch-action: none",stroke:u.green},al=class{constructor(t){this.$el=d("g",{});this.$ring=d("circle",Zt({opacity:.6},rl),this.$el);this.$burst=d("path",rl,this.$el);this.$mark=d("g",{class:"problem-marker"},this.$el);this.$circle=d("circle",{r:13},this.$mark);this.$cross=d("path",{d:gp,fill:"white"},this.$mark);this.$check=d("path",{d:ol,fill:"white"},this.$mark);this.isAnimating=!1;t.append(this.$el)}show(t=!1,e=!0){this.$cross.toggle(!t),this.$check.toggle(t),this.$circle.setAttr("fill",t?u.green:u.red),this.$mark.addClass("show"),e&&t&&this.burst()}hide(){this.$mark.removeClass("show")}burst(t=1e3,e=60,i=20){return M(this,null,function*(){this.isAnimating||(this.isAnimating=!0,yield X(n=>{let o=tt("sine-out",n);this.$ring.setAttr("r",.6*o*e),this.$ring.setAttr("stroke-width",.25*(1-o)*e);let r=tt("exp-out",n),a=(.4+.6*r)*e,l=(.1+.9*r)*e,h="";for(let p=0;p<i;++p){let g=Math.cos(Math.PI*2*p/i),y=Math.sin(Math.PI*2*p/i);h+=`M${g*l} ${y*l}L${g*a} ${y*a}`}this.$burst.setAttr("d",h)},t).promise,this.isAnimating=!1)})}},Li=class extends S{constructor(t,e,i){super(e,i);this.type="question-blank";this.size=100;this.canRotate=!1;this.keepOnTop=!0;this.solution="";this.submitted="";this.attempts=0;this.correct=!1;this.focussed=!1;this.colour=e.penColour,this.options=t||"Pw::0";let[n,o,r]=this.options.split(":");this.solution=atob(n),this.submitted=o,this.attempts=+r||0,this.$box=d("rect",{class:"problem-box",rx:6},this.$el),this.$text=d("text",{class:"problem-text",text:this.text,y:36},this.$el),this.mark=new al(this.$el),this.$input=d("input",{class:"problem-text"},e.$html),this.$input.onKeyDown("enter",()=>this.$input.blur()),this.$input.on("blur",()=>this.blur()),this.$parent.options.canEditQuestions?(this.$handle=this.makeHandle("c",a=>this.setSize(a.x)),this.$handle.css("cursor","ew-resize")):(this.$input.setInputPattern(this.solution),this.checkAnswer(!1),this.canMove=!1),this.setSize(100)}setSize(t){var e;super.setSize(pt(E(t,50,400),25)),this.path=new $(T,this.size,50),this.$input.css({width:this.size+"px",height:"50px"}),this.$box.setRect(this.path),this.$text.setAttr("x",this.size/2),this.mark.$el.setTransform({x:this.size,y:0}),(e=this.$handle)==null||e.setCenter({x:this.size,y:50}),this.transform()}delete(){super.delete(),this.$input.remove()}get text(){return(this.$parent.options.canEditQuestions?this.solution:this.submitted)||"?"}click(){this.focussed||this.$parent.events.shiftKey||this.correct&&!this.$parent.options.canEditQuestions||(this.focussed=!0,this.$parent.selection.add(this,!0),setTimeout(()=>{this.$el.removeClass("correct incorrect"),this.mark.hide()}),this.$input.css({top:this.posn.y+"px",left:this.posn.x+"px"}),this.$input.value=this.text,this.$text.hide(),this.$input.show(),this.$input.focus(),document.execCommand("selectAll",!1))}blur(){if(!this.focussed)return;this.focussed=!1,this.$input.hide(),this.$text.show();let t=this.text,e=this.$input.value.trim();this.$parent.options.canEditQuestions?(this.solution=e,this.options=`${btoa(e)}::0`):(e&&e!==this.submitted&&(this.attempts+=1),this.submitted=e==="?"?"":e,this.options=`${btoa(this.solution)}:${e}:${this.attempts}`,setTimeout(()=>{this.checkAnswer(),Li.gradeWorksheet(this.$parent)})),this.$text.text=this.text,this.text!==t&&this.$parent.change({tilesChanged:[this]})}isCorrect(){if(!this.submitted||!this.solution)return!1;if(this.submitted.toLowerCase()===this.solution.toLowerCase())return!0;let t=Bs(this.solution),e=Bs(this.submitted);return A(e,t)||Us(t)===this.submitted||this.solution===Us(e)}checkAnswer(t=!0){this.correct=this.isCorrect(),this.submitted&&this.mark.show(this.correct,t),this.$el.setClass("correct",this.correct),this.$el.setClass("incorrect",!!this.submitted&&!this.correct)}static gradeWorksheet(t){let e=[0,0,0,0];for(let i of t.tiles)i.type==="question-blank"&&(e[0]+=1,!!i.submitted&&(e[i.correct?i.attempts<=1?1:2:3]+=1));e[0]===e[1]+e[2]&&lo()}static makeThumbnail(t,e){let i=d("svg",{width:130,height:70},e);d("rect",{x:15,y:15,width:100,height:50,class:"problem-box",rx:6},i),d("text",{x:65,y:50,text:"?",class:"problem-text"},i),d("circle",{cx:115,cy:15,r:13,fill:u.blue},i),d("path",{d:ol,fill:"white",transform:"translate(115 15)"},i)}};var ll=_i(Ki),co=class extends S{constructor(t,e,i){super(e,i);this.type="image";this.path=new $(T,0,0);this.aspectRatio=1;this.options=t,this.$image=d("image",{href:t,crossorigin:"anonymous"},this.$el),this.$outline=d("path",{class:"outline"},this.$el),ll(t).then(n=>{this.aspectRatio=n.height/n.width,this.setSize(this.size||n.width)}),this.$handle=this.makeHandle("c",n=>this.setSize(n.x)),this.$handle.css("cursor","nwse-resize")}setHref(t){this.options=t,this.$image.setAttr("href",t),ll(t)}setSize(t){let e=Math.max(50,50*this.aspectRatio),i=Math.min(1e3,1e3/this.aspectRatio);this.size=E(t,e,i),this.$image.setAttr("width",this.size),this.$image.setAttr("height",this.aspectRatio*this.size),this.path=new $(T,this.size,this.aspectRatio*this.size),this.$outline.draw(this.path),this.$handle.setCenter({x:this.size,y:this.aspectRatio*this.size}),this.transform(),this.$parent.selection.update()}};var yp={bold:"font-weight",italic:"font-style",underline:"text-decoration",colour:"color"};function cl(s,t){return s.style.getPropertyValue(t)||""}function hl(s,t,e){s.style.setProperty(t,e)}function vp(s,t){t==="font-weight"||t==="font-style"?s.style.setProperty(t,"normal"):t==="text-decoration"?s.style.setProperty(t,"none"):s.style.removeProperty(t)}var ho=class extends S{constructor(t,e,i){super(e,i);this.type="text";this.size=0;this.keepOnTop=!0;this.focussed=!1;this.creating=!1;this.timeout=0;this.$box=d("rect",{fill:"transparent"},this.$el),this.$foreignObject=d("foreignObject",{x:this.posn.x,y:this.posn.y,width:1,height:1,overflow:"visible"},this.$el),this.$text=d("div",{class:"text-edit",style:"pointer-events: none",xmlns:"http://www.w3.org/1999/xhtml"},this.$foreignObject),this.$outline=d("path",{class:"outline"},this.$el),this.options=this.$text.html=t||"Text",this.setColour(e.penColour),this.updateOutline(),this.$text.on("pointerdown",n=>n.handled=!0),this.$text.onKeyDown("escape",n=>this.blur()),this.$text.on("blur",()=>this.blur())}setSize(t){super.setSize(E(t,-5,10)),this.$text.css("font-size",20*1.2**this.size+"px"),this.updateOutline()}setColour(t){if(this.focussed)return this.formatFont("color",t);this.colour=t,this.$text.css("color",O(this.colour))}getSnapPoints(){return[]}updateOutline(){let t=this.$text.width,e=this.$text.height;this.$foreignObject.setAttr("width",t||1),this.$foreignObject.setAttr("height",e||1),this.path=new $(T,t,e),this.$box.setRect(this.path),this.$outline.draw(this.path),this.transform()}selectAll(){let t=this.selection,e=document.createRange();e.selectNodeContents(this.$text._el),t==null||t.removeAllRanges(),t==null||t.addRange(e)}static action(t,e){return M(this,null,function*(){for(let i of Array.from(e))t==="smaller"||t==="larger"?i.setSize(t==="larger"?i.size+1:i.size-1):i.format(t);e[0].$parent.change({tilesChanged:Array.from(e)})})}format(t){this.formatFont(yp[t]||"",t),this.cleanupElements(this.$text._el.children),this.updateOutline(),this.options=this.$text.html}get selection(){var e,i;return(((i=(e=this.$el._el).getRootNode)==null?void 0:i.call(e))||document).getSelection()}formatFont(t,e){if(!this.focussed){let o=new Range,r=this.$text._el.childNodes;return o.setStartBefore(r[0]),o.setEndAfter(r[r.length-1]),this.formatRange(o,t,e)}let i=this.selection;if(!i)return;let n=[];for(let o=0;o<i.rangeCount;++o){let r=i.getRangeAt(o);this.formatRange(r,t,e),n.push(i.getRangeAt(o))}i.removeAllRanges();for(let o=0;o<n.length;++o)i.addRange(n[o])}formatRange(t,e,i){let n=t==null?void 0:t.extractContents().childNodes;if(!n)return;let o=t.commonAncestorContainer;(o==null?void 0:o.nodeName)==="#text"&&o.parentNode&&(o=o.parentNode),this.removeEmptyTextNodes(n),this.wrapChildrenInSpans(o,n,e),this.updateRangeChildren(n,e,i);for(let r=n.length-1;r>=0;--r)t.insertNode(n[r])}removeEmptyTextNodes(t){for(let e=0;e<t.length;e++){let i=t[e];i.nodeName==="#text"&&!i.nodeValue&&i.remove()}}wrapChildrenInSpans(t,e,i){for(let n=0;n<e.length;++n){let o=e[n];if(o.nodeName==="#text"){let r=document.createElement("span");t.nodeName==="SPAN"&&hl(r,i,cl(t,i)),r.appendChild(document.createTextNode(o.nodeValue||"")),o.replaceWith(r)}}}updateRangeChildren(t,e,i){if(i==="smaller"||i==="larger"){let n=t[0],o=parseFloat(n.style.fontSize)||100,r=(i==="smaller"?1/1.2:1.2)*o;this.setChildrenStyles(t,"font-size",r+"%")}else this.allChildrenHaveStyle(t,e,i)?this.unsetChildrenStyles(t,e):this.setChildrenStyles(t,e,i)}allChildrenHaveStyle(t,e,i){for(let n=0;n<t.length;++n){let o=t[n];if(cl(o,e)!==i||!this.allChildrenHaveStyle(o.children,e,i))return!1}return!0}unsetChildrenStyles(t,e){for(let i=0;i<t.length;++i){let n=t[i];vp(n,e),this.unsetChildrenStyles(n.children,e)}}setChildrenStyles(t,e,i){for(let n=0;n<t.length;++n){let o=t[n];hl(o,e,i),this.clearChildrenStyles(o.children,e)}}clearChildrenStyles(t,e){for(let i=0;i<t.length;++i){let n=t[i];n.style.removeProperty(e),this.clearChildrenStyles(n.children,e)}}cleanupElements(t){for(let e=0;e<t.length;++e)this.cleanupElements(t[e].children);for(let e=0;e<t.length;++e)t[e].textContent||t[e].remove();for(let e=0;e<t.length;++e)t[e].getAttribute("style")||t[e].replaceWith(...Array.from(t[e].childNodes))}click(){let t=Date.now();t-this.timeout<500&&this.focus(),this.timeout=t}focus(t=!1){this.focussed||(this.creating=t,this.focussed=!0,this.$parent.options.focussed=this,this.$parent.selection.clear(),this.$text.css("pointer-events","all"),this.$text.setAttr("contenteditable",!0),this.$text.focus(),this.selectAll())}blur(){var i;if(!this.focussed)return;this.focussed=!1,this.$parent.options.focussed=void 0,this.$text.css("pointer-events","none"),this.$text.removeAttr("contenteditable");let t=this.$text.html,e=this.options!==t;if(t){this.$text.show(),this.options=t,this.updateOutline();let n=this.creating?"tilesAdded":"tilesChanged";(this.creating||e)&&this.$parent.change({[n]:[this]})}else this.delete(),this.creating||this.$parent.change({tilesDeleted:[this]});(i=this.selection)==null||i.removeAllRanges()}};var bp={"*":"\xB7","**":"\u2217","//":"//","+-":"\xB1","\u2013":"\u2212","-":"\u2212",xx:"\xD7",sum:"\u2211",prod:"\u220F",int:"\u222B",del:"\u2202",grad:"\u2207",aleph:"\u2135",not:"\xAC",AA:"\u2200",EE:"\u2203","'":"\u2019","!=":"\u2260","<=":"\u2264",">=":"\u2265",in:"\u2208","!in":"\u2209","==":"\u2261","~=":"\u2245","~~":"\u2248",sub:"\u2282",sube:"\u2286",prop:"\u221D",oo:"\u221E",cap:"\u2229",cup:"\u222A","<-":"\u2190","->":"\u2192","=>":"\u21D2","<=>":"\u21D4","|->":"\u21A6",uarr:"\u2191",darr:"\u2193",lArr:"\u21D0"},Qe={Gamma:"\u0393",Delta:"\u0394",Theta:"\u0398",Lambda:"\u039B",Xi:"\u039E",Pi:"\u03A0",Sigma:"\u03A3",Phi:"\u03A6",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u025B",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",pi:"\u03C0",rho:"\u03C1",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",CC:"\u2102",NN:"\u2115",QQ:"\u211A",RR:"\u211D",ZZ:"\u2124"},dl="abcdefghijklmnopqrstuvwxyz",wp=dl.split(""),xp=dl.toUpperCase().split(""),$p=Object.values(Qe),c2=[...wp,...xp,...$p,"$"],Tp="|()[]{}\xF7,!<>=*/+-\u2013\u2212~^_\u2026\xB0\u2022\u2225\u22A5'\u2220:%\u223C\u25B3",Sp=Object.values(bp),h2=[...Tp,...Sp];var Mp=["abs","round","floor","ceil","max","min","mod","lcm","gcd","gcf","log","exp","ln","sqrt","root","sin","cos","tan","sec","csc","cot","cosec","cotan","arcsin","arccos","arctan","sinh","cosh","tanh","sech","csch","coth","cosech"];function pl(s){return Mp.includes(s)}var Pp={"+":"plus","\u2212":"minus","\xB7":"times","\xD7":"times","/":"over","//":"divided by","%":"percent","!":"factorial","\xB1":"plus-minus","=":"equals","\u2260":"does not equal","<":"is less than",">":"is greater than","\u2264":"is less than or equal to","\u2265":"is greater than or equal to",\u03C0:"pi","\u2245":"is congruent to","\u2225":"is parallel to","\u22A5":"is perpendicular to"};for(let s of Object.keys(Qe))Pp[Qe[s]]=s;var po=class{constructor(){this.callbacks=[]}add(t){this.callbacks.push(t)}start(t=1e3){return X(i=>{for(let n of this.callbacks)n(i)},t).promise}};function ul(s,t){return s.every((e,i)=>A(e,t[i]))}function fl(s,t){s.scale*=t.scale,s.x=s.x*t.scale+t.x,s.y=s.y*t.scale+t.y}function ml(s,t){return A(s.x,t.x)&&A(s.y,t.y)&&A(s.scale,t.scale)}function ks(s,t,e){if(e==="adding"){let i=s.strokeLength,n=t<.5?0:tt("cubic-in",t*2-1);s.css({"stroke-dasharray":i+"px","stroke-dashoffset":i*(1-n)+"px"})}else if(e==="deleting"){let i=s.strokeLength,n=t<.5?tt("cubic-in",2*t):1;s.css({"stroke-dasharray":i+"px","stroke-dashoffset":i*(2-n)+"px"})}}function gl(s,t){let e=[s],i=s.expr;for(;t.startsWith(i);){if(t===i)return e;let n=L(e).next;if(!n)return;e.push(n),i+=n.expr}}function yl(s,t,e=1){let i=e*Math.abs(t.x-s.x)/3,n=c.average(s,t).shift(0,i);return function(o){let r=(1-o)**2*s.x+2*o*(1-o)*n.x+o*o*t.x,a=(1-o)**2*s.y+2*o*(1-o)*n.y+o*o*t.y;return{x:r,y:a}}}function uo(s,t){return Math.max(t*s,.4)/s}function Qt(s,t){return t.length===1&&t[0].type==="mrow"?t[0]:new Ce(t,s)}var mt=class{constructor(t,e,i,n){this.type=t;this.equation=i;this.$element=n;this.children=[];this.status="";this.value="";this.customColor="";this.roundedMotion=!1;this.width=0;this.height=0;this.baseline=0;this.transform={x:0,y:0,scale:1};this.currentDimensions=[0,0,0];this.currentWorldTransform={x:0,y:0,scale:1};this.addChildren(e),n&&i.$row.append(n)}get expr(){return""}get log(){let t=this.children.map(e=>e.log);return`<${this.type}>${t.join("")}</${this.type}>`}get color(){return this.customColor||(this.parent?this.parent.color:"")}static create(t,e){let i=t.nodeName.toLowerCase();if(D(i,"mn","mi","mo","mtext")){if(t.textContent==="placeholder")return new Cs(e);let o=t.getAttribute("mathvariant")||void 0;return new Ae(i,t.textContent||"",e,o)}if(!D(i,"mrow","mfrac","mfenced","msqrt","mroot","msub","msup","msubsup"))return new wl(t,e);if(i==="mfenced"&&t.getAttribute("open")==="["){let o=t.children.length,r=Ft(Array.from(t.children,l=>Array.from(l.children,h=>mt.create(h,e)))),a=new bl(r,e,o);return new Oi([a],e)}let n=Array.from(t.children,o=>mt.create(o,e));switch(i){case"mrow":return new Ce(n,e);case"mfrac":return n=n.map(o=>Qt(e,[o])),new As(n,e);case"mfenced":return n=[Qt(e,n)],new Oi(n,e);case"msqrt":return n=[Qt(e,n)],new Je(i,n,e);case"mroot":return n=n.map(o=>Qt(e,[o])),new Je(i,n,e);case"msub":case"msup":case"msubsup":return n=n.map(o=>Qt(e,[o])),new Vs(i,n,e);case"munder":case"mover":case"munderover":return n=n.map(o=>Qt(e,[o])),new vl(i,n,e)}throw new Error(`Unknown element type tag ${t.nodeName}`)}get marginLeft(){return .1}get marginRight(){return .1}setTransform(t=0,e=0,i=1){this.transform.x=t,this.transform.y=e,this.transform.scale=i}get worldTransform(){let t=this,e=Object.assign({},this.transform);for(;t=t.parent;)fl(e,t.transform);return e}get index(){return this.parent?this.parent.children.indexOf(this):-1}get next(){if(!this.parent)return;let t=this.parent.children.indexOf(this);return this.parent.children[t+1]}get prev(){if(!this.parent)return;let t=this.parent.children.indexOf(this);return this.parent.children[t-1]}addChildren(t,e=this.children.length){for(let i of this.children)i.type==="placeholder"&&i.deleteFromDom();for(let i of t)i.detach(),i.parent=this;this.children.splice(e,0,...t)}insertAfter(t){let e=this.parent.children.indexOf(this);this.parent.addChildren(t,e+1)}insertBefore(t){let e=this.parent.children.indexOf(this);this.parent.addChildren(t,e)}detach(){if(this.parent){let t=this.parent.children.indexOf(this);t>=0&&this.parent.children.splice(t,1),this.parent=void 0}}deleteFromDom(){this.parent&&this.detach(),this.$element&&this.$element.remove(),this.$element=void 0;for(let t of this.children.slice(0))t.deleteFromDom()}*parents(t=!1){let e=t?this:this.parent;for(;e;)yield e,e=e.parent}hasParent(t,e=!1){return Jo(this.parents(e),t)}hitTest(t){let{x:e,scale:i}=this.worldTransform,n=this.marginLeft*i*this.equation.fontSize,o=this.marginRight*i*this.equation.fontSize;if(ot(t.x,e-n,e+this.width*i+n+o))return this.hitTestChildren(t)||this}hitTestChildren(t){for(let e of this.children){let i=e.hitTest(t);if(i)return i}}measure(t=1){for(let e of this.children)e.measure(t)}clean(){for(let t of this.children)t.clean()}setStatus(t){this.status=t;for(let e of this.children)e.setStatus(t)}render(t){for(let l of this.children)l.render(t);if(!this.$element)return;let e=this.currentWorldTransform,i=this.currentWorldTransform=this.worldTransform,n=this.currentDimensions,o=this.currentDimensions=[this.width,this.height,this.baseline];if(ml(e,i)&&ul(n,o)&&!this.status)return;if(!t){this.positionElement(i),this.drawElement(1,o[0],o[1],o[2],i.scale);return}this.status==="adding"&&this.positionElement(i);let r=i.y+this.baseline<this.equation.root.baseline?-1:1,a=this.roundedMotion?yl(e,i,r):void 0;this.roundedMotion=!1,t.add(l=>{if(!this.$element)return;let h=tt("cubic",l),p=D(this.status,"adding","deleting"),g=p?o[0]:gt(n[0],o[0],h),y=p?o[1]:gt(n[1],o[1],h),x=p?o[2]:gt(n[2],o[2],h),G=p?i.scale:gt(e.scale,i.scale,h);if(this.drawElement(l,g,y,x,G),!this.status){let f=a?a(h):c.interpolate(e,i,h);this.positionElement({x:f.x,y:f.y,scale:G})}})}positionElement(t){this.$element.setTransform(t,0,t.scale)}drawElement(t,e,i,n,o){}},kp="acegmnopqrsuvwxyz",ti=1.1,Ii=.2,fo=["=","\u2248","<",">","\u2264","\u2265"],Cp="position: absolute; top: -100px; left: -100px",Ap=d("svg",{width:0,height:0,style:Cp},U),Ae=class extends mt{constructor(t,e,i,n){super(t,[],i,d("text",{},Ap));this.variant=n;this.setValue(e)}setValue(t){this.$element.text=this.value=t;let e=this.value.split("").every(n=>kp.includes(n));this.width=this.$element._el.getBBox().width,this.height=(ti-(e?.1:0))*this.equation.fontSize,this.baseline=this.height-Ii*this.equation.fontSize;let i=this.type==="mtext"||this.variant==="normal";this.$element.setClass("font-normal",i||pl(this.value))}get expr(){return this.value==="xx"?'"xx"':this.type==="mtext"?`"${this.value}"`:this.value}get log(){return`<${this.type}>${this.value}</${this.type}>`}get marginLeft(){if(this.type==="mo")return fo.includes(this.value)?this.equation.isDisplay?.6:.35:D(this.value,"\u2221","\u25B3","!","%","\u2019")||D(this.value,"\u2026","\xB0")&&this.prev&&this.prev.type==="mn"?0:.25;if(this.type==="mi"){if(this.prev&&this.prev.type==="mn")return .1;if(this.prev&&this.prev.type==="mi")return .05;if(this.prev&&this.prev.type==="mfrac")return .15}return 0}get marginRight(){return this.type==="mo"?this.equation.isDisplay&&fo.includes(this.value)?.6:D(this.value,"\u2221","\u25B3")?0:this.value==="\u2212"&&(!this.prev||fo.includes(this.prev.value))?.1:.25:0}positionElement(t){if(!this.$element)return;let e=(this.equation.fontSize-this.baseline)*t.scale;this.$element.setTransform({x:t.x,y:t.y-e},0,t.scale)}drawElement(t,e,i,n,o){this.status==="adding"?this.$element.setAttr("opacity",t<.5?0:tt("cubic-in",t*2-1)):this.status==="deleting"&&this.$element.setAttr("opacity",t<.5?1-tt("cubic-in",2*t):0),this.$element.css("stroke-width",(1-o)*1.5+"px"),this.$element.css("color",this.color||"currentColor")}},Ce=class extends mt{constructor(t,e,i,n=0){super("mrow",t,e);this.align=i;this.dx=n}addChildren(t,e=this.children.length){let i=[];for(let n of t)n.type==="mrow"?(i.push(...n.children),n.detach()):i.push(n);super.addChildren(i,e)}get expr(){return this.children.map(t=>t.expr).join(" ")}measure(t=1){if(super.measure(t),!this.children.length){this.height=this.width=this.baseline=0;return}this.baseline=Math.max(...this.children.map(i=>i.baseline)),this.height=this.baseline+Math.max(...this.children.map(i=>i.height-i.baseline));let e=0;for(let[i,n]of this.children.entries())n.setTransform(e,this.baseline-n.baseline),e+=n.width,i<this.children.length-1&&(e+=Math.max(n.marginRight,this.children[i+1].marginLeft)*this.equation.fontSize);if(this.align){let i=this.children.find(n=>n.expr===this.align);i&&(this.transform.x=this.dx-i.transform.x-i.width/2)}this.width=e}},Cs=class extends mt{constructor(t){let e=t.fontSize,i=`M${.1*e} ${.3*e}h${e/2}v${e/2}h-${e/2}Z`,n=d("path",{class:"placeholder",d:i});super("placeholder",[],t,n);this.width=.7*e,this.height=ti*e,this.baseline=this.height-Ii*e}get expr(){return"placeholder"}get marginLeft(){return 0}get marginRight(){return 0}},As=class extends mt{constructor(t,e){super("mfrac",t,e,d("line"))}get expr(){return this.children.map(t=>"("+t.expr+")").join("/")}measure(t){let e=this.hasParent(a=>a.type==="mfrac"||a.type==="matrix"),i=uo(t,!this.equation.isDisplay||e?.66:1),n=.1*this.equation.fontSize,[o,r]=this.children;super.measure(t*i),this.width=(Math.max(o.width,r.width)+2*n)*i,this.height=(o.height+r.height)*i,this.baseline=o.height*i+this.equation.fontSize*(ti/2-Ii),o.setTransform((this.width-o.width*i)/2,0,i),r.setTransform((this.width-r.width*i)/2,o.height*i,i)}drawElement(t,e,i,n){let o=n-this.equation.fontSize*(ti/2-Ii);this.$element.setLine({x:0,y:o},{x:e,y:o}),this.$element.setAttr("stroke",this.color||"currentColor"),ks(this.$element,t,this.status)}hitTestChildren(t){let{scale:e,y:i}=this.worldTransform,n=this.baseline-this.equation.fontSize*(ti/2-Ii),o=t.y<=i+n*e,r=this.children[o?0:1];return r.hitTestChildren(t)||r}},Vs=class extends mt{get expr(){let t=this.children[0].expr;return this.type!=="msup"&&(t+="_("+this.children[1].expr+")"),this.type==="msup"&&(t+="^("+this.children[1].expr+")"),this.type==="msubsup"&&(t+="^("+this.children[2].expr+")"),t}measure(t){let[e,i,n]=this.children,o=this.type==="msup"?void 0:i,r=this.type==="msubsup"?n:this.type==="msup"?i:void 0,a=.05*this.equation.fontSize,l=uo(t,.65);e.measure(t),o&&o.measure(t*l),r&&r.measure(t*l);let h=r?r.height*l-.4*this.equation.fontSize:0,p=o?o.height*l-.5*this.equation.fontSize:0,g=r?r.width:0,y=o?o.width:0;this.width=e.width+a+Math.max(g,y)*l,this.height=e.height+h+p,this.baseline=e.baseline+h,e.setTransform(0,this.baseline-e.baseline),r&&r.setTransform(e.width+a,0,l),o&&o.setTransform(e.width+a,this.height-o.height*l,l)}clean(){if(super.clean(),this.children=this.children.filter(t=>t.type!=="mrow"||t.children.length),this.children.length===0)return this.detach();this.children.length===1&&(this.insertAfter(this.children),this.detach())}},vl=class extends mt{get expr(){let t=this.children[0].expr;return this.type!=="munder"&&(t+="_"+this.children[1].expr),this.type==="mover"&&(t+="^"+this.children[1].expr),this.type==="munderover"&&(t+="^"+this.children[2].expr),t}measure(t){super.measure(t)}},Oi=class extends mt{constructor(t,e){super("mfenced",t,e,d("path"))}get expr(){return`(${this.children.map(t=>t.expr).join()})`}get marginLeft(){return .2}get marginRight(){return .2}measure(t){super.measure(t);let e=this.children[0];this.height=e.height+2,this.baseline=e.baseline+1;let i=1+this.height/this.equation.fontSize,n=.1*this.equation.fontSize;this.width=e.width+2*(i+n),e.setTransform(i+n,1)}drawElement(t,e,i){let n=Math.min(2+i/this.equation.fontSize,5),o=i-4,r=e-n,a=`M${n},2c${-2*n/3},${.15*o},${-n},${.32*o},${-n},${o/2}s${n/3},${.35*o},${n},${o/2}M${r},2c${2*n/3},${.15*o},${n},${.32*o},${n},${o/2}s${-n/3},${.35*o},${-n},${o/2}`;this.$element.setAttr("d",a),this.$element.css("stroke",this.color||"currentColor"),ks(this.$element,t,this.status)}clean(){super.clean(),this.children.length||this.detach()}},Je=class extends mt{constructor(t,e,i){super(t,e,i,d("path"))}get expr(){return`sqrt(${this.children.map(t=>t.expr).join()})`}get marginLeft(){return .2}get marginRight(){return .2}measure(t){super.measure(t);let e=this.children[0];this.height=e.height+2,this.baseline=e.baseline+2;let i=Math.min(16,3+5*this.height/this.equation.fontSize),n=.05*this.equation.fontSize;this.width=e.width+i+2*n,e.setTransform(i+n,2)}drawElement(t,e,i){let n=Math.min(16,3+5*i/this.equation.fontSize),o=i-2,r=`M0,${.55*o}L${.18*n},${.51*o}L${.45*n},${o}L${n},2L${e},2`;this.$element.setAttr("d",r),this.$element.css("stroke",this.color||"currentColor"),ks(this.$element,t,this.status)}clean(){super.clean(),this.children.length||this.detach()}},bl=class extends mt{constructor(t,e,i){super("matrix",t,e,d("g"));this.rows=i;this.cols=Math.floor(t.length/i)}get expr(){return`${this.children.map(t=>t.expr).join(", ")}`}measure(t){super.measure(t);let e=.6*this.equation.fontSize,i=N(r=>Math.max(...N(a=>this.children[r*this.cols+a].height,this.cols)),this.rows),n=N(r=>Math.max(...N(a=>this.children[a*this.cols+r].width,this.rows)),this.cols);this.height=q(i)+(this.rows-1)*e/2,this.width=q(n)+this.cols*e,this.baseline=(this.height+ti*this.equation.fontSize)/2;let o=0;for(let r=0;r<this.rows;++r){let a=e/2;for(let l=0;l<this.cols;++l){let h=this.children[r*this.cols+l],p=a+(n[l]-h.width)/2,g=o+(i[r]-h.height)/2;h.setTransform(p,g),a+=n[l]+e}o+=i[r]+e/2}}},wl=class extends mt{constructor(t,e){super("foreign",[],e,d("g"));var i;this.$body=d("div",{},e.$overlay),this.$body._el.appendChild(t),this.$measure=d("span",{text:".",style:"font-size: 0"},this.$body),this.checkForResize(),this.$body.on("resize",()=>{this.checkForResize()&&this.equation.resize()}),(i=this.$body.$("x-blank, x-blank-mc"))==null||i.on("solve",n=>{zi(()=>this.replace(n.solution,"#0f82f2"),n.restore?0:200)})}deleteFromDom(){var t;(t=this.$body)==null||t.remove(),this.$body=void 0,this.$measure=void 0}replace(t,e){var o;let i=isNaN(+t)?"mtext":"mn",n=new Ae(i,t,this.equation);n.customColor=e,this.insertAfter([n]),(o=this.$body)==null||o.off("resize"),this.deleteFromDom(),this.equation.resize()}checkForResize(){var n,o;let t=this.height,e=this.width,i=this.baseline;return this.height=((n=this.$body)==null?void 0:n.height)||0,this.width=((o=this.$body)==null?void 0:o.width)||0,this.baseline=this.$measure.bounds.top-this.$body.bounds.top,!(A(t,this.height)&&A(e,this.width)&&A(i,this.baseline))}positionElement(t){this.$body.css({left:t.x+"px",top:t.y+"px"}),A(t.scale,1)||this.$body.css("transform",`scale(${t.scale})`)}get expr(){return'"this.$body!.text"'}get log(){return`<foreign>${this.expr}</foreign>`}};function $t(s){return!!s.setValue}function xl(s,t){let e=s;for(let i of s.parents()){if(i.type in t&&i.children.indexOf(e)===t[i.type])return i;e=i}}function Vp(s,t){for(let e of s.parents(!0))for(let i of t.parents(!0))if(e===i)return i}function $l(s,t,e=!1){let i=e?s.children.slice(0).reverse():s.children,n=t.parent;return i.findIndex((o,r)=>n.hasParent(a=>a===o)||$t(n)&&n===o||s===n&&(e?i.length-r:r)===t.offset)}var mo=class{constructor(t){this.equation=t;this.offset=0;this.$el=d("line",{class:"cursor",hidden:!0},t.$row),this.$range=d("rect",{class:"range",hidden:!0}),t.$row.prepend(this.$range),this.parent=t.root}redraw(){let t=this.getRangeRect();if(this.$el.toggle(!t),this.$range.toggle(!!t),t)this.$range.setRect(t);else{this.selected=void 0;let e=this.getCursorLine();e&&this.$el.setLine(...e),this.$el.restartAnimation()}}hide(){this.$el.hide(),this.$range.hide(),this.clearRange()}startRange(){this.start={parent:this.parent,offset:this.offset}}clearRange(){this.selected=void 0,this.start=void 0}moveToPoint(t){let e=this.equation.root.hitTest(t)||this.equation.root,i=e.worldTransform,n=(t.x-i.x)/(e.width*i.scale);$t(e)?this.moveInto(e,Math.round(n*e.value.length)):n<.5?this.moveBefore(e):this.moveAfter(e)}getRangeRect(){if(!this.start||this.start.parent===this.parent&&this.start.offset===this.offset)return;let t=Vp(this.parent,this.start.parent),e=[t];if(t.children.length){let i=$l(t,this.start),n=$l(t,this);n<i&&([i,n]=[n,i]),(i>0||n<t.children.length-1)&&(e=t.children.slice(i,n+1)),e.length||(e=[t]),(i<0||n<0)&&t.type==="mrow"&&t.parent&&(e=[t.parent]),e.length===1&&e[0].type==="mrow"&&(e=e[0].children.slice(0))}return this.selected=e,$.aroundPoints(tr(e,i=>{let n=i.worldTransform;return[n,{x:n.x+i.width*n.scale,y:n.y+i.height*n.scale}]}))}getCursorLine(){let t=$t(this.parent)?this.parent:this.prev||this.next;if(!t)return;let e=t.worldTransform,i=t.height*e.scale,n=-1;return $t(this.parent)?n=t.width*e.scale*this.offset/t.value.length:this.prev&&(n=this.prev.width*e.scale+1),[{x:e.x+n,y:e.y+2},{x:e.x+n,y:e.y+i-2}]}moveAfter(t){if(t.type==="mrow")return this.moveAfter(L(t.children));if(!t.parent)throw new Error("Move cursor to unattached node");this.parent=t.parent,this.offset=this.parent.children.indexOf(t)+1}moveBefore(t){if(t.type==="mrow")return this.moveBefore(t.children[0]);if(!t.parent)throw new Error("Move cursor to unattached node");this.parent=t.parent,this.offset=this.parent.children.indexOf(t)}moveInto(t,e){if($t(t)){if(e<=0)return this.moveBefore(t);if(e>=t.value.length)return this.moveAfter(t)}this.parent=t,this.offset=e}get prev(){return this.parent.children[this.offset-1]}get next(){return this.parent.children[this.offset]}handleShift(t,e=!1){if(t&&!this.selected)this.startRange();else if(!t&&this.selected)return e?this.moveBefore(this.selected[0]):this.moveAfter(L(this.selected)),this.clearRange(),!0;this.selected&&this.parent!==this.selected[0].parent&&this.moveAfter(L(this.selected))}left(t){if(this.handleShift(t,!0))return;if(this.selected)return this.offset-=1;if($t(this.parent))return this.moveInto(this.parent,this.offset-1);let e=this.prev;if(e)return $t(e)?this.moveInto(e,e.value.length-1):e.children.length?this.moveAfter(L(e.children)):this.moveBefore(e);let i=this.parent,n=(i==null?void 0:i.type)==="mrow";if(n&&(i==null?void 0:i.prev))return this.moveAfter(i.prev);let o=n?i.parent:i;o&&this.moveBefore(o)}right(t){if(this.handleShift(t))return;if(this.selected)return this.offset+=1;if($t(this.parent))return this.moveInto(this.parent,this.offset+1);let e=this.next;if(e)return $t(e)?this.moveInto(e,1):e.children.length?this.moveBefore(e.children[0]):this.moveAfter(e);let i=this.parent,n=(i==null?void 0:i.type)==="mrow";if(n&&(i==null?void 0:i.next))return this.moveBefore(i.next);let o=n?i.parent:i;o&&this.moveAfter(o)}up(t){this.selected&&this.clearRange();let e=xl(this.parent,{mfrac:1,msub:1,msup:0});(e==null?void 0:e.type)==="mfrac"&&this.moveAfter(L(e.children[0].children)),(e==null?void 0:e.type)==="msub"&&this.moveAfter(L(e.children[0].children)),(e==null?void 0:e.type)==="msup"&&this.moveBefore(e.children[1].children[0])}down(t){this.selected&&this.clearRange();let e=xl(this.parent,{mfrac:0,msub:0,msup:1});(e==null?void 0:e.type)==="mfrac"&&this.moveBefore(e.children[1].children[0]),(e==null?void 0:e.type)==="msub"&&this.moveBefore(e.children[1].children[0]),(e==null?void 0:e.type)==="msup"&&this.moveAfter(L(e.children[0].children))}backspace(){var o;if(this.selected){this.moveBefore(this.selected[0]);for(let r of this.selected)r.deleteFromDom();this.clearRange(),this.parent.children.length||this.parent.addChildren([this.placeholder]);return}if($t(this.parent)){let r=this.parent.value;return this.setText(r.slice(0,this.offset-1)+r.slice(this.offset)),this.moveInto(this.parent,this.offset-1)}let t=this.prev;if(t)return $t(t)&&t.value.length>1?t.setValue(t.value.slice(0,t.value.length-1)):t.type==="placeholder"||t.children.length?this.left():(t.deleteFromDom(),this.parent.children.length||this.parent.addChildren([this.placeholder]),this.moveInto(this.parent,this.offset-1));let e=this.parent,i=e.children,n=0;e.type==="mrow"&&parent.parent&&(n=((o=e.prev)==null?void 0:o.children.filter(r=>r.type!=="placeholder").length)||0,e=e.parent,i=Ft((e==null?void 0:e.children.map(r=>r.children))||[])),!!(e==null?void 0:e.parent)&&(this.moveInto(e.parent,e.index+n),e.insertAfter(i.filter(r=>r.type!=="placeholder")),e.deleteFromDom(),this.parent.children.length||this.parent.addChildren([this.placeholder]))}get placeholder(){return new Cs(this.equation)}setText(t,e){if(!e&&$t(this.parent)&&(e=this.parent),!!e){if(t in Qe&&(t=Qe[t]),t==="sqrt"){let i=this.createNode("msqrt");return e.insertAfter([i]),e.deleteFromDom(),this.moveBefore(i.children[0].children[0])}e.setValue(t)}}createNode(t,e){let i=Qt(this.equation,e||[this.placeholder]);if(t==="mfenced")return new Oi([i],this.equation);if(t==="msqrt")return new Je(t,[i],this.equation);let n=Qt(this.equation,[this.placeholder]);if(t==="mfrac")return new As([i,n],this.equation);if(t==="mroot")return new Je(t,[i,n],this.equation);if(t==="msub"||t==="msup")return new Vs(t,[i,n],this.equation)}splitTextNode(){let t=this.parent,e=t.value.slice(this.offset);t.setValue(t.value.slice(0,this.offset)),t.insertAfter([new Ae(t.type,e,this.equation)]),this.moveAfter(t)}insert(t,e){var n,o,r,a,l;let i=((n=this.prev)==null?void 0:n.type)==="placeholder";if($t(this.parent)&&!this.start&&!this.selected){let h=this.parent.value;((o=this.parent)==null?void 0:o.type)===t?(this.setText(h.slice(0,this.offset)+e+h.slice(this.offset)),this.moveInto(this.parent,this.offset+1)):(this.splitTextNode(),this.insert(t,e))}else if(t==="mi"||t==="mn"||t==="mtext")this.selected&&this.backspace(),((r=this.prev)==null?void 0:r.type)===t?this.setText(this.prev.value+e,this.prev):((a=this.next)==null?void 0:a.type)===t?(this.setText(e+this.next.value,this.next),this.moveInto(this.next,1)):(this.parent.addChildren([new Ae(t,e,this.equation)],this.offset),i||(this.offset+=1));else if(t==="mo")this.selected&&this.backspace(),this.parent.addChildren([new Ae("mo",e,this.equation)],this.offset),i||(this.offset+=1);else{let h=t==="msub"||t==="msup"||t==="mfrac"&&((l=this.prev)==null?void 0:l.type)!=="mo",p=this.selected||(h&&this.prev?[this.prev]:void 0);p&&this.moveBefore(p[0]),this.selected&&this.clearRange();let g=this.createNode(t,p);this.parent.addChildren([g],this.offset),this.moveBefore(g.children[p&&g.children.length>1?1:0].children[0])}}toSubSup(t){let e=this.placeholder,i=t.type==="msub"?2:1;t.addChildren([Qt(this.equation,[e])],i),t.type="msubsup",this.moveBefore(e)}type(t){var e,i,n,o;if(t=t.replace("*","\xD7").replace("-","\u2212"),t.match(/^[A-Za-zÏ€]$/))this.insert("mi",t);else if("0123456789.".includes(t))this.insert("mn",t);else if("+\u2212\xB1\xD7\xF7<>\u2264\u2265=%!".includes(t))this.insert("mo",t);else if(t==="frac"||t==="/")this.insert("mfrac",t);else if(t==="sqrt")this.insert("msqrt",t);else if(t==="^"||t==="sup"){if(((e=this.prev)==null?void 0:e.type)==="msub")return this.toSubSup(this.prev);this.insert("msup",t)}else if(t==="_"||t==="sub"){if(((i=this.prev)==null?void 0:i.type)==="msup")return this.toSubSup(this.prev);this.insert("msub",t)}else if(t==="brackets"||"([{|".includes(t))this.insert("mfenced",t);else if(")]}".includes(t))if(((o=(n=this.parent)==null?void 0:n.parent)==null?void 0:o.type)==="mfenced")this.moveAfter(this.parent.parent);else{let r=this.prev;this.parent.addChildren([this.createNode("mfenced",r?[r]:void 0)],this.offset),r||(this.offset+=1)}}copy(){return this.selected?this.selected.map(t=>t.expr).join(""):""}paste(t){try{let e=this.equation.parse(t);if(this.selected&&this.backspace(),e.length===1&&$t(e[0]))return this.insert(e[0].type,e[0].value),e[0].deleteFromDom();$t(this.parent)&&this.splitTextNode(),this.parent.addChildren(e,this.offset),this.moveAfter(L(e))}catch(e){}}};var go=class extends te{constructor(t,e,i=0,n="=",o=18,r=!0){super();this.$row=t;this.$overlay=e;this.fontSize=o;this.isDisplay=r;this.isReady=!0;this.deletedNodes=new Set;this.root=new Ce([],this,n,i)}setValue(t){let e=Array.isArray(t)?t.map(i=>mt.create(i,this)):this.parse(t);for(let i of this.root.children)i.deleteFromDom();this.root.addChildren(e),this.updateDescription(),this.resize()}updateDescription(){let t=Pi.parse(this.root.expr).toVoice();this.$row.setAttr("aria-label",t)}resize(){this.root.measure(),this.root.render()}parse(t){var r;let e=new DOMParser,i=Pi.parse(t).toMathML(),n=e.parseFromString(`<math>${i}</math>`,"text/xml");if(((r=n.firstChild)==null?void 0:r.nodeName)==="parsererror")throw new Error(n.firstChild.textContent);let o=n.firstChild.childNodes;return Array.from(o,a=>mt.create(a,this))}find(t){let[e,i]=t.split("`");e=e.replace(/[â€“-]/g,"\u2212");let n=+i||1,o=this.root.children.slice(0),r=0;for(;o.length;){let a=o.shift(),l=a instanceof Ce?void 0:gl(a,e);if(l&&(r+=1,r===n))return l;o.unshift(...a.children)}throw new Error(`Can't find element ${e}.`)}animate(t=1200){return M(this,null,function*(){this.isReady=!1,this.root.clean(),this.root.measure();let e=new po;this.root.render(e),this.trigger("resize",{height:this.root.height});for(let i of this.deletedNodes)i.render(e);yield e.start(t);for(let i of this.deletedNodes)i.deleteFromDom();this.root.setStatus(""),this.deletedNodes.clear(),this.isReady=!0})}addTermAfter(t,e){let i=L(e?this.find(e):this.root.children),n=this.parse(t);i.insertAfter(n);for(let o of n)o.setStatus("adding");this.updateDescription()}addTermBefore(t,e){let i=e?this.find(e)[0]:this.root.children[0],n=this.parse(t);i.insertBefore(n);for(let o of n)o.setStatus("adding");this.updateDescription()}deleteTerm(t){for(let e of this.find(t))e.setStatus("deleting"),e.detach(),this.deletedNodes.add(e);this.updateDescription()}replaceTerm(t,e){let i=this.find(t),n=this.parse(e);i[0].insertBefore(n);for(let o of n)o.setStatus("adding");for(let o of i)o.setStatus("deleting"),o.detach(),this.deletedNodes.add(o);this.updateDescription()}moveTermAfter(t,e){let i=this.find(t);for(let o of i)o.roundedMotion=!0;L(e?this.find(e):this.root.children).insertAfter(i),this.updateDescription()}moveTermBefore(t,e){let i=this.find(t);for(let o of i)o.roundedMotion=!0;(e?this.find(e)[0]:this.root.children[0]).insertBefore(i),this.updateDescription()}moveTermToStart(t){let e=this.find(t);for(let i of e)i.roundedMotion=!0;this.root.children[0].insertBefore(e),this.updateDescription()}wrapTerms(t,...e){let i=e.map(o=>this.find(o));for(let o of i)for(let r of o)r.roundedMotion=!0;let n=this.parse(t);for(let o of n)o.setStatus("adding");i[0][0].insertBefore(n);for(let[o,r]of i.entries()){let a=this.find("$"+(o+1))[0];a.insertAfter(r),a.deleteFromDom()}this.updateDescription()}unwrapTerm(t,e=1){let i=this.find(t),n=i[0],o=1;for(;o<=e;)n=n.parent,n instanceof Ce&&(n=n.parent),o+=1;n.insertAfter(i),n.setStatus("deleting"),n.detach(),this.deletedNodes.add(n),this.updateDescription()}get leftSide(){let t=this.root.children.findIndex(e=>e.expr==="=");return this.root.children.slice(0,t-1)}get rightSide(){let t=this.root.children.findIndex(e=>e.expr==="=");return this.root.children.slice(t+1)}};var yo=class extends S{constructor(t,e,i){super(e,i);this.type="equation";this.focussed=!1;this.size=0;this.timeout=0;this.creating=!1;this.options=t||"placeholder",this.$box=d("rect",{fill:"transparent"},this.$el),this.$outline=d("rect",{class:"outline"},this.$el),this.$equation=d("g",{class:"equation","font-size":"20px"},this.$el),this.equation=new go(this.$equation,void 0,0,"",20),this.cursor=new mo(this.equation);try{this.equation.setValue(this.options)}catch(n){console.warn("Parsing error",t,n.message)}this.transform(),this.setColour(e.penColour),this.$textarea=d("textarea",{class:"hidden-input",tabindex:-1},e),this.$textarea.on("key",n=>this.handleKey(n)),this.$textarea.on("blur",()=>this.blur()),this.$textarea.on("cut copy",n=>{var o;(o=window.navigator.clipboard)==null||o.writeText(this.cursor.copy()),n.type==="cut"&&(this.cursor.backspace(),this.redraw())}),this.$textarea.on("paste",()=>M(this,null,function*(){var o;let n=yield(o=window.navigator.clipboard)==null?void 0:o.readText();!n||(this.cursor.paste(n),this.redraw())})),e.events.listen(this.$el,{down:n=>{n.event.preventDefault(),this.cursor.clearRange(),this.moveCursor(n)},start:()=>this.cursor.startRange(),move:n=>this.moveCursor(n),blurInput:!1,checkIfActive:()=>this.focussed})}setSize(t){super.setSize(E(t,-5,10)),this.$equation.css("transform",this.size?`scale(${this.scale})`:""),this.transform()}get scale(){return 1.2**this.size}click(t){let e=Date.now();e-this.timeout<500&&this.focus(!1,t),this.timeout=e}customTransform(){let t=this.equation.root.width*this.scale+16,e=this.equation.root.height*this.scale+12;this.path=new $(T.shift(-8,-6),t,e);for(let i of[this.$box,this.$outline])i.setRect(this.path)}setColour(t){super.setColour(t),this.$equation.css("color",t)}delete(){super.delete(),this.$textarea.remove()}getSnapPoints(){return[]}focus(t=!1,e){this.focussed||(this.focussed=!0,this.$parent.options.focussed=this,this.creating=t,this.$el.css("cursor","text"),this.$textarea.show(),this.$textarea.focus(),this.$parent.selection.clear(),this.moveCursor(e))}blur(){if(!this.focussed)return;this.focussed=!1,this.$parent.options.focussed=void 0,this.cursor.hide(),this.$el.css("cursor","grab"),this.$textarea.hide();let t=this.options;this.options=this.equation.root.expr,this.equation.updateDescription();let e=this.creating?"tilesAdded":"tilesChanged";(this.creating||t!==this.options)&&this.$parent.change({[e]:[this]})}redraw(){this.equation.resize(),this.transform(),this.cursor.redraw()}moveCursor(t){this.cursor.moveToPoint(t?this.relativePosn(t.posn).scale(1/this.scale):T),this.cursor.redraw()}handleKey(t){if(t.code===_t.enter||t.code===_t.escape)return this.$textarea.blur(),this.$parent.selection.add(this,!0);if(t.code===_t.left)this.cursor.left(t.shift);else if(t.code===_t.right)this.cursor.right(t.shift);else if(t.code===_t.up)this.cursor.up(t.shift);else if(t.code===_t.down)this.cursor.down(t.shift);else return t.code===_t.backspace||t.code===_t.delete?(this.cursor.backspace(),this.redraw()):(this.cursor.type(t.char),this.redraw());this.cursor.redraw()}format(t){this.handleKey({char:t})}};var Tl={"number-bar":Cn,"number-tile":ps,polygon:B,pentomino:gn,tangram:yn,"fraction-bar":Ze,"fraction-circle":Nn,text:ho,"algebra-tile":vi,grid:qn,"custom-polygon":fn,image:co,dice:io,coin:so,"number-line":An,penrose:vn,kolam:bn,"prime-disk":Vn,balance:Hn,"decimal-grid":En,spinner:Ei,"custom-spinner":ao,token:Zn,egg:wn,geo:j,fractal:$n,ruler:Tn,protractor:Sn,compass:Mn,"dot-machine":Ln,dot:gi,garden:Pn,tantrix:kn,axes:Yn,"question-blank":Li,equation:yo,"number-card":On,card:_e,abacus:In,bucket:Gn};function Ri(s){if(!(s in Tl))throw new Error(`Unknown tile type: ${s}`);return Tl[s]}var Gi=Math.PI/180,Sl,Ml,Es=new Set,vo=new Set;function Ep(s,t,e){let i=Tt(s-t,e);return i>e/2?i-e:i}function Lp(s,t){for(let e of s)if(t(e))return!0;return!1}var bo=class{constructor(t){this.$parent=t;this.angle=0;this.startAngle=0;this.hasChanged=!1;this.isMoving=!1;this.tiles=new Set;this.$tools=t.$(".transform-tools"),this.$rect=this.$tools.$(".group-outline"),this.$rotateBar=this.$tools.$(".rotate-bar"),this.$rotateCircle=this.$tools.$(".rotate-circle"),t.events.listen(this.$rotateCircle,{start:()=>{this.startAngle=this.angle,this.rotateStart()},move:({startPosn:e,posn:i})=>{this.rotate(this.startAngle-new ft(i,this.center,e).deg)},end:()=>this.rotateEnd()}),w.onKey("up down left right r R",(e,i)=>{if(!this.tiles.size)return;if(i==="r"||i==="R"){if(Array.from(this.tiles).some(h=>!h.canRotate))return;this.rotateStart(),this.rotate(this.angle+(i==="R"?-15:15)),this.rotateEnd();return}let n=T,o=this.$parent.events.shiftKey?5:25,r=i==="left"?-o:i==="right"?o:0,a=i==="up"?-o:i==="down"?o:0,l=n.shift(r,a);this.moveStart(),this.move({posn:l,startPosn:n}),this.moveEnd()}),w.onKey("escape",()=>this.clear())}get size(){return this.tiles.size}add(t,e=!1,i=!1){e&&this.clear(),t.isActive||this.select([t],i)}select(t,e=!1){for(let i of t)i.isActive||(this.tiles.add(i),i.select(),this.hasChanged=!0);e||this.update(!0)}remove(t,e=!1){!t.isActive||(t.deselect(),this.hasChanged=!0,this.tiles.delete(t),e||this.update(!0))}copy(t=!1,e=25){if(this.isMoving||!this.$parent.options.canCopy||!this.tiles.size)return;let i={},n=Array.from(this.tiles).map(o=>o.copy(i,e));this.clear();for(let o of n)this.add(o);if(!t){this.$parent.change({tilesAdded:n});for(let o of n)this.$parent.trigger("copy-tile",{tile:o})}}delete(){if(this.isMoving||!this.$parent.options.canDelete||!this.tiles.size)return;let t=Array.from(this.tiles);for(let e of this.tiles)e.delete();j.computeIntersections(this.$parent),this.$parent.change({tilesDeleted:t}),this.$parent.newTileShift=0}clear(){if(!this.isMoving){for(let t of this.tiles)t.deselect();this.tiles.size&&(this.hasChanged=!0),this.tiles.clear(),this.update(!0)}}getTileProperty(t){if(!this.size)return;let e=Array.from(this.tiles),i=t(e[0]);return e.slice(1).some(o=>t(o)!==i)?void 0:i}update(t=!1){if(t&&!this.hasChanged)return;if(this.hasChanged=!1,!this.size){this.$tools.hide(),this.$parent.trigger("change-selection",{tiles:[],color:void 0});return}let e=Array.from(this.tiles);this.angle=this.getTileProperty(l=>l.rot)||0;let i=we(...e.map(l=>l.transformed.rotate(-this.angle*Gi))),n=i.p.shift(i.w/2,i.h/2).rotate(this.angle*Gi).shift(-i.w/2,-i.h/2);this.rect=new $(n,i.w,i.h),this.center=this.rect.center;let o=!!this.$parent.options.canRotate&&e.every(l=>l.canRotate);if(e.length===1&&rt(e[0].transformed)&&(o=!1),o&&this.getTileProperty(l=>l.rotateAroundOrigin)){let l=e[0].posn;e.slice(1).every(h=>h.posn.equals(l))&&(this.center=l,this.angle&&e.length===1&&(this.rect=we(e[0].transformed.rotate(-this.angle*Gi,l))))}this.$rotateBar.toggle(o),this.$rotateCircle.toggle(o);let r=this.getTileProperty(l=>l.hideSelectionOutline);r||this.positionTools(),this.$rect.toggle(this.size>1||e[0].showSelectionOutline),this.$tools.toggle(!r);let a=this.getTileProperty(l=>l.colour);this.$parent.trigger("change-selection",{tiles:e,color:a})}positionTools(){this.$rect.draw(this.rect.rotate(this.angle*Gi,this.center));let t=new c(this.center.x,this.rect.p.y),e=new H(t,t.shift(0,-28)).rotate(this.angle*Gi,this.center);this.$rotateBar.setLine(e.p1,e.p2),this.$rotateCircle.setCenter(e.p2)}moveStart(){for(let t of this.tiles)if(!t.canMove)return;this.isMoving=!0;for(let t of this.tiles)t.moveStart();this.startSnapPoints=[];for(let t of this.tiles)for(let e of t.snapPoints)this.startSnapPoints.some(i=>e.equals(i))||this.startSnapPoints.push(e);Ml=this.rect,Sl=this.center,this.$parent.newTileShift=0,this.$parent.trigger("move-start")}move({posn:t,startPosn:e}){if(!this.isMoving)return;let i=t.subtract(e),n=this.startSnapPoints.map(a=>a.add(i)),o=this.$parent.snap(n);o&&(i=i.add(o.shift));let r=this.tiles.size===1?o==null?void 0:o.target:void 0;for(let a of this.tiles)a.move(i,r);this.rect=Ml.translate(i),this.center=Sl.add(i),this.positionTools(),this.$parent.trigger("move-selection")}moveEnd(t=!1){if(!!this.isMoving){for(let e of this.tiles)e.transform(),e.moveEnd();j.computeIntersections(this.$parent),this.$parent.trigger("move-end"),this.$parent.change({[t?"tilesAdded":"tilesChanged"]:Array.from(this.tiles)}),this.isMoving=!1}}rotateStart(){vo.clear();for(let t of this.tiles)for(let e of t.snapAngles)vo.add(Tt(e+t.rot,180));Es.clear(),Es.add(0);for(let t of this.$parent.tiles)if(!t.isActive&&!!Lp(this.tiles,e=>c.distance(e.posn,t.posn)<140))for(let e of t.snapAngles)Es.add(Tt(e+t.rot,180));this.$parent.newTileShift=0}rotate(t){if(t=pt(t,3),t===this.angle)return;let e=Infinity;for(let n of vo)for(let o of Es){let r=Ep(o,n+t-this.startAngle,180);Math.abs(r)<Math.abs(e)&&(e=r)}if(Math.abs(e)<8&&(t+=e),t===this.angle)return;let i=t-this.angle;this.angle=t;for(let n of this.tiles)n.posn=n.posn.rotate(i*Math.PI/180,this.center),n.rot=Tt(n.rot+i,360),n.transform(!0);this.positionTools(),this.$parent.trigger("rotate-selection")}rotateEnd(){for(let t of this.tiles)t.transform();this.$parent.change({tilesChanged:Array.from(this.tiles)})}action(t,e){if(e==="copy")return this.copy();if(e==="delete")return this.delete();Ri(t.split(" ")[0]).action(e,Array.from(this.tiles),this.center),this.update()}};var Op=5,Ve=class{constructor(t){this.$parent=t}getTileAt(t,e=!0){var o,r;let i=this.$parent.snap([t.posn],e,!0,"geo");if(((r=(o=i==null?void 0:i.target)==null?void 0:o.tile)==null?void 0:r.type)==="geo")return i.target.tile;let n=t.event.target;for(;n;){let a=ns.get(n);if(a&&!a.locked&&a.type!=="geo")return a;if(n=n.parentNode||void 0,n===this.$parent._el)return}}hoverGeoTile(t){var e;this.hoveringTile!==t&&((e=this.hoveringTile)==null||e.hover(!1)),t==null||t.hover(),this.hoveringTile=t}down(t){}start(t){}move(t){}end(t){}click(t){}hover(t){}cancel(){}},wo=class extends Ve{constructor(){super(...arguments);this.name="move"}down(t){let e=this.activeTile=this.getTileAt(t,!1);this.previousSelection=void 0,e?(e.isActive&&this.$parent.events.shiftKey?this.$parent.selection.remove(e):(this.$parent.events.shiftKey||!e.isActive)&&this.$parent.selection.add(e,!this.$parent.events.shiftKey),Bt.addClass("grabbing")):this.$parent.events.shiftKey?this.previousSelection=new Set(this.$parent.selection.tiles):this.$parent.selection.clear()}start(){this.activeTile?(this.$parent.events.altKey&&this.$parent.selection.copy(!0,0),this.$parent.selection.moveStart()):this.$parent.$selection.show()}move(t){var i;if(this.activeTile){this.$parent.selection.move(t);return}let e=$.aroundPoints([t.startPosn,t.posn]);this.$parent.$selection.setRect(e);for(let n of this.$parent.tiles){if(n.locked||!n.canDragToSelect||!n.transformed)continue;let o=ci(e,n.transformed,n.type);(this.$parent.events.shiftKey&&((i=this.previousSelection)==null?void 0:i.has(n))?!o:o)?this.$parent.selection.add(n,!1,!0):this.$parent.selection.remove(n,!0)}this.$parent.selection.update(!0)}end(){this.activeTile?this.$parent.selection.moveEnd():this.$parent.$selection.hide(),Bt.removeClass("grabbing")}click(t){this.activeTile&&this.activeTile.click(t)}hover(t){let e=this.getTileAt(t,!1);this.hoverGeoTile((e==null?void 0:e.type)==="geo"?e:void 0),this.$parent.$svg.css("cursor",(e==null?void 0:e.locked)?"pointer":e?"grab":"")}},xo=class extends Ve{constructor(){super(...arguments);this.erasedTiles=[];this.erasedStrokes=[];this.name="eraser"}down({posn:t}){this.erase(t)}move({posn:t,lastPosn:e}){let i=c.distance(t,e)/4;for(let n=0;n<i;++n)this.erase(c.interpolate(t,e,n/i))}shouldErase(t,e,i){return ut(e)?c.distance(e,t)<10:yt(e)?e.distanceSquared(t)<100:ji(e)?e.edges.some(n=>n.distanceSquared(t)<100):rt(e)&&i==="geo"?Math.abs(c.distance(t,e.c)-e.r)<10:e.contains(t)}erase(t){for(let e of this.$parent.tiles)if(!(!e.transformed||!e.canDragToSelect||e.locked)&&this.shouldErase(t,e.transformed,e.type)){e.delete(),this.erasedTiles.push(e);return}for(let e of this.$parent.strokes)if(e.hitTest(t,10)){e.delete(),this.erasedStrokes.push(e);return}}end(){(this.erasedTiles.length||this.erasedStrokes.length)&&this.$parent.change({tilesDeleted:this.erasedTiles,strokesDeleted:this.erasedStrokes}),this.erasedTiles=[],this.erasedStrokes=[]}click(){this.end()}},$o=class extends Ve{constructor(){super(...arguments);this.name="text";this.options="text"}down({posn:t}){let e=this.$parent.newTile(this.options,"");e.setTransform(t.shift(-10,-15)),this.$parent.trigger("add-tile",{tile:e}),e.focus(!0)}},To=class extends Ve{constructor(){super(...arguments);this.name="pan"}enable(){this.previousTool=this.$parent.activeTool.name,this.$parent.setActiveTool("pan")}down(t){this.initialOrigin=this.$parent.origin,this.startPosn=Kt(t.event)}move(t){let e=Kt(t.event).subtract(this.startPosn),i=this.initialOrigin.subtract(e.scale(1/this.$parent.zoom));this.$parent.setViewport(i,this.$parent.zoom)}end(){this.$parent.setActiveTool(this.previousTool)}click(){this.end()}},Ls=class extends Ve{constructor(){super(...arguments);this.name="pen";this.options="pen"}getUtensil(t){for(let e of this.$parent.tiles.values()){if(!e.transformed||!da(e))continue;let i=e.transformed.project(t);if(c.distance(t,i)<30)return e.transformed}}getPoint(t){if(this.options==="ruler"){let e=this.$parent.snap([t]);return e?t.add(e.shift):this.startPoint?t.snap(this.startPoint,Op):t}else return this.utensil?this.utensil.project(t):t}down({posn:t}){this.utensil=this.getUtensil(t),this.startPoint=this.getPoint(t),this.stroke=new ee(this.$parent,[this.startPoint],this.$parent.penColour,this.options)}move({posn:t}){let e=this.getPoint(t);this.options==="ruler"?this.stroke.setLine(new H(this.startPoint,e)):this.stroke.addPoint(this.getPoint(e))}click(){this.$parent.change({strokesAdded:[this.stroke]}),this.$parent.trigger("add-stroke",{stroke:this.stroke}),this.stroke=this.startPoint=this.utensil=void 0}end(t){var e;this.options==="ruler"?(e=this.stroke)==null||e.makeSnapPoints():this.stroke.simplify(),this.click()}},Os=class extends Ve{constructor(){super(...arguments);this.name="geo";this.options="line"}expr(t,e){switch(this.options){case"line":return`segment(${t},${e})`;case"circle":return`circle(${t},distance(${t},${e}))`;case"rect":return`rectangle(${t},${e}.x-${t}.x,${e}.y-${t}.y)`}}snapPoint(t){var o,r,a,l;let e=this.$parent.snap([t]);e&&(t=t.add(e.shift));let i="",n=((r=(o=e==null?void 0:e.target)==null?void 0:o.tile)==null?void 0:r.type)==="geo"?(a=e==null?void 0:e.target)==null?void 0:a.tile:void 0;return(n==null?void 0:n.path)&&ut(n.path)&&(i=n.key),((l=e==null?void 0:e.target)==null?void 0:l.intersection)&&(i=e.target.intersection.expr),{point:t,tile:n,expr:i||`point(${t.x},${t.y})`}}getOrMakePointTile(t){var i,n;if(((i=t==null?void 0:t.tile)==null?void 0:i.path)&&ut(t.tile.path))return t.tile;if((n=t==null?void 0:t.tile)==null?void 0:n.path){let o=os(t.tile.path,t.point),r=new j(`${t.tile.key}.at(${o})`,this.$parent);return this.$parent.trigger("add-tile",{tile:r}),r}let e=new j(t.expr,this.$parent);return this.$parent.trigger("add-tile",{tile:e}),e}drawPendingPoint(t){var n,o;let e=((o=(n=t.tile)==null?void 0:n.path)==null?void 0:o.type)==="point",i=t.expr.startsWith("intersection");this.$parent.$pendingPoint.toggle(!e),e||(this.$parent.$pendingPoint.setCenter(t.point),this.$parent.$pendingPoint.setClass("locked",i),this.$parent.$pendingPoint.setAttr("r",i?3.5:6))}down({posn:t}){let e=this.snapPoint(t);this.startPoint=this.getOrMakePointTile(e),this.createdNewStart=!e.tile}start(){var t;this.path=new j("",this.$parent),this.startPoint.pending=this.path.pending=!0,(t=this.$parent.$pendingPoint)==null||t.show(),this.hoverGeoTile(void 0)}move({posn:t}){var e;this.endSnap=this.snapPoint(t),this.path.setExpr(this.expr(this.startPoint.key,this.endSnap.expr),!0),this.drawPendingPoint(this.endSnap),this.hoverGeoTile((e=this.endSnap)==null?void 0:e.tile)}end(){var i;let t=c.distance(this.startPoint.path,this.endSnap.point)<8,e;if(t?this.path.delete():(e=this.getOrMakePointTile(this.endSnap),this.path.setExpr(this.expr(this.startPoint.key,e.key)),this.path.setPending(!1),this.$parent.trigger("add-tile",{tile:this.path})),this.startPoint.setPending(!1),(i=this.$parent.$pendingPoint)==null||i.hide(),this.hoverGeoTile(void 0),j.computeIntersections(this.$parent),this.createdNewStart||!t){let n=[];this.createdNewStart&&n.push(this.startPoint),this.path&&n.push(this.path),e&&n.push(e),this.$parent.change({tilesAdded:n})}this.startPoint=this.path=this.endSnap=void 0}click(){this.createdNewStart&&this.$parent.change({tilesAdded:[this.startPoint]})}hover(t){var i;let e=this.snapPoint(t.posn);this.drawPendingPoint(e),this.hoverGeoTile(((i=e==null?void 0:e.tile)==null?void 0:i.type)==="geo"?e.tile:void 0)}cancel(){this.$parent.$pendingPoint.hide(),this.path&&this.path.delete(),this.startPoint=this.path=this.endSnap=void 0}},So=class extends Os{constructor(){super(...arguments);this.name="geoPending";this.startId="";this.expression=""}enable(t){var e;this.expression=t,this.$parent.selection.clear(),this.$parent.setActiveTool("geoPending"),((e=window.event)==null?void 0:e.clientX)&&this.hover({posn:qt(window.event,this.$parent.$svg)})}makePath(){return this.path=new j("",this.$parent),this.path.$el.css("opacity",.5),this.path.pending=!0,this.path}down(t){if(!this.expression)return;super.down(t);let e=this.path||this.makePath();e.$el.css("opacity",1),e.setExpr(this.expression.replace(/\$1/g,this.startPoint.key)),e.pending=!1,this.path=void 0,this.$parent.setActiveTool("move"),this.$parent.selection.add(e,!0),this.$parent.change({tilesAdded:[e]}),j.computeIntersections(this.$parent),this.$parent.trigger("add-tile",{tile:e})}hover({posn:t}){var i;if(!this.expression)return;let e=this.snapPoint(t);this.drawPendingPoint(e),this.hoverGeoTile(((i=e==null?void 0:e.tile)==null?void 0:i.type)==="geo"?e.tile:void 0),this.path||this.makePath(),this.path.setExpr(this.expression.replace(/\$1/g,e.expr))}cancel(){super.cancel(),this.expression=""}},Mo=class extends Ls{constructor(){super(...arguments);this.name="cutPolygon";this.options="ruler"}enable(t){this.tiles=t;for(let e of this.tiles)e.$outline.addClass("active");this.$parent.selection.clear(),this.$parent.setActiveTool("cutPolygon")}down(){}start({posn:t}){!this.tiles||(this.utensil=this.getUtensil(t),this.startPoint=this.getPoint(t),this.$stroke=d("line",{class:"stroke cut"},this.$parent.$strokes))}move({posn:t}){var e;this.lastPoint=this.getPoint(t),(e=this.$stroke)==null||e.setLine(this.startPoint,this.lastPoint)}end(t){var r;if(t.cancelled)return this.cancel();let e=new st(this.startPoint,this.lastPoint),i=!1,n=[],o=[];for(let a of this.tiles||[]){let h=a.transformed.cut(e);if(h.length>1){for(let p of h){let g=new B(bt(p.points),this.$parent);g.setColour(a.colour),g.transform(),o.push(g)}a.delete(),n.push(a),i=!0}else a.$outline.removeClass("active")}i&&this.$parent.change({tilesAdded:o,tilesDeleted:n}),(r=this.$stroke)==null||r.remove(),this.$stroke=this.tiles=this.startPoint=this.lastPoint=void 0,this.$parent.setActiveTool("move")}click(){this.cancel()}cancel(){var t;for(let e of this.tiles||[])e.$outline.removeClass("active");(t=this.$stroke)==null||t.remove(),this.$stroke=this.tiles=this.startPoint=this.lastPoint=void 0,setTimeout(()=>this.$parent.setActiveTool("move"))}};var Pl='<svg class="canvas" tabindex="0"><defs><pattern class="grid-pattern" id="square2-grid" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse"><rect x="0" y="0" width="50" height="50" opacity="0.1"></rect></pattern><pattern class="grid-pattern" id="square-dots" x="-4" y="-4" width="25" height="25" patternUnits="userSpaceOnUse"><circle cx="4" cy="4" r="2" opacity="0.15"></circle></pattern><pattern class="grid-pattern" id="square-grid" x="0" y="0" width="125" height="125" patternUnits="userSpaceOnUse"><g opacity="0.1"><line x1="25" y1="0" x2="25" y2="125"></line><line x1="0" y1="25" x2="125" y2="25"></line><line x1="50" y1="0" x2="50" y2="125"></line><line x1="0" y1="50" x2="125" y2="50"></line><line x1="75" y1="0" x2="75" y2="125"></line><line x1="0" y1="75" x2="125" y2="75"></line><line x1="100" y1="0" x2="100" y2="125"></line><line x1="0" y1="100" x2="125" y2="100"></line></g><rect x="0" y="0" width="125" height="125" opacity="0.25"></rect></pattern><pattern class="grid-pattern" id="tri-dots" x="0" y="-4" width="25" height="43.30127018922193" patternUnits="userSpaceOnUse"><circle cx="0" cy="4" r="2" opacity="0.15"></circle><circle cx="25" cy="4" r="2" opacity="0.15"></circle><circle cx="12.5" cy="25.650635094610966" r="2" opacity="0.15"></circle></pattern><pattern class="grid-pattern" id="tri-grid" x="0" y="0" width="25" height="43.30127018922193" patternUnits="userSpaceOnUse"><g opacity="0.1"><line x1="0" y1="0" x2="25" y2="0"></line><line x1="0" y1="21.650635094610966" x2="25" y2="21.650635094610966"></line><line x1="0" y1="43.30127018922193" x2="25" y2="43.30127018922193"></line><line x1="0" y1="0" x2="25" y2="43.30127018922193"></line><line x1="25" y1="0" x2="0" y2="43.30127018922193"></line></g></pattern><pattern class="grid-pattern" id="tri2-dots" x="-4" y="0" width="43.30127018922193" height="25" patternUnits="userSpaceOnUse"><circle cx="4" cy="0" r="2" opacity="0.15"></circle><circle cx="4" cy="25" r="2" opacity="0.15"></circle><circle cx="25.650635094610966" cy="12.5" r="2" opacity="0.15"></circle></pattern><pattern class="grid-pattern" id="tri2-grid" x="0" y="0" width="43.30127018922193" height="25" patternUnits="userSpaceOnUse"><g opacity="0.1"><line x1="0" y1="0" x2="0" y2="25"></line><line x1="21.650635094610966" y1="0" x2="21.650635094610966" y2="25"></line><line x1="43.30127018922193" y1="0" x2="43.30127018922193" y2="25"></line><line x1="0" y1="0" x2="43.30127018922193" y2="25"></line><line x1="0" y1="25" x2="43.30127018922193" y2="0"></line></g></pattern><pattern class="grid-pattern" id="square-checked" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse"><rect class="filled" x="0" y="0" width="25" height="25" opacity="0.1"></rect><rect class="filled" x="25" y="25" width="25" height="25" opacity="0.1"></rect></pattern><marker id="axis-arrow" refX="3" refY="3" markerWidth="6" markerHeight="6" orient="auto"><path d="M 0 0 L 6 3 L 0 6 z"></path></marker><radialGradient id="sphere-gradient" cx="65%" cy="35%" r="65%"><stop offset="0" stop-color="white" stop-opacity="0.3"></stop><stop offset="0.32" stop-color="white" stop-opacity="0"></stop><stop offset="0.33" stop-opacity="0"></stop><stop offset="1" stop-opacity="0.2"></stop></radialGradient><filter id="handdrawn" x="-20%" y="-20%" width="140%" height="140%"><feTurbulence type="fractalNoise" basefrequency="0.004 0.004" numoctaves="26" stitchtiles="stitch" result="turbulence"></feTurbulence><feDisplacementMap in="SourceGraphic" in2="turbulence" scale="20" xchannelselector="R" ychannelselector="G" result="displacementMap"></feDisplacementMap></filter><filter id="pencil" x="-10%" y="-10%" width="110%" height="110%" filterUnits="objectBoundingBox"><feTurbulence type="fractalNoise" baseFrequency="1.2" numOctaves="3" result="noise"></feTurbulence><feDisplacementMap xChannelSelector="R" yChannelSelector="G" scale="2" in="SourceGraphic" result="newSource"></feDisplacementMap></filter><symbol id="suit-c" viewBox="-12 -12 24 24" width="24" height="24" x="-12" y="-12"><path d="m0-10c2.3.1 4.2 1.9 4.3 4.2 0 1.6-.9 3-2.3 3.8.8-.3 1.6-.5 2.5-.5 2.4-.1 4.4 1.7 4.5 4.1v.2c0 2.3-1.9 4.2-4.2 4.2-.1 0-.2 0-.3 0-1.2-.1-2.4-.4-3.5-1 0 0-.3 2 2 5h-6c2.3-3 2-5 2-5-1.1.6-2.3.9-3.5 1-2.3.2-4.3-1.6-4.5-3.9 0-.1 0-.2 0-.3 0-2.4 1.9-4.3 4.3-4.3h.2c.9 0 1.7.2 2.5.5-1.4-.8-2.3-2.2-2.3-3.8.1-2.3 2-4.1 4.3-4.2z"></path></symbol><symbol id="suit-s" viewBox="-12 -12 24 24" width="24" height="24" x="-12" y="-12"><path d="m0-10c-3 5-8 7-8 12 .1 2.1 1.9 3.9 4 4 1.1.1 2.2-.2 3-1 0 0 .3 2-2 5h6c-2-3-2-5-2-5 .8.8 1.9 1.1 3 1 2.1-.1 3.9-1.9 4-4 0-5-5-7-8-12z"></path></symbol><symbol id="suit-h" viewBox="-12 -12 24 24" width="24" height="24" x="-12" y="-12"><path d="m0 8.5-1.3-1.3c-4.6-4.1-7.7-6.9-7.7-10.3-.1-2.7 2.1-4.9 4.8-5h.2c1.5 0 3.1.7 4 1.9 1-1.2 2.5-1.9 4-1.9 2.8-.1 4.9 2.1 5 4.8v.2c0 3.4-3.1 6.2-7.7 10.3z"></path></symbol><symbol id="suit-d" viewBox="-12 -12 24 24" width="24" height="24" x="-12" y="-12"><path d="m7 0-7 10-7-10 7-10"></path></symbol><pattern id="card-bg" width="6" height="8" patternUnits="userSpaceOnUse"><rect width="6" height="8" fill="#0f82f2"></rect><line x2="6" y2="8" stroke="#eee" stroke-width="1"></line><line x1="6" y2="8" stroke="#eee" stroke-width="1"></line></pattern></defs><rect class="grid"></rect><g class="tiles"></g><g class="transform-tools" hidden><path class="group-outline"></path><line class="rotate-bar"></line><circle class="rotate-circle" r="10"></circle></g><g class="tiles active"></g><g class="strokes"></g><g class="geo-shadows"></g><g class="geo-paths"></g><g class="geo-points"></g><rect class="selection"></rect></svg><div class="html-overlay"></div><div class="panels"></div><slot></slot>';var Po=3,Ip=new vt(-2e3,4e3,-2e3,4e3),ne=25,ko=ne*Math.sqrt(3)/2,Is=s=>`${s.xMin} ${s.yMin} ${s.dx} ${s.dy}`,Co=class extends Y{constructor(){super(...arguments);this.tiles=new Set;this.strokes=new Set;this.tileMap=new Map;this.strokeMap=new Map;this.penColour="#242436";this.initial={};this.intersections=new Set;this.margins=[20,20,20,20];this.origin=T;this.zoom=1;this.newTileShift=0;this.options=Xt({grid:"none",canEdit:!0,changeCount:0});this.canPinchPan=!1;this.setup=!1;this.undoStack=[];this.redoStack=[]}ready(){this.$svg=this.$("svg.canvas"),this.$tiles=this.$svg.$(".tiles:not(.active)"),this.$activeTiles=this.$svg.$(".tiles.active"),this.$selection=this.$svg.$(".selection"),this.$strokes=this.$svg.$(".strokes"),this.$grid=this.$svg.$(".grid"),this.$html=this.$(".html-overlay"),this.$panels=this.$(".panels"),this.$geoShadows=this.$svg.$(".geo-shadows"),this.$geoPaths=this.$svg.$(".geo-paths"),this.$geoPoints=this.$svg.$(".geo-points"),this.$pendingPoint=d("circle",{class:"geo-point pending",hidden:!0},this.$geoPoints),this.tools={move:new wo(this),pen:new Ls(this),geo:new Os(this),geoPending:new So(this),eraser:new xo(this),text:new $o(this),pan:new To(this),cutPolygon:new Mo(this)},this.activeTool=this.tools.move,this.setAttr("data-tool","move"),this.events=new cn(this.$svg,{down:i=>this.activeTool.down(i),start:i=>this.activeTool.start(i),move:i=>this.activeTool.move(i),end:i=>this.activeTool.end(i),click:i=>this.activeTool.click(i),hover:i=>this.activeTool.hover(i),cursor:!1});let t=this.options;this.$svg.copy=function(i=!0,n=!0,o){let r=li.prototype.copy.call(this,i,n,o);if(t.canEditQuestions)for(let a of r.$$(".problem-text"))a.text="?";return r},this.selection=new bo(this),this.isTeacher=this.attr("user-type")==="teacher",this.options.canEditQuestions=this.isTeacher,this.options.canRotate=hi(this,"rotate",!0),this.options.canDelete=hi(this,"delete",!0),this.options.canCopy=hi(this,"copy",!0),this.options.grid=this.attr("grid")||"none",this.setViewport(T,1),this.options.watch(i=>{this.$grid.setAttr("fill",i.grid!=="none"?`url(#${i.grid})`:"none"),this.$grid.setRect(this.canvasBounds.rect)}),hi(this,"pan",!1)&&this.enablePinchPan(),this.$svg.on("contextmenu",i=>{this.options.focussed||i.preventDefault()});let e=!1;this.$svg.on("focusin",()=>{if(!e)return;let i=Array.from(this.tiles);this.focusTile(this.events.shiftKey?L(i):i[0])}),this.$svg.on("focusout",()=>this.focussed=void 0),U.on("keydown",i=>{if(e=!0,i.keyCode!==9||!this.focussed)return;let n=Array.from(this.tiles);this.focusTile(n[n.indexOf(this.focussed)+(i.shiftKey?-1:1)]),this.focussed&&i.preventDefault()}),U.on("pointerdown",()=>e=!1),w.onThemeChange(()=>{for(let i of this.tiles)i.setColour(i.colour);for(let i of this.strokes)i.setColor(i.color)})}focusTile(t){this.options.focussed||(this.focussed=t,this.$svg.setAttr("aria-description",t?t.ariaDescription:"Empty Canvas"),t&&this.selection.add(t,!0))}*snapPoints(t,e){if(!e){for(let i of j.tiles)if(!(t&&i.isActive||i.pending))for(let n of i.snapPoints)yield[n,{tile:i}]}for(let i of this.tiles)if(!(t&&i.isActive||i.pending||e&&i.type!==e))for(let n of i.snapPoints)yield[n,{tile:i}];for(let i of this.strokes)if(!!i.snapPoints)for(let n of i.snapPoints)yield[n,{stroke:i}];for(let i of this.intersections)yield[i.value,{intersection:i}]}*gridPoints(t){if(this.options.grid==="none")return;let e=this.options.grid.split("-")[0],i=$.aroundPoints(t),n=new vt(i.p.x-ne,i.p.x+i.w+2*ne,i.p.y-ne,i.p.y+i.h+2*ne);if(e.startsWith("square")){let o=(e==="square2"?2:1)*ne,r=pt(n.xMin,o);for(let a=pt(n.yMin,o);a<n.yMax;a+=o)for(let l=r;l<n.xMax;l+=o)yield[new c(l,a),{}]}else if(e.startsWith("tri")){let o=e==="tri2";o&&(n=n.flip);let r=pt(n.xMin,ne);for(let a=Math.floor(n.yMin/ko);a*ko<n.yMax;++a)for(let l=r+(a%2?ne/2:0);l<n.xMax;l+=ne){let h=new c(l,a*ko);yield[o?h.flip:h,{}]}}}*snapLines(t,e){for(let i of this.tiles)if(!(t&&i.isActive||i.pending||e&&i.type!==e))for(let n of i.snapLines)yield[n,{tile:i}];for(let i of this.strokes)if(!!i.snapLines)for(let n of i.snapLines)yield[n,{stroke:i}]}snap(t,e=!0,i=!1,n){return is(8,t,this.snapPoints(e,n))||!i&&is(18,t,this.gridPoints(t))||is(6,t,this.snapLines(e,n),(o,r)=>o.project(r))}enablePinchPan(){this.canPinchPan=!0,this.on("wheel",i=>{if(i.preventDefault(),i.ctrlKey){let n=this.zoom*(1-i.deltaY/100);this.setViewport(this.origin,n,qt(i,this.$svg))}else{let n=this.origin.shift(i.deltaX/this.zoom,i.deltaY/this.zoom);this.setViewport(n,this.zoom)}});let t=0,e=this.origin;this.on("gesturestart",i=>{i.preventDefault(),e=new c(i.pageX,i.pageY).subtract(this.origin),t=this.zoom,this.events.cancel()}),this.on("gesturechange",i=>{i.preventDefault();let n=t*i.scale,o=new c(i.pageX,i.pageY).subtract(e);this.setViewport(o,n,qt(i,this.$svg))}),this.on("gestureend",i=>i.preventDefault())}enableImageDrop(t,e){let i=d("div",{class:"image-drop"},this);this.imageUploadCallback=t,this.on("dragenter dragover dragleave drop",o=>o.preventDefault()),this.on("dragenter dragover",()=>i.show()),this.on("dragleave drop",()=>i.hide());let n=(o,r)=>M(this,null,function*(){let l=Array.from((o==null?void 0:o.files)||[]).slice(0,10).map((p,g)=>this.newImage(p,r.shift(g*25),t)),h=yield Promise.all(l);this.change({tilesAdded:h}),this.trigger("paste")});this.on("drop",o=>n(o.dataTransfer,qt(o,this.$svg))),e==null||e.on("change",()=>M(this,null,function*(){yield n(e._el,this.canvasBounds.center),e.value=""}))}bindSettingsPanel(t,e,i){let n=d("div",{class:"polypad-settings",html:e},this.$panels);this.on("change-selection",({tiles:r})=>{n.toggle(r.length===1&&r[0]===t)});let o=Xt(i);return n.bindModel(o),o}enableHotkeys(){w.onKey("backspace",()=>this.selection.delete()),w.onKey("z",t=>{(t.ctrlKey||t.metaKey)&&(t.preventDefault(),t.shiftKey?this.redo():this.undo())}),w.onKey("y",t=>{(t.ctrlKey||t.metaKey)&&(t.preventDefault(),this.redo())}),w.onKey("c",t=>{var e;t.ctrlKey||t.metaKey||((e=w.getActiveInput())==null?void 0:e.is("input, textarea, [contenteditable]"))||this.selection.copy()}),U.on("cut copy",t=>{var i,n;if(!this.selection.tiles.size||((i=w.getActiveInput())==null?void 0:i.is("input, textarea, [contenteditable]")))return;let e=Array.from(this.selection.tiles).map(o=>o.serialize());(n=window.navigator.clipboard)==null||n.writeText(JSON.stringify(e)),t.type==="cut"&&this.selection.delete()}),U.on("paste",t=>M(this,null,function*(){var n,o;if((n=w.getActiveInput())==null?void 0:n.is("input, textarea, [contenteditable]"))return;let e=_r(t.clipboardData);if(e&&this.imageUploadCallback){let r=yield this.newImage(e,this.center.shift(-50),this.imageUploadCallback);return this.trigger("paste"),this.change({tilesAdded:[r]})}let i=yield(o=window.navigator.clipboard)==null?void 0:o.readText();if(!!i){try{let r=JSON.parse(i);if(!r.length)return;let a=r.map(p=>(p.id=void 0,S.unSerialize(p,this))).filter(p=>p);this.selection.clear();let l=we(...a.map(p=>p.transformed)).center,h=this.center.subtract(l).shift(this.newTileShift*25);for(let p of a)p.setTransform(p.posn.add(h)),this.selection.add(p);this.change({tilesAdded:a}),this.newTileShift+=1}catch(a){let r=this.newTile("text",i);r.setTransform(this.canvasBounds.center.subtract(r.center)),this.selection.add(r,!0),this.change({tilesAdded:[r]})}this.trigger("paste")}}))}newImage(t,e,i){return M(this,null,function*(){let n=new FileReader;n.readAsDataURL(t),yield new Promise(r=>n.onloadend=r);let o=this.newTile("image",(n.result||"").toString());return o.setTransform(e),this.selection.add(o,!0),yield i==null?void 0:i(t,o),o})}newTile(t,e,i){return new(Ri(t))(e,this,i)}setViewport(t,e=1,i){if(e=E(e,1/Po,Po),i){let a=this.zoom/e;t=i.subtract(i.subtract(this.origin).scale(a))}let n=this.width/e,o=this.height/e;this.zoom=e,this.origin=t.clamp(Ip.resize(-n,-o)),this.canvasBounds=new vt(this.origin.x,this.origin.x+n,this.origin.y,this.origin.y+o),this.$svg.setAttr("viewBox",this.attr("viewBox")||Is(this.canvasBounds)),this.$html.setTransform(this.origin.inverse.scale(this.zoom),0,this.zoom);let r=this.canvasBounds.rect;this.options.grid!=="none"&&this.$grid.setRect(r),j.redrawLines(r),this.newTileShift=0,this.trigger("viewport")}resetViewport(){if(!this.tiles.size&&!this.strokes.size)return this.setViewport(T,1);let t=ss(this.tiles,this.strokes,0),[e,i,n,o]=this.margins,r=(this.width-o-i)/t.dx,a=(this.height-e-n)/t.dy,l=E(Math.min(r,a),1/Po,1),h=new c(this.width+o-i,this.height+e-n),p=t.center.subtract(h.scale(1/2/l));this.setViewport(p,l)}bindSource(t,e,i,n,o){Ri(e).makeThumbnail(i,t,this,o);let r,a=n==null?void 0:n.$(".tiles.active");this.events.listen(t,{down:()=>this.trigger("add-tile-start"),start:({posn:l})=>{r=this.newTile(e,t.data.options||i),o&&r.setColour(o),r.setTransform(l),this.selection.add(r,!0),this.selection.moveStart(),n&&n.setAttr("viewBox",Is(this.canvasBounds)),(a||this.$tiles).append(r.$el),this.trigger("add-tile",{tile:r})},move:l=>this.selection.move(l),end:()=>{this.$activeTiles.append(r.$el),this.selection.moveEnd(!0)},click:()=>{let l=this.newTile(e,t.data.options||i);l.setTransform(this.center.subtract(l.center).shift(this.newTileShift*25)),o&&l.setColour(o),this.selection.add(l,!0),l.moveEnd(),this.trigger("add-tile",{tile:l}),this.change({tilesAdded:[l]}),this.newTileShift+=1}})}get center(){let[t,e,i,n]=this.margins;return this.canvasBounds.center.shift((n-e)/this.zoom/2,(t-i)/this.zoom/2)}setColour(t="#242436"){if(this.penColour=t,this.$pendingPoint.css("color",O(t)),this.options.focussed)return this.options.focussed.setColour(t);for(let e of this.selection.tiles)e.setColour(t||"");this.selection.tiles.size&&this.change({tilesChanged:Array.from(this.selection.tiles)})}setActiveTool(t,e){this.activeTool.cancel(),this.activeTool=this.tools[t],e&&(this.activeTool.options=e),this.setAttr("data-tool",t),this.selection.clear()}clear(t=!0){this.selection.clear();for(let e of this.tiles)e.delete();for(let e of this.strokes)e.delete();t&&this.setViewport(T,1),this.change()}thumbnail(t,e){let i=ss(this.tiles,this.strokes,50);return this.$svg.pngImage(t,e,Is(i))}downloadImage(t){var n;this.selection.clear();let e=t||((n=this.options.title)==null?void 0:n.replace(/\s/g,"-").replace(/[^\w-]/g,"").toLowerCase())||"polypad",i=ss(this.tiles,this.strokes,50);this.$svg.downloadImage(`${e}.png`,i.dx,i.dy,Is(i))}change(t){this.setup||(this.trigger("change-internal",t||{}),this.trigger("change",t||{}),this.undoStack.push(this.serialize()),this.undoStack.length>20&&this.undoStack.shift(),this.redoStack=[],this.options.canUndo=!0,this.options.canRedo=!1,this.options.changeCount+=1)}undo(){let t=new Event("undo",{cancelable:!0});this.trigger("undo",t),this.options.canRedo=!0,!(t.defaultPrevented||!this.undoStack.length)&&(this.redoStack.push(this.undoStack.pop()),this.unSerialize(L(this.undoStack)||this.initial),this.options.canUndo=!!this.undoStack.length,this.options.changeCount-=1,this.trigger("change"))}redo(){let t=new Event("redo",{cancelable:!0});this.trigger("redo",t),this.options.canUndo=!0,!(t.defaultPrevented||!this.redoStack.length)&&(this.undoStack.push(this.redoStack.pop()),this.unSerialize(L(this.undoStack)||this.initial),this.options.canRedo=!!this.redoStack.length,this.options.changeCount+=1,this.trigger("change"))}serialize(t=2e3,e=1e3,i=16e3){var n;return{title:(n=this.options.title)==null?void 0:n.slice(0,30),grid:this.options.grid||"none",background:this.options.background,noLabels:this.options.noLabels,altColors:this.options.altColors,mergeTiles:this.options.mergeTiles,tiles:Array.from(this.tiles).slice(0,t).map(o=>o.serialize()),strokes:Array.from(this.strokes).slice(0,e).map(o=>o.serialize(i))}}unSerialize(t){if(!!t){this.setup=!0,this.clear(!1),j.clearModel();for(let e of t.tiles||[])S.unSerialize(e,this);for(let e of t.strokes||[])ee.unSerialize(e,this);j.computeIntersections(this);for(let e of this.tiles)e.move();this.setup=!1}}load(t){var e,i;this.initial=t,this.options.canEditQuestions=this.isTeacher&&((e=t.canEdit)!=null?e:!0),this.unSerialize(t),this.undoStack=this.redoStack=[],this.options.key=t.key,this.options.grid=t.grid||"none",this.options.thumbnail=t.thumbnail,this.options.title=t.title||"Untitled",this.options.canEdit=(i=t.canEdit)!=null?i:!0,this.options.canUndo=!1,this.options.changeCount=0,"noLabels"in t&&(this.options.noLabels=t.noLabels),"altColors"in t&&(this.options.altColors=t.altColors),"mergeTiles"in t&&(this.options.mergeTiles=t.mergeTiles),this.resetViewport()}};Co=Q([et("x-polypad",{template:Pl})],Co);var Ee=d("div",{class:"modal-background"},U),Rs,oe,Ao;function Vo(){oe&&oe.canClose&&oe.close()}Ee.on("click",Vo);w.onKey("escape",Vo);Gt.on("change",Vo);Ee.on("scrollwheel touchmove",s=>{s.preventDefault(),s.stopPropagation()});w.onKey("space up down pagedown pageup",s=>{oe&&(s.preventDefault(),s.stopPropagation())});var ei=class extends Y{constructor(){super(...arguments);this.isOpen=!1;this.canClose=!0}ready(){this.canClose=!this.hasAttr("no-close"),this.$iframe=this.$("iframe[data-src]"),this.$video=this.$("video");let t=tn(`[data-modal=${this.id}]`);for(let i of t)i.on("click",()=>this.open());Gt.on("afterChange",({$viewport:i})=>{let n=i.$$(`[data-modal=${this.id}]`);for(let o of n)o.on("click",()=>this.open())}),this.hasClass("open")&&!oe&&this.open(!0),this.$("input")&&this.addClass("interactive");let e=this.$(".close");e&&e.on("click",()=>this.close());for(let i of this.$$(".btn"))i.on("click",()=>this.trigger("btn-click",i))}open(t=!1){if(this.isOpen)return;Ee.setClass("light",this.hasClass("light")),oe?oe.close(!0):t?Ee.show():Ee.css("display")==="block"?Rs==null||Rs.cancel():Ee.enter("fade",250),this.isOpen=!0,oe=this,this.$iframe&&this.$iframe.setAttr("src",this.$iframe.data.src),this.$video&&this.$video.play(),t?this.show():this.enter("pop",250).promise.then(()=>this.css("transform","")),this.setAttr("role","dialog"),this.trigger("open"),Ao=document.activeElement;let e=this.$('input, a, button, textarea, [tabindex="0"]');e&&e.focus()}close(t=!1,e=!1){!this.isOpen||(this.isOpen=!1,this.removeAttr("role"),oe=void 0,this.$iframe&&this.$iframe.setAttr("src",""),this.$video&&this.$video.pause(),t||(Rs=Ee.exit("fade",250)),this.exit("pop",250).promise.then(()=>this.css("transform","")),e||this.trigger("close"),Ao&&Ao.focus())}static confirm(t){return M(this,null,function*(){var n;let e=Z(t);if(!e)return"";e.open();let i=yield new Promise(o=>e.one("close btn-click",o));return e.close(),((n=i==null?void 0:i.data)==null?void 0:n.prompt)||""})}};ei=Q([et("x-modal")],ei);var Eo=class extends Y{ready(){let t=this.children.filter(r=>["H2","H3","H4"].includes(r.tagName)),e=t.map(r=>r.data.key),i=this.attr("storage"),n=i?e.indexOf(w.getStorage(i)):-1,o=t[n>=0?n:0];this.hasAttr("closed")&&(o=void 0);for(let[r,a]of t.entries()){let l=a.next;l.toggle(a===o),l.css("overflow","hidden"),a===o&&a.addClass("active"),a.setAttr("tabindex","0"),a.on("click",()=>{a===o?(a.removeClass("active"),l.exit("reveal",300),o=void 0,i&&w.setStorage(i,"")):(o==null||o.removeClass("active"),o==null||o.next.exit("reveal",300),l.enter("reveal",300),a.addClass("active"),o=a,i&&w.setStorage(i,e[r]||r)),a.blur()})}}};Eo=Q([et("x-accordion")],Eo);var Lo=680,Rp='<div class="thumb"></div><div class="title"></div>',Oo=new Map;function kl(s,t=!1){return M(this,null,function*(){if(t&&Oo.has(s))return Oo.get(s);let e=yield fetch(s);if(!e.ok)return Promise.reject(e.statusText);let i=yield e.json();return Oo.set(s,i),i})}var Io=class extends Y{constructor(){super(...arguments);this.savedCount=0;this.classes={}}ready(){Gt.setup({preloaded:!0,click:!0,history:!0,noLoad:!0}),Gt.paths("/polypad","/polypad/:key"),this.$buttons=this.$$(".sidebar-header button"),this.$panels=this.$$(".sidebar-panel"),this.savedCount=this.$$("#saved .canvas").length;for(let[i,n]of this.$buttons.entries())n.on("click",()=>this.toggleTab(i));this.on("clickOutside",()=>{w.width<Lo&&this.close()});let t=this.$$(".sidebar-panel").length-1,e=E(+w.getStorage("polypad.sidebar")||0,-1,t);w.width<Lo&&(e=-1),this.active=e>=0?e:void 0,e>=0&&(this.setPanelClasses(e),this.$panels[e].show()),this.show()}bindPolypad(t,e){let i=this.model=t.options;for(let n of this.$$(".primes, .current, .dynamic"))n.bindModel(i);i.save=()=>this.saveChanges(t),i.saveCopy=()=>this.saveChanges(t,!0),i.deleteMe=()=>this.delete(t);for(let n of this.$$(".source")){let o=n.data.type,r=n.data.options;t.bindSource(n,o,r,e,n.data.colour)}t.on("add-tile",()=>{w.width<Lo&&this.close()}),this.on("toggle",n=>t.margins[3]=n.open?324:32),window.onbeforeunload=()=>{if(!(!window.user||i.changeCount===0))return"Your changes may not be saved."},Gt.beforeChange=()=>M(this,null,function*(){return!window.user||i.changeCount===0?!0:(yield ei.confirm("#unsaved"))==="yes"}),Gt.on("change",n=>this.load(n.slice(9),t)),this.setupClassroom(t,i)}setPanelClasses(t){for(let[e,i]of this.$panels.entries())i.setClass("left",e<t),i.setClass("right",e>t);this.addClass("open"),this.$buttons[t].addClass("active")}toggleTab(t){if(this.active===t)return this.close();clearTimeout(this.timeout),this.active===void 0?(this.setPanelClasses(t),this.$panels[t].show(),this.trigger("toggle",{open:!0})):(this.$panels[t].show(),w.redraw(),this.setPanelClasses(t),this.$buttons[this.active].removeClass("active")),this.active=t,w.setStorage("polypad.sidebar",t),this.timeout=setTimeout(()=>{for(let[e,i]of this.$panels.entries())i.toggle(e===t)},400)}close(){this.active!==void 0&&(clearTimeout(this.timeout),this.trigger("toggle",{open:!1}),this.$buttons[this.active].removeClass("active"),this.removeClass("open"),this.active=void 0,w.setStorage("polypad.sidebar",-1),this.timeout=setTimeout(()=>{for(let t of this.$panels)t.hide()},400))}focus(){var t;(t=this.$("button, input, [tabindex]"))==null||t.focus()}get isOpen(){return this.active!==void 0}load(t,e){return M(this,null,function*(){if(t){Gt.showLoadingBar();try{e.load(yield kl(`/polypad/data/${t}.json`))}catch(i){Ct("load-error"),e.load({}),w.setURL("/polypad")}Gt.hideLoadingBar()}else e.load({})})}saveChanges(t,e=!1){return M(this,null,function*(){var p;if(!t.tiles.size&&!t.strokes.size)return Ct("no-content");if(this.savedCount>=100)return Ct("max-save");if(this.model.loading)return;this.model.loading=!0,t.selection.clear();let i=yield t.thumbnail(432,288),n=(yield(yield fetch(i)).arrayBuffer()).slice(0,1e6),o=new FormData;o.append("thumbnail",new Blob([n],{type:"image/png"})),o.append("polypad",JSON.stringify(t.serialize()));let r=this.model.key,a=e||!this.model.key||!this.model.canEdit,l=a?void 0:this.model.key;a&&this.model.key&&o.append("parent",this.model.key);try{let g="/polypad"+(l?"/"+l:""),y=JSON.parse(yield oi(g,o));if(this.model.key=y.key,this.model.thumbnail=y.thumbnail,!l){l=this.model.key,this.model.canEdit=!0,Gt.replace(`/polypad/${l}`),this.savedCount+=1;let x=d("a",{href:`/polypad/${l}`,class:"canvas",html:Rp,key:l});(p=this.$("#saved"))==null||p.prepend(x),x.enter("pop")}Ct("save-success")}catch(g){Ct("save-error")}let h=this.$(`#assigned a.canvas[key="${r}"]`);h==null||h.setAttr("key",this.model.key),h==null||h.setAttr("href",`/polypad/${this.model.key}`);for(let g of this.$links)g.$(".thumb").css("background-image",`url(${this.model.thumbnail})`),g.$(".title").text=this.model.title||"";this.model.changeCount=0,this.model.loading=!1})}delete(t){return M(this,null,function*(){if(!(this.model.loading||!this.model.key||!this.model.canEdit)&&(yield ei.confirm("#delete"))==="yes"){this.model.loading=!0;try{yield oi(`/polypad/${this.model.key}/delete`)}catch(e){return Ct("delete-error")}for(let e of this.$links)e.exit("pop",500,0,!0);t.load({}),Gt.replace("/polypad"),this.model.loading=!1,Ct("delete-success")}})}get $links(){return this.$$(`a.canvas[key="${this.model.key}"]`)}setupClassroom(t,e){var r;let i=this.$(".classroom");if(!i)return;i.bindModel(e);for(let a of this.$$("x-popup"))(r=a.$("x-select"))==null||r.on("change",()=>a.close());let n=i.$("x-select");for(let[a,l]of Object.entries(n.$options)){let h={};for(let p of l.attr("assigned").split(","))h[p]=!0;this.classes[a]={title:l.text,polypads:h}}let o=w.getStorage("polypad.classCode");o&&this.classes[o]&&(e.classCode=o),e.setAssigned=a=>this.setAssigned(a),e.refreshStudents=()=>this.loadStudentData(),e.hideNames=!!w.getStorage("polypad.hideNames"),e.toggleNames=()=>{e.hideNames=!e.hideNames,w.setStorage("polypad.hideNames",e.hideNames?"1":void 0)},e.watch(()=>{var l;let a=this.model.classCode;w.setStorage("polypad.classCode",a),this.model.className=a?(l=this.classes[a])==null?void 0:l.title:""}),e.watch(({key:a,canEdit:l,thumbnail:h,classCode:p})=>{var x;let g=t.initial,y=(g==null?void 0:g.parent)||(a&&l?{key:a,thumbnail:h}:void 0);this.model.assignment=y,this.model.assigned=p&&y?(x=this.classes[p])==null?void 0:x.polypads[y.key]:!1}),e.watch(()=>this.loadStudentData(!0))}loadStudentData(t=!1){return M(this,null,function*(){var n;let e=(n=this.model.assignment)==null?void 0:n.key,i=this.model.classCode;if(!(!i||!e)){this.model.loadingStudents=!0;try{this.model.students=yield kl(`/polypad/${e}/class/${i}?format=json`,t)}catch(o){Ct("student-list-error")}this.model.loadingStudents=!1}})}setAssigned(t){return M(this,null,function*(){var n;let e=this.model.classCode,i=(n=this.model.assignment)==null?void 0:n.key;if(!(t===this.model.assigned||!i||!e)){this.model.assigned=this.classes[e].polypads[i]=t;try{yield oi("/polypad/assign",{class:e,key:i,assigned:t}),Ct(t?"assign-success":"unassign-success")}catch(o){Ct("assign-error"),this.model.classCode===e&&this.model.key===i&&(this.model.assigned=!t)}}})}};Io=Q([et("x-polypad-sidebar")],Io);var Cl='<x-select><button class="switch" data-value="palette" title="Colour Swatches"><x-icon name="tiles" size="32"></x-icon></button><button class="switch" data-value="sliders" title="RGB Sliders"><x-icon name="controls" size="32"></x-icon></button></x-select><div class="color-content"><div class="palette"></div><div class="sliders"><div class="slider-row"><label>Red</label><div class="slider"><div class="handle"></div></div></div><div class="slider-row"><label>Green</label><div class="slider"><div class="handle"></div></div></div><div class="slider-row"><label>Blue</label><div class="slider"><div class="handle"></div></div></div></div></div>';var Ro=["#fd8c00","#eb4726","#cd0e66","#6d3bbf","#0f82f2","#009ea6","#22ab24","#bfc212"],Le=[];for(let s of Ro)Le.push(V.mix(s,"#fff",.5));Le.push(V.fromHex("#eee"));for(let s of Ro)Le.push(V.fromHex(s));Le.push(V.fromHex("#777"));for(let s of Ro)Le.push(V.mix(s,"#000",.7));Le.push(V.fromHex("#111"));function Go(s,t,e,i,n,o){return`linear-gradient(90deg, rgb(${s},${t},${e}), rgb(${i},${n},${o}))`}function Gp(s,t,e){t==="r"&&(s.r=e),t==="g"&&(s.g=e),t==="b"&&(s.b=e)}function Dp(s,t){return t==="r"?s.r:t==="g"?s.g:s.b}var Do=class extends Y{constructor(){super(...arguments);this.sliders=[];this.swatches=[]}ready(){this.$("x-select").on("change",i=>{i.data.value==="palette"?this.removeClass("custom"):this.addClass("custom")});let e=this.$(".palette");this.swatches=Le.map(i=>{let n=d("button",{style:`background: ${i.hex}`},e);return n.on("click",()=>{this.setColor(i),this.trigger("click-swatch")}),{$el:n,color:i}}),this.sliders=this.$$(".slider").map((i,n)=>{let o=["r","g","b"][n],r=i.$(".handle"),a=new Ps(r,{moveY:!1,bounds:new vt(0,210,0,0)});return a.on("start",()=>r.addClass("active")),a.on("end",()=>r.removeClass("active")),a.on("drag",({posn:l})=>{let h=this.color.copy();Gp(h,o,l.x*255/210),this.setColor(h,!0)}),{$el:i,c:o,drag:a}}),this.setColor(new V(0,0,0))}setColor(t,e=!1,i=!1){if(typeof t=="string"&&(t=V.fromHex(t)),!(this.color&&this.color.hex===t.hex)){if(this.color=t,this.$activeSwatch&&(this.$activeSwatch.removeClass("active"),this.$activeSwatch=void 0),!e){for(let n of this.swatches)if(n.color.hex===t.hex){n.$el.addClass("active"),this.$activeSwatch=n.$el;break}for(let n of this.sliders)n.drag.setPosition(Dp(t,n.c)/255*210,0)}this.sliders[0].$el.css("background",Go(0,t.g,t.b,255,t.g,t.b)),this.sliders[1].$el.css("background",Go(t.r,0,t.b,t.r,255,t.b)),this.sliders[2].$el.css("background",Go(t.r,t.g,0,t.r,t.g,255)),i||this.trigger("change",t)}}};Do=Q([et("x-color-picker",{template:Cl})],Do);var Np=["pen","text","geo"],No=class extends Y{ready(){this.bindModel(Xt({tool:"move",penType:"normal",brush:"pen",geoType:"line"})),this.$imageUpload=this.$("#image-upload")}bindPolypad(t){t.options.watch(r=>this.model.focussed=r.focussed),this.model.action=(r,a)=>{var l;t.selection.action(r,a),(l=window.ga)==null||l.call(window,"send","event","Polypad",`action:${a}`)},this.model.format=r=>{var a;this.model.focussed?(a=this.model.focussed)==null||a.format(r):t.selection.action("text",r)},this.model.stop=r=>{t.options.focussed&&r.preventDefault()},this.model.construct=r=>{var a,l;j.construct(r,(a=this.model.geo)==null?void 0:a.expr,t),(l=window.ga)==null||l.call(window,"send","event","Polypad",`construct:${r}`)},this.model.cutPolygon=()=>{var a;let r=Array.from(t.selection.tiles);t.tools.cutPolygon.enable(r),(a=window.ga)==null||a.call(window,"send","event","Polypad","action:cut-polygon")},this.model.tileType=r=>{let a=r.split(" ");for(let l of this.model.tiles||[])if(!a.includes(l.type))return!1;return!0},this.model.canSplitTiles=()=>{let r=this.model.tiles;return r==null?void 0:r.some(a=>a.count>1)},this.model.canMergeFractionBars=()=>{var a,l,h;let r=(l=(a=this.model.tiles)==null?void 0:a[0])==null?void 0:l.denominator;return(h=this.model.tiles)==null?void 0:h.every(p=>p.denominator===r)};let e=this.$("x-popup.color-picker"),i=this.$("x-color-picker"),n=this.$(".color-picker .popup-target"),o=(r,a)=>{n==null||n.setClass("rainbow",!r),n==null||n.css("background-color",r||""),this.model.color=r||"",a||i==null||i.setColor(r||"#aaa",!1,!0)};i==null||i.on("change",r=>{o(r.hex,!0),t.setColour(O(r.hex))}),i==null||i.on("click-swatch",()=>e==null?void 0:e.close()),t.on("change-selection",({tiles:r,color:a})=>{this.model.tiles=r,this.model.geo=j.getInferredShape(r),o(r.length?O(a):void 0,!1)}),t.on("add-tile-start paste",()=>this.model.tool="move"),t.on("add-tile",({tile:r})=>{["text","equation"].includes(r.type)&&(this.model.tool="move")}),this.model.watch(r=>{let a={pen:r.penOptions,geo:r.geoOptions,text:r.textOptions};t.setActiveTool(r.tool,a[r.tool]),Np.includes(r.tool)&&o(O(t.penColour))}),w.onThemeChange(()=>o(O(t.penColour))),this.show()}focus(){var t;(t=this.$("button, input, [tabindex]"))==null||t.focus()}};No=Q([et("x-polypad-toolbar")],No);var zo=class extends Y{bindPolypad(t){let e=this.parents(".polypad")[0],i=t.options;this.bindModel(i),i.fullscreen=!1,i.expand=()=>{i.fullscreen=!i.fullscreen,i.fullscreen?e==null||e._el.requestFullscreen():document.exitFullscreen()},document.addEventListener("fullscreenchange",()=>{i.fullscreen=!!document.fullscreenElement}),i.undo=()=>t.undo(),i.redo=()=>t.redo(),i.resetZoom=()=>t.resetViewport(),i.download=()=>t.downloadImage(),i.zoom=r=>{let a=t.canvasBounds.center;t.setViewport(t.origin,t.zoom*r,a)},i.pan=()=>t.tools.pan.enable(),this.watch(i,"altColors"),this.watch(i,"mergeTiles",void 0,!0),this.watch(i,"noLabels",r=>e==null?void 0:e.setClass("no-labels",r)),this.watch(i,"handdrawn",r=>t.setClass("handdrawn",r)),this.model.showHanddrawn=w.isChrome&&!w.isMobile;let n=Z("#share x-share"),o=Z("#share .warn");t.options.watch(r=>{o==null||o.toggle(r.changeCount!==0),n==null||n.setAttr("title","Polypad \u2013 "+(r.title||"Virtual Manipulatives")),n==null||n.setAttr("url","https://mathigon.org/polypad"+(r.key?"/"+r.key:"")),n==null||n.setAttr("img",r.thumbnail||"https://mathigon.org/images/og-tile/polypad.jpg")})}watch(t,e,i,n=!1){var r;let o="polypad."+e;t[e]=(r=w.getStorage(o))!=null?r:n,t.watch(a=>{w.setStorage(o,a[e]),i==null||i(!!a[e])})}focus(){var t;(t=this.$("button, input, [tabindex]"))==null||t.focus()}};zo=Q([et("x-polypad-settings")],zo);var zp=["polygons","tangram","polyominoes","utensils","penrose","kolam","fractals","tantrix","number-tiles","number-bars","number-line","primes","number-cards","decimal-grid","abacus","dots","fraction-bars","fraction-circles","algebra-tiles","axes","balance","probability","non-trans-dice"],qp=["move","pen","geo","text","eraser","color"],_p=["fullscreen","undo","grid","options","download","zoom"],Bp=[["sidebar",zp],["toolbar",qp],["settings",_p]],qo=class extends Y{ready(){this.bindModel(Xt({}));let t=Z("x-polypad");t==null||t.options.watch(e=>this.model.key=e.key?"/"+e.key:""),this.model.watch(e=>{let i=[];for(let[n,o]of Bp)e[n]?o.every(r=>e[r])||i.push(n+"="+o.filter(r=>e[r]).join(",")):i.push(n+"=hidden");e.copy||i.push("copy=no"),e.delete||i.push("delete=no"),e.rotate||i.push("rotate=no"),e.pan&&i.push("pan=yes"),this.model.query=i.length?"?"+i.join("&"):""})}};qo=Q([et("x-polypad-embed")],qo);var Al='<x-polypad-sidebar tabs="1"><div class="sidebar-header"><button><x-icon name="widgets"></x-icon><span>Tiles</span><x-icon class="close" name="close"></x-icon></button></div><div class="sidebar-body"><x-accordion class="sidebar-panel"><h2 class="m-red" data-key="geometry"><x-icon name="geometry" size="18"></x-icon> Geometry</h2><x-accordion class="subsection" storage="polypad.tiles-geometry"><h3 data-key="polygons" tabindex="0">Polygons</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="equ-triangle" data-type="polygon" data-options="equ-triangle"></div><div class="source" tabindex="0" aria-label="square" data-type="polygon" data-options="square"></div><div class="source" tabindex="0" aria-label="reg-pentagon" data-type="polygon" data-options="reg-pentagon"></div><div class="source" tabindex="0" aria-label="reg-hexagon" data-type="polygon" data-options="reg-hexagon"></div><div class="source" tabindex="0" aria-label="reg-heptagon" data-type="polygon" data-options="reg-heptagon"></div><div class="source" tabindex="0" aria-label="reg-octagon" data-type="polygon" data-options="reg-octagon"></div><div class="source" tabindex="0" aria-label="reg-decagon" data-type="polygon" data-options="reg-decagon"></div><div class="source" tabindex="0" aria-label="reg-dodecagon" data-type="polygon" data-options="reg-dodecagon"></div><div class="source" tabindex="0" aria-label="Custom Polygon" data-type="custom-polygon"></div><div class="source" tabindex="0" aria-label="trapezium" data-type="polygon" data-options="trapezium"></div><div class="source" tabindex="0" aria-label="rhombus" data-type="polygon" data-options="rhombus"></div><div class="source" tabindex="0" aria-label="rhombus-2" data-type="polygon" data-options="rhombus-2"></div><div class="source" tabindex="0" aria-label="rectangle" data-type="polygon" data-options="rectangle"></div><div class="source" tabindex="0" aria-label="right-triangle" data-type="polygon" data-options="right-triangle"></div><div class="source" tabindex="0" aria-label="right-triangle-2" data-type="polygon" data-options="right-triangle-2"></div><div class="source" tabindex="0" aria-label="chevron" data-type="polygon" data-options="chevron"></div><div class="source" tabindex="0" aria-label="kite" data-type="polygon" data-options="kite"></div><div class="source" tabindex="0" aria-label="dart" data-type="polygon" data-options="dart"></div></div></section><h3 data-key="tangram" tabindex="0">Tangram</h3><section><div class="subtitle">Classic Tangram</div><div class="source-wrap"><svg width="148" height="148"><path class="source polygon-tile" tabindex="0" aria-label="Tangram Tile 1" data-type="tangram" data-options="0"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Tile 2" data-type="tangram" data-options="1"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Tile 3" data-type="tangram" data-options="2"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Tile 4" data-type="tangram" data-options="3"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Tile 5" data-type="tangram" data-options="4"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Tile 6" data-type="tangram" data-options="5"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Tile 7" data-type="tangram" data-options="6"></path></svg></div><div class="subtitle">Magic Egg</div><div class="source-wrap"><svg width="148" height="190"><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 1" data-type="egg" data-options="0"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 2" data-type="egg" data-options="1"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 3" data-type="egg" data-options="2"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 4" data-type="egg" data-options="3"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 5" data-type="egg" data-options="4"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 6" data-type="egg" data-options="5"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 7" data-type="egg" data-options="6"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 8" data-type="egg" data-options="7"></path><path class="source polygon-tile" tabindex="0" aria-label="Tangram Egg Tile 9" data-type="egg" data-options="8"></path></svg></div></section><h3 data-key="polyominoes" tabindex="0">Polyominoes</h3><section><div class="subtitle">Pentominoes</div><div class="source-wrap"><svg width="242" height="102"><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 1" data-type="pentomino" data-options="0"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 2" data-type="pentomino" data-options="1"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 3" data-type="pentomino" data-options="2"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 4" data-type="pentomino" data-options="3"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 5" data-type="pentomino" data-options="4"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 6" data-type="pentomino" data-options="5"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 7" data-type="pentomino" data-options="6"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 8" data-type="pentomino" data-options="7"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 9" data-type="pentomino" data-options="8"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 10" data-type="pentomino" data-options="9"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 11" data-type="pentomino" data-options="10"></path><path class="source polygon-tile" tabindex="0" aria-label="Pentomino 12" data-type="pentomino" data-options="11"></path></svg></div><div class="subtitle">Tetrominoes</div><div class="source-wrap"><svg width="122" height="82"><path class="source polygon-tile" tabindex="0" aria-label="Tetromino 1" data-type="pentomino" data-options="12"></path><path class="source polygon-tile" tabindex="0" aria-label="Tetromino 2" data-type="pentomino" data-options="13"></path><path class="source polygon-tile" tabindex="0" aria-label="Tetromino 3" data-type="pentomino" data-options="14"></path><path class="source polygon-tile" tabindex="0" aria-label="Tetromino 4" data-type="pentomino" data-options="15"></path><path class="source polygon-tile" tabindex="0" aria-label="Tetromino 5" data-type="pentomino" data-options="16"></path></svg></div></section><h3 data-key="penrose" tabindex="0">Penrose Tiles</h3><section><div class="subtitle">Kite and Dart</div><div class="source-wrap"><div class="source" tabindex="0" aria-label="0" data-type="penrose" data-options="0"></div><div class="source" tabindex="0" aria-label="1" data-type="penrose" data-options="1"></div><p class="caption">The white circle arcs have to line up when connecting adjacent tiles.</p></div><div class="subtitle">Nature Tiles</div><div class="source-wrap"><div class="source" tabindex="0" aria-label="Garden tile 1" data-type="garden" data-options="1"></div><div class="source" tabindex="0" aria-label="Garden tile 3" data-type="garden" data-options="3"></div><div class="source" tabindex="0" aria-label="Garden tile 4" data-type="garden" data-options="4"></div><div class="source" tabindex="0" aria-label="Garden tile 0" data-type="garden" data-options="0"></div><div class="source" tabindex="0" aria-label="Garden tile 6" data-type="garden" data-options="6"></div><div class="source" tabindex="0" aria-label="Garden tile 7" data-type="garden" data-options="7"></div><div class="source" tabindex="0" aria-label="Garden tile 2" data-type="garden" data-options="2"></div><div class="source" tabindex="0" aria-label="Garden tile 5" data-type="garden" data-options="5"></div></div></section><h3 data-key="kolam" tabindex="0">Kolam Tiles</h3><section><div class="source-wrap" style="max-width: 220px"><div class="source" tabindex="0" data-type="kolam" data-options="0"></div><div class="source" tabindex="0" data-type="kolam" data-options="1"></div><div class="source" tabindex="0" data-type="kolam" data-options="2"></div><div class="source" tabindex="0" data-type="kolam" data-options="3"></div><div class="source" tabindex="0" data-type="kolam" data-options="4"></div><div class="source" tabindex="0" data-type="kolam" data-options="5"></div><p class="caption">Learn more at $0</p></div></section><h3 data-key="fractals" tabindex="0">Fractals</h3><section><div class="source-wrap"><div class="source" tabindex="0" data-type="fractal" data-options="0"></div><div class="source" tabindex="0" data-type="fractal" data-options="1"></div><div class="source" tabindex="0" data-type="fractal" data-options="2"></div><div class="source" tabindex="0" data-type="fractal" data-options="3"></div><div class="source" tabindex="0" data-type="fractal" data-options="4"></div></div></section><h3 data-key="tantrix" tabindex="0">Tantrix Tiles</h3><section><div class="source-wrap"><div class="source" tabindex="0" data-type="tantrix" data-options="0"></div><div class="source" tabindex="0" data-type="tantrix" data-options="1"></div><div class="source" tabindex="0" data-type="tantrix" data-options="2"></div><div class="source" tabindex="0" data-type="tantrix" data-options="3"></div><div class="source" tabindex="0" data-type="tantrix" data-options="4"></div><div class="source" tabindex="0" data-type="tantrix" data-options="5"></div><div class="source" tabindex="0" data-type="tantrix" data-options="6"></div><div class="source" tabindex="0" data-type="tantrix" data-options="7"></div><div class="source" tabindex="0" data-type="tantrix" data-options="8"></div><div class="source" tabindex="0" data-type="tantrix" data-options="9"></div><div class="source" tabindex="0" data-type="tantrix" data-options="10"></div><div class="source" tabindex="0" data-type="tantrix" data-options="11"></div><div class="source" tabindex="0" data-type="tantrix" data-options="12"></div><div class="source" tabindex="0" data-type="tantrix" data-options="13"></div></div></section></x-accordion><h2 class="m-orange" data-key="numbers"><x-icon name="numbers" size="18"></x-icon> Numbers</h2><x-accordion class="subsection" storage="polypad.tiles-numbers"><h3 data-key="number-tiles" tabindex="0">Number Tiles</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="One" data-type="number-tile" data-options="1:1"></div><div class="source" tabindex="0" aria-label="Ten" data-type="number-tile" data-options="10:10"></div><div class="source" tabindex="0" aria-label="Hundred" data-type="number-tile" data-options="10:100"></div></div></section><h3 data-key="number-bars" tabindex="0">Number Bars</h3><section><div class="source-wrap" style="max-width: 250px"><div class="source" tabindex="0" data-type="number-bar" data-options="1"></div><div class="source" tabindex="0" data-type="number-bar" data-options="10"></div><div class="source" tabindex="0" data-type="number-bar" data-options="2"></div><div class="source" tabindex="0" data-type="number-bar" data-options="9"></div><div class="source" tabindex="0" data-type="number-bar" data-options="3"></div><div class="source" tabindex="0" data-type="number-bar" data-options="8"></div><div class="source" tabindex="0" data-type="number-bar" data-options="4"></div><div class="source" tabindex="0" data-type="number-bar" data-options="7"></div><div class="source" tabindex="0" data-type="number-bar" data-options="5"></div><div class="source" tabindex="0" data-type="number-bar" data-options="6"></div></div></section><h3 data-key="primes" tabindex="0">Prime Factor Circles</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Prime Disk for 1" data-type="prime-disk" data-options="1"></div><div class="source" tabindex="0" aria-label="Prime Disk for 2" data-type="prime-disk" data-options="2"></div><div class="source" tabindex="0" aria-label="Prime Disk for 3" data-type="prime-disk" data-options="3"></div><div class="source" tabindex="0" aria-label="Prime Disk for 4" data-type="prime-disk" data-options="4"></div><div class="source" tabindex="0" aria-label="Prime Disk for 5" data-type="prime-disk" data-options="5"></div><div class="source" tabindex="0" aria-label="Prime Disk for 6" data-type="prime-disk" data-options="6"></div><div class="source" tabindex="0" aria-label="Prime Disk for 7" data-type="prime-disk" data-options="7"></div><div class="source" tabindex="0" aria-label="Prime Disk for 8" data-type="prime-disk" data-options="8"></div><div class="source" tabindex="0" aria-label="Prime Disk for 9" data-type="prime-disk" data-options="9"></div><div class="source" tabindex="0" aria-label="Prime Disk for 10" data-type="prime-disk" data-options="10"></div><div class="source" tabindex="0" aria-label="Prime Disk for 11" data-type="prime-disk" data-options="11"></div><div class="source" tabindex="0" aria-label="Prime Disk for 12" data-type="prime-disk" data-options="12"></div><div class="source" tabindex="0" aria-label="Prime Disk for 13" data-type="prime-disk" data-options="13"></div><div class="source" tabindex="0" aria-label="Prime Disk for 14" data-type="prime-disk" data-options="14"></div><div class="source" tabindex="0" aria-label="Prime Disk for 15" data-type="prime-disk" data-options="15"></div><div class="source" tabindex="0" aria-label="Prime Disk for 16" data-type="prime-disk" data-options="16"></div><div class="source" tabindex="0" aria-label="Prime Disk for 17" data-type="prime-disk" data-options="17"></div><div class="source" tabindex="0" aria-label="Prime Disk for 18" data-type="prime-disk" data-options="18"></div><div class="source" tabindex="0" aria-label="Prime Disk for 19" data-type="prime-disk" data-options="19"></div><div class="source" tabindex="0" aria-label="Prime Disk for 20" data-type="prime-disk" data-options="20"></div><div class="source" tabindex="0" aria-label="Prime Disk for 21" data-type="prime-disk" data-options="21"></div><div class="source" tabindex="0" aria-label="Prime Disk for 22" data-type="prime-disk" data-options="22"></div><div class="source" tabindex="0" aria-label="Prime Disk for 23" data-type="prime-disk" data-options="23"></div><div class="source" tabindex="0" aria-label="Prime Disk for 24" data-type="prime-disk" data-options="24"></div><div class="primes"><input class="input-field" type="number" min="1" max="10000" :bind="p" value="25"><div class="source" tabindex="0" aria-label="Prime Disk for" data-type="prime-disk" data-options="${p}"></div></div></div></section><h3 data-key="number-cards" tabindex="0">Number Cards</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Number Card for 1" data-type="number-card" data-options="1"></div><div class="source" tabindex="0" aria-label="Number Card for 2" data-type="number-card" data-options="2"></div><div class="source" tabindex="0" aria-label="Number Card for 3" data-type="number-card" data-options="3"></div><div class="source" tabindex="0" aria-label="Number Card for 4" data-type="number-card" data-options="4"></div><div class="source" tabindex="0" aria-label="Number Card for 5" data-type="number-card" data-options="5"></div><div class="source" tabindex="0" aria-label="Number Card for 6" data-type="number-card" data-options="6"></div><div class="source" tabindex="0" aria-label="Number Card for 7" data-type="number-card" data-options="7"></div><div class="source" tabindex="0" aria-label="Number Card for 8" data-type="number-card" data-options="8"></div><div class="source" tabindex="0" aria-label="Number Card for 9" data-type="number-card" data-options="9"></div><div class="source" tabindex="0" aria-label="Number Card for 10" data-type="number-card" data-options="10"></div><div class="source" tabindex="0" aria-label="Number Card for 11" data-type="number-card" data-options="11"></div><div class="source" tabindex="0" aria-label="Number Card for 12" data-type="number-card" data-options="12"></div><div class="primes"><input class="input-field" type="number" min="-9999" max="9999" :bind="q" value="25"><div class="source" tabindex="0" aria-label="Number Card for" data-type="number-card" data-options="${q}"></div></div></div></section><h3 data-key="decimal-grid" tabindex="0">Multiplication Grid</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Multiplication Grid" data-type="decimal-grid" data-options="23:12:10"></div></div></section><h3 data-key="abacus" tabindex="0">Abacus or Rekenrek</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Abacus" data-type="abacus" data-options="0,1,2,3,4,5,6,7,8,9"></div></div></section><h3 data-key="dots" tabindex="0">Exploding Dots</h3><section><div class="source-wrap" style="justify-content: center"><div class="source" tabindex="0" aria-label="Dot" data-type="dot" data-options="1"></div><div class="source" tabindex="0" aria-label="Antidot" data-type="dot" data-options="-1"></div><div class="source" tabindex="0" aria-label="Exploding Dots Machine" data-type="dot-machine" data-options="10:3" style="margin: 3px 15px 8px"></div></div></section></x-accordion><h2 class="m-yellow" data-key="fractions"><x-icon name="fractions" size="18"></x-icon> Fractions</h2><x-accordion class="subsection" storage="polypad.tiles-fractions"><h3 data-key="fraction-bars" tabindex="0">Fraction Bars</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Fraction Bar 1/1" data-type="fraction-bar" data-options="1:1"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/2" data-type="fraction-bar" data-options="2:2"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/3" data-type="fraction-bar" data-options="3:3"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/4" data-type="fraction-bar" data-options="4:4"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/5" data-type="fraction-bar" data-options="5:5"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/6" data-type="fraction-bar" data-options="6:6"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/7" data-type="fraction-bar" data-options="7:7"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/8" data-type="fraction-bar" data-options="8:8"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/9" data-type="fraction-bar" data-options="9:9"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/10" data-type="fraction-bar" data-options="10:10"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/11" data-type="fraction-bar" data-options="11:11"></div><div class="source" tabindex="0" aria-label="Fraction Bar 1/12" data-type="fraction-bar" data-options="12:12"></div></div></section><h3 data-key="fraction-circles" tabindex="0">Fraction Circles</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Fraction Circle 1/1" data-type="fraction-circle" data-options="1"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/2" data-type="fraction-circle" data-options="2"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/3" data-type="fraction-circle" data-options="3"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/4" data-type="fraction-circle" data-options="4"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/5" data-type="fraction-circle" data-options="5"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/6" data-type="fraction-circle" data-options="6"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/7" data-type="fraction-circle" data-options="7"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/8" data-type="fraction-circle" data-options="8"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/9" data-type="fraction-circle" data-options="9"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/10" data-type="fraction-circle" data-options="10"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/11" data-type="fraction-circle" data-options="11"></div><div class="source" tabindex="0" aria-label="Fraction Circle 1/12" data-type="fraction-circle" data-options="12"></div></div></section></x-accordion><h2 class="m-green" data-key="algebra"><x-icon name="algebra" size="18"></x-icon> Algebra</h2><x-accordion class="subsection" storage="polypad.tiles-algebra"><h3 data-key="algebra" tabindex="0">Algebra Tiles</h3><section><div class="source-wrap" style="max-width:220px"><div class="source" tabindex="0" aria-label="1" data-type="algebra-tile" data-options="1"></div><div class="source" tabindex="0" aria-label="x" data-type="algebra-tile" data-options="x"></div><div class="source" tabindex="0" aria-label="x squared" data-type="algebra-tile" data-options="x2"></div><div class="source" tabindex="0" aria-label="minus 1" data-type="algebra-tile" data-options="-1"></div><div class="source" tabindex="0" aria-label="minus x" data-type="algebra-tile" data-options="-x"></div><div class="source" tabindex="0" aria-label="minus x squared" data-type="algebra-tile" data-options="-x2"></div></div></section><h3 data-key="balance" tabindex="0">Balance Scale</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Algebra circle token" data-type="token" data-options="circle"></div><div class="source" tabindex="0" aria-label="Algebra square token" data-type="token" data-options="square"></div><div class="source" tabindex="0" aria-label="Algebra cross token" data-type="token" data-options="cross"></div><div class="source" tabindex="0" aria-label="Algebra weight token" data-type="token" data-options="weight"></div><div class="source" tabindex="0" aria-label="Algebra star token" data-type="token" data-options="star"></div><div class="source" tabindex="0" aria-label="Algebra heart token" data-type="token" data-options="heart"></div><div class="source" tabindex="0" aria-label="Balance Scale" data-type="balance" data-options=""></div><p class="caption">More features coming soon!</p></div></section></x-accordion><h2 class="m-teal" data-key="probability"><x-icon name="probability" size="18"></x-icon> Probability</h2><x-accordion class="subsection" storage="polypad.tiles-probability"><h3 data-key="probability" tabindex="0">Coins, Dice and Spinners</h3><section><div class="source-wrap" style="max-width: 195px"><div class="source" tabindex="0" aria-label="die" data-type="dice" data-options=""></div><div class="source" tabindex="0" aria-label="coin" data-type="coin" data-options=""></div><div class="source" tabindex="0" aria-label="spinner" data-type="spinner" data-options="0:5" data-caption="Uniform"></div><div class="source" tabindex="0" aria-label="non-uniform spinner" data-type="custom-spinner" data-options="0:60,180,270,330" data-caption="Custom"></div></div></section><h3 data-key="cards" tabindex="0">Playing Cards</h3><section><div class="source-wrap dynamic" style="justify-content: center"><x-select class="suits" :bind="suit"><button value="C"><x-icon name="clubs"></x-icon></button><button value="S"><x-icon name="spades"></x-icon></button><button value="H"><x-icon name="hearts"></x-icon></button><button value="D"><x-icon name="diamonds"></x-icon></button></x-select><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="2${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="3${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="4${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="5${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="6${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="7${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="8${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="9${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="0${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="J${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="Q${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="K${suit}"></div><div class="source" tabindex="0" aria-label="card" data-type="card" data-options="A${suit}"></div><div class="source" tabindex="0" aria-label="joker card" data-type="card" data-options="JJ"></div></div></section><h3 data-key="non-trans-dice" tabindex="0">Non-transitive Dice</h3><section><div class="subtitle">Classic Dice</div><div class="source-wrap"><div class="source" tabindex="0" aria-label="Classic dice type 1" data-type="dice" data-options="0:3,3,3,3,3,6" data-thumb="net" data-colour="#cd0e66"></div><div class="source" tabindex="0" aria-label="Classic dice type 2" data-type="dice" data-options="0:2,2,2,5,5,5" data-thumb="net" data-colour="#0f82f2"></div><div class="source" tabindex="0" aria-label="Classic dice type 3" data-type="dice" data-options="0:1,4,4,4,4,4" data-thumb="net" data-colour="#22ab24"></div></div><div class="subtitle">Efron Dice</div><div class="source-wrap"><div class="source" tabindex="0" aria-label="Efron dice type 1" data-type="dice" data-options="0:3,3,3,3,3,3" data-thumb="net" data-colour="#cd0e66"></div><div class="source" tabindex="0" aria-label="Efron dice type 2" data-type="dice" data-options="0:2,2,2,2,6,6" data-thumb="net" data-colour="#0f82f2"></div><div class="source" tabindex="0" aria-label="Efron dice type 3" data-type="dice" data-options="0:1,1,1,5,5,5" data-thumb="net" data-colour="#22ab24"></div><div class="source" tabindex="0" aria-label="Efron dice type 4" data-type="dice" data-options="0:0,0,4,4,4,4" data-thumb="net" data-colour="#fd8c00"></div></div><div class="subtitle">Grime Dice</div><div class="source-wrap" style="max-width: 220px"><div class="source" tabindex="0" aria-label="Grime dice type 1" data-type="dice" data-options="0:2,2,2,7,7,7" data-thumb="net" data-colour="#cd0e66"></div><div class="source" tabindex="0" aria-label="Grime dice type 2" data-type="dice" data-options="0:1,1,6,6,6,6" data-thumb="net" data-colour="#0f82f2"></div><div class="source" tabindex="0" aria-label="Grime dice type 3" data-type="dice" data-options="0:0,5,5,5,5,5" data-thumb="net" data-colour="#22ab24"></div><div class="source" tabindex="0" aria-label="Grime dice type 4" data-type="dice" data-options="0:4,4,4,4,4,9" data-thumb="net" data-colour="#fd8c00"></div><div class="source" tabindex="0" aria-label="Grime dice type 5" data-type="dice" data-options="0:3,3,3,3,8,8" data-thumb="net" data-colour="#eb4726"></div></div></section></x-accordion><h2 class="m-blue" data-key="axes"><x-icon name="axes" size="18"></x-icon> Tools and Utensils</h2><x-accordion class="subsection" storage="polypad.tiles-axes"><h3 data-key="number-line" tabindex="0">Number Line</h3><section><div class="source-wrap"><div class="source" tabindex="0" data-type="number-line" data-options="0:1:10:2:1"></div></div></section><h3 data-key="axes" tabindex="0">Coordinate System</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Coordinate Axes" data-type="axes" data-options="-5:1:5:-5:1:5"></div></div></section><h3 data-key="utensils" tabindex="0">Measuring Tools</h3><section><div class="source-wrap"><div class="source" tabindex="0" aria-label="Ruler" data-type="ruler" data-options="400" data-caption="Ruler"><svg width="80" height="80" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><rect fill="#fff" height="12.05" opacity=".5" rx="2" transform="matrix(.70710678 -.70710678 .70710678 .70710678 -12.4 29.9)" width="72.3" x="-6.2" y="23.9"/><g fill="none" stroke="#fff" stroke-miterlimit="10"><path d="m2.4 48.9 3.9 3.9" stroke-width=".4"/><path d="m3.2 48.1 2.3 2.4" stroke-width=".3"/><path d="m4 47.4 2.3 2.3" stroke-width=".3"/><path d="m4.8 46.6 2.3 2.3" stroke-width=".3"/><path d="m5.5 45.8 2.4 2.3" stroke-width=".3"/><path d="m6.3 45 2.3 2.4" stroke-width=".3"/><path d="m7.1 44.3 2.3 2.3" stroke-width=".3"/><path d="m7.9 43.5 2.3 2.3" stroke-width=".3"/><path d="m8.6 42.7 2.4 2.3" stroke-width=".3"/><path d="m9.4 41.9 2.3 2.4" stroke-width=".3"/><path d="m10.2 41.2 3.9 3.8" stroke-width=".3"/><path d="m11 40.4 2.3 2.3" stroke-width=".3"/><path d="m11.7 39.6 2.4 2.3" stroke-width=".3"/><path d="m12.5 38.8 2.3 2.4" stroke-width=".3"/><path d="m13.3 38.1 2.3 2.3" stroke-width=".3"/><path d="m14.1 37.3 2.3 2.3" stroke-width=".3"/><path d="m14.8 36.5 2.4 2.3" stroke-width=".3"/><path d="m15.6 35.7 2.3 2.4" stroke-width=".3"/><path d="m16.4 35 2.3 2.3" stroke-width=".3"/><path d="m17.2 34.2 2.3 2.3" stroke-width=".3"/><path d="m17.9 33.4 3.9 3.9" stroke-width=".3"/><path d="m18.7 32.7 2.3 2.3" stroke-width=".3"/><path d="m19.5 31.9 2.3 2.3" stroke-width=".3"/><path d="m20.3 31.1 2.3 2.3" stroke-width=".3"/><path d="m21 30.3 2.4 2.4" stroke-width=".3"/><path d="m21.8 29.6 2.3 2.3" stroke-width=".3"/><path d="m22.6 28.8 2.3 2.3" stroke-width=".3"/><path d="m23.4 28 2.3 2.3" stroke-width=".3"/><path d="m24.1 27.2 2.4 2.4" stroke-width=".3"/><path d="m24.9 26.5 2.3 2.3" stroke-width=".3"/><path d="m25.7 25.7 3.9 3.9" stroke-width=".3"/><path d="m26.5 24.9 2.3 2.3" stroke-width=".3"/><path d="m27.2 24.1 2.4 2.4" stroke-width=".3"/><path d="m28 23.4 2.3 2.3" stroke-width=".3"/><path d="m28.8 22.6 2.3 2.3" stroke-width=".3"/><path d="m29.6 21.8 2.3 2.3" stroke-width=".3"/><path d="m30.3 21 2.4 2.4" stroke-width=".3"/><path d="m31.1 20.3 2.3 2.3" stroke-width=".3"/><path d="m31.9 19.5 2.3 2.3" stroke-width=".3"/><path d="m32.7 18.7 2.3 2.3" stroke-width=".3"/><path d="m33.4 17.9 3.9 3.9" stroke-width=".3"/><path d="m34.2 17.2 2.3 2.3" stroke-width=".3"/><path d="m35 16.4 2.3 2.3" stroke-width=".3"/><path d="m35.7 15.6 2.4 2.3" stroke-width=".3"/><path d="m36.5 14.8 2.3 2.4" stroke-width=".3"/><path d="m37.3 14.1 2.3 2.3" stroke-width=".3"/><path d="m38.1 13.3 2.3 2.3" stroke-width=".3"/><path d="m38.8 12.5 2.4 2.3" stroke-width=".3"/><path d="m39.6 11.7 2.3 2.4" stroke-width=".3"/><path d="m40.4 11 2.3 2.3" stroke-width=".3"/><path d="m41.2 10.2 3.8 3.9" stroke-width=".3"/><path d="m41.9 9.4 2.4 2.3" stroke-width=".3"/><path d="m42.7 8.6 2.3 2.4" stroke-width=".3"/><path d="m43.5 7.9 2.3 2.3" stroke-width=".3"/><path d="m44.3 7.1 2.3 2.3" stroke-width=".3"/><path d="m45 6.3 2.4 2.3" stroke-width=".3"/><path d="m45.8 5.5 2.3 2.4" stroke-width=".3"/><path d="m46.6 4.8 2.3 2.3" stroke-width=".3"/><path d="m47.4 4 2.3 2.3" stroke-width=".3"/><path d="m48.1 3.2 2.4 2.3" stroke-width=".3"/><path d="m48.9 2.4 3.9 3.9" stroke-width=".3"/></g></svg></div><div class="source" tabindex="0" aria-label="Protractor" data-type="protractor" data-options="200" data-caption="Protractor"><svg width="80" height="80" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><path d="m10.8 10.8a33.6 33.6 0 0 0 0 47.5l.4.4a1.2 1.2 0 0 0 1.6 0l45.9-45.9a1.2 1.2 0 0 0 0-1.6l-.4-.4a33.6 33.6 0 0 0 -47.5 0z" fill="#fff" opacity=".5"/><g fill="none" stroke="#fff" stroke-miterlimit="10" stroke-width=".3"><path d="m10.8 10.8 19.8 19.8"/><path d="m10.8 10.8 19.8 19.8"/><path d="m11.7 10 3 3.3"/><path d="m12.5 9.2 3 3.4"/><path d="m13.4 8.5 2.9 3.5"/><path d="m14.4 7.8 2.7 3.5"/><path d="m15.3 7.1 16 22.9"/><path d="m15.3 7.1 16 22.9"/><path d="m16.3 6.4 2.4 3.8"/><path d="m17.3 5.8 2.3 3.8"/><path d="m18.3 5.2 2.2 3.9"/><path d="m19.3 4.7 2.1 3.9"/><path d="m20.4 4.1 11.8 25.4"/><path d="m20.4 4.1 11.8 25.4"/><path d="m21.4 3.7 1.8 4.1"/><path d="m22.5 3.2 1.6 4.2"/><path d="m23.6 2.8 1.5 4.3"/><path d="m24.7 2.5 1.4 4.2"/><path d="m25.9 2.1 7.2 27.1"/><path d="m25.9 2.1 7.2 27.1"/><path d="m27 1.9 1 4.3"/><path d="m28.2 1.6.8 4.4"/><path d="m29.3 1.4.7 4.4"/><path d="m30.5 1.3.5 4.4"/><path d="m31.6 1.1 2.5 27.9"/><path d="m31.6 1.1 2.5 27.9"/><path d="m32.8 1 .2 4.5"/><path d="m34 1v4.5"/><path d="m35.1 1v4.5"/><path d="m36.3 1-.2 4.5"/><path d="m37.5 1.1-2.5 27.9"/><path d="m37.5 1.1-2.5 27.9"/><path d="m38.6 1.3-.5 4.4"/><path d="m39.8 1.4-.7 4.4"/><path d="m41 1.6-.9 4.4"/><path d="m42.1 1.9-1 4.3"/><path d="m43.2 2.1-7.2 27.1"/><path d="m43.2 2.1-7.2 27.1"/><path d="m44.4 2.5-1.3 4.2"/><path d="m45.5 2.8-1.5 4.3"/><path d="m46.6 3.2-1.6 4.2"/><path d="m47.7 3.7-1.8 4.1"/><path d="m48.7 4.1-11.8 25.4"/><path d="m48.7 4.1-11.8 25.4"/><path d="m49.8 4.7-2 3.9"/><path d="m50.8 5.2-2.2 3.9"/><path d="m51.8 5.8-2.3 3.8"/><path d="m52.8 6.4-2.4 3.8"/><path d="m53.8 7.1-16 22.9"/><path d="m53.8 7.1-16 22.9"/><path d="m54.7 7.8-2.6 3.5"/><path d="m55.7 8.5-2.8 3.5"/><path d="m56.6 9.2-3 3.4"/><path d="m57.4 10-3 3.3"/><path d="m58.3 10.8-19.8 19.8"/><path d="m10.8 10.8 19.8 19.8"/><path d="m10 11.7 3.3 3"/><path d="m9.2 12.5 3.4 3"/><path d="m8.5 13.4 3.5 2.9"/><path d="m7.8 14.4 3.5 2.7"/><path d="m7.1 15.3 22.9 16"/><path d="m7.1 15.3 22.9 16"/><path d="m6.4 16.3 3.8 2.4"/><path d="m5.8 17.3 3.8 2.3"/><path d="m5.2 18.3 3.9 2.2"/><path d="m4.7 19.3 3.9 2.1"/><path d="m4.1 20.4 25.4 11.8"/><path d="m4.1 20.4 25.4 11.8"/><path d="m3.7 21.4 4.1 1.8"/><path d="m3.2 22.5 4.2 1.6"/><path d="m2.8 23.6 4.3 1.5"/><path d="m2.5 24.7 4.2 1.4"/><path d="m2.1 25.9 27.1 7.2"/><path d="m2.1 25.9 27.1 7.2"/><path d="m1.9 27 4.3 1"/><path d="m1.6 28.2 4.4.8"/><path d="m1.4 29.3 4.4.7"/><path d="m1.3 30.5 4.4.5"/><path d="m1.1 31.6 27.9 2.5"/><path d="m1.1 31.6 27.9 2.5"/><path d="m1 32.8 4.5.2"/><path d="m1 34h4.5"/><path d="m1 35.1h4.5"/><path d="m1 36.3 4.5-.2"/><path d="m1.1 37.5 27.9-2.5"/><path d="m1.1 37.5 27.9-2.5"/><path d="m1.3 38.6 4.4-.5"/><path d="m1.4 39.8 4.4-.7"/><path d="m1.6 41 4.4-.9"/><path d="m1.9 42.1 4.3-1"/><path d="m2.1 43.2 27.1-7.2"/><path d="m2.1 43.2 27.1-7.2"/><path d="m2.5 44.4 4.2-1.3"/><path d="m2.8 45.5 4.3-1.5"/><path d="m3.2 46.6 4.2-1.6"/><path d="m3.7 47.7 4.1-1.8"/><path d="m4.1 48.7 25.4-11.8"/><path d="m4.1 48.7 25.4-11.8"/><path d="m4.7 49.8 3.9-2"/><path d="m5.2 50.8 3.9-2.2"/><path d="m5.8 51.8 3.8-2.3"/><path d="m6.4 52.8 3.8-2.4"/><path d="m7.1 53.8 22.9-16"/><path d="m7.1 53.8 22.9-16"/><path d="m7.8 54.7 3.5-2.6"/><path d="m8.5 55.7 3.5-2.8"/><path d="m9.2 56.6 3.4-3"/><path d="m10 57.4 3.3-3"/><path d="m10.8 58.3 19.8-19.8"/></g></svg></div></div></section></x-accordion><a class="credit" href="https://mathigon.org" target="_blank">Powered by Mathigon</a></x-accordion></div></x-polypad-sidebar>';var Vl=`<x-polypad-settings><div class="settings-group"><button class="settings-btn" title="Toggle Fullscreen" @click="expand()"><x-icon :name="fullscreen ? 'fullscreen-reverse' : 'fullscreen'"></x-icon><div class="tooltip">Toggle Fullscreen</div></button><button class="settings-btn" title="Undo" @click="undo()" :disabled="canUndo ? undefined : true"><x-icon name="undo"></x-icon><div class="tooltip">Undo</div></button><button class="settings-btn" title="Redo" @click="redo()" :disabled="canRedo ? undefined : true"><x-icon name="redo"></x-icon><div class="tooltip">Redo</div></button><x-popup animation="pop"><button class="settings-btn popup-target" title="Grid"><x-icon name="grid"></x-icon><div class="tooltip">Grid Settings</div></button><x-select class="popup-body grid-popup" hidden :bind="grid" data-display="flex"><button class="grid" value="none" title="No Grid"></button><button class="grid" value="square2-grid" title="Large Square Grid"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g fill="none" stroke="#000" stroke-miterlimit="10"><path d="m0 24h48"/><path d="m24 48v-48"/><path d="m42 48v-48"/><path d="m6 48v-48"/><path d="m0 42h48"/><path d="m0 6h48"/></g></svg>
</button><button class="grid" value="square-dots" title="Square Dots"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><circle cx="44" cy="4" r="1.5"/><circle cx="34" cy="4" r="1.5"/><circle cx="24" cy="4" r="1.5"/><circle cx="14" cy="4" r="1.5"/><circle cx="4" cy="4" r="1.5"/><circle cx="44" cy="14" r="1.5"/><circle cx="34" cy="14" r="1.5"/><circle cx="24" cy="14" r="1.5"/><circle cx="14" cy="14" r="1.5"/><circle cx="4" cy="14" r="1.5"/><circle cx="44" cy="24" r="1.5"/><circle cx="34" cy="24" r="1.5"/><circle cx="24" cy="24" r="1.5"/><circle cx="14" cy="24" r="1.5"/><circle cx="4" cy="24" r="1.5"/><circle cx="44" cy="34" r="1.5"/><circle cx="34" cy="34" r="1.5"/><circle cx="24" cy="34" r="1.5"/><circle cx="14" cy="34" r="1.5"/><circle cx="4" cy="34" r="1.5"/><circle cx="44" cy="44" r="1.5"/><circle cx="34" cy="44" r="1.5"/><circle cx="24" cy="44" r="1.5"/><circle cx="14" cy="44" r="1.5"/><circle cx="4" cy="44" r="1.5"/></svg></button><button class="grid" value="square-grid" title="Square Grid"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g fill="none" stroke="#000" stroke-miterlimit="10"><path d="m0 24h48" stroke-width="2"/><path d="m24 48v-48" stroke-width="2"/><path d="m34 48v-48"/><path d="m44 48v-48"/><path d="m4 48v-48"/><path d="m14 48v-48"/><path d="m0 34h48"/><path d="m0 44h48"/><path d="m0 4h48"/><path d="m0 14h48"/></g></svg>
</button><button class="grid" value="tri-dots" title="Isometric Dots"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><circle cx="15" cy="4" r="1.5"/><circle cx="3.5" cy="4" r="1.5"/><circle cx="26.5" cy="4" r="1.5"/><circle cx="38" cy="4" r="1.5"/><circle cx="15" cy="44" r="1.5"/><circle cx="3.5" cy="44" r="1.5"/><circle cx="26.5" cy="44" r="1.5"/><circle cx="38" cy="44" r="1.5"/><circle cx="21" cy="14" r="1.5"/><circle cx="9.5" cy="14" r="1.5"/><circle cx="32.5" cy="14" r="1.5"/><circle cx="44" cy="14" r="1.5"/><circle cx="15" cy="24" r="1.5"/><circle cx="3.5" cy="24" r="1.5"/><circle cx="26.5" cy="24" r="1.5"/><circle cx="38" cy="24" r="1.5"/><circle cx="21" cy="34" r="1.5"/><circle cx="9.5" cy="34" r="1.5"/><circle cx="32.5" cy="34" r="1.5"/><circle cx="44" cy="34" r="1.5"/></svg></button><button class="grid" value="tri-grid" title="Isometric Grid"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g fill="none" stroke="#000" stroke-linecap="round" stroke-miterlimit="10"><path d="m.5 44h48"/><path d="m0 24h48"/><path d="m0 34h48"/><path d="m0 44h48"/><path d="m0 4h48"/><path d="m0 14h48"/><path d="m-.5 48 28-48"/><path d="m-.5 27.8 16.2-27.8"/><path d="m-.5 8.4 4.9-8.4"/><path d="m3.9 48-4.4-7.5"/><path d="m11.3 48 28-48"/><path d="m27.5 48-28-48"/><path d="m22.8 48 25.7-44"/><path d="m39 48-28-48"/><path d="m34.5 48 14-24"/><path d="m49.2 45.5-26.5-45.5"/><path d="m48.5 24-14-24"/><path d="m48.5 4-2.2-4"/><path d="m46.3 48 2.2-4"/><path d="m15.7 48-16.2-27.8"/></g></svg></button><button class="grid" value="tri2-dots" title="Rotated Isometric Dots"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><circle cx="4" cy="15" r="1.5"/><circle cx="4" cy="3.5" r="1.5"/><circle cx="4" cy="26.5" r="1.5"/><circle cx="4" cy="38" r="1.5"/><circle cx="44" cy="15" r="1.5"/><circle cx="44" cy="3.5" r="1.5"/><circle cx="44" cy="26.5" r="1.5"/><circle cx="44" cy="38" r="1.5"/><circle cx="14" cy="21" r="1.5"/><circle cx="14" cy="9.5" r="1.5"/><circle cx="14" cy="32.5" r="1.5"/><circle cx="14" cy="44" r="1.5"/><circle cx="24" cy="15" r="1.5"/><circle cx="24" cy="3.5" r="1.5"/><circle cx="24" cy="26.5" r="1.5"/><circle cx="24" cy="38" r="1.5"/><circle cx="34" cy="21" r="1.5"/><circle cx="34" cy="9.5" r="1.5"/><circle cx="34" cy="32.5" r="1.5"/><circle cx="34" cy="44" r="1.5"/></svg></button><button class="grid" value="tri2-grid" title="Rotated Isometric Grid"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><g fill="none" stroke="#000" stroke-linecap="round" stroke-miterlimit="10"><path d="m44 47.8v-48"/><path d="m24 48.3v-48"/><path d="m34 48.3v-48"/><path d="m44 48.3v-48"/><path d="m4 48.3v-48"/><path d="m14 48.3v-48"/><path d="m48 48.8-48-28"/><path d="m27.8 48.8-27.8-16.2"/><path d="m8.4 48.8-8.4-4.9"/><path d="m48 44.5-7.5 4.3"/><path d="m48 37.1-48-28"/><path d="m48 20.8-48 28"/><path d="m48 25.5-44-25.7"/><path d="m48 9.3-48 28"/><path d="m48 13.9-24-14.1"/><path d="m45.5-.8-45.5 26.5"/><path d="m24-.2-24 14.1"/><path d="m4-.2-4 2.2"/><path d="m48 2-4-2.2"/><path d="m48 32.6-27.8 16.2"/></g></svg></button><button class="grid fill" value="square-checked" title="Checked Square Grid"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><path d="m4 4h10v10h-10z"/><path d="m24 4h10v10h-10z"/><path d="m44 4h4v10h-4z"/><path d="m4 24h10v10h-10z"/><path d="m24 24h10v10h-10z"/><path d="m44 24h4v10h-4z"/><path d="m4 44h10v4h-10z"/><path d="m24 44h10v4h-10z"/><path d="m44 44h4v4h-4z"/><path d="m0 0h4v4h-4z"/><path d="m14 0h10v4h-10z"/><path d="m34 0h10v4h-10z"/><path d="m0 14h4v10h-4z"/><path d="m14 14h10v10h-10z"/><path d="m34 14h10v10h-10z"/><path d="m0 34h4v10h-4z"/><path d="m14 34h10v10h-10z"/><path d="m34 34h10v10h-10z"/></svg></button></x-select></x-popup><x-popup animation="pop"><button class="settings-btn popup-target" title="Options"><x-icon name="construction"></x-icon><div class="tooltip">Settings</div></button><div class="popup-body options-popup" hidden><div class="row"><div><x-icon name="text" size="20"></x-icon> Hide Number Labels:</div><label class="form-checkbox"><input class="show-labels" type="checkbox" :bind="noLabels"><div class="control"></div></label></div><div class="row"><div><x-icon name="color" size="20"></x-icon> Alternate Colours:</div><label class="form-checkbox"><input class="show-labels" type="checkbox" :bind="altColors"><div class="control"></div></label></div><div class="row"><div><x-icon name="quiz" size="20"></x-icon> Merge  Number Tiles:</div><label class="form-checkbox"><input class="show-labels" type="checkbox" :bind="mergeTiles"><div class="control"></div></label></div><button class="btn btn-small btn-blue" @click="resetZoom()"><x-icon name="axes" size="22"></x-icon> Reset Viewport</button></div></x-popup><button class="settings-btn" title="Download Image" @click="download()"><x-icon name="screenshot"></x-icon><div class="tooltip">Download Image</div></button></div><div class="settings-group"><button class="settings-btn" title="Zoom In" @click="zoom(1.1)"><x-icon name="zoom-in"></x-icon></button><button class="settings-btn" title="Zoom Out" @click="zoom(0.9)"><x-icon name="zoom-out"></x-icon></button><button class="settings-btn" title="Pan Canvas" @click="pan()"><x-icon name="move"></x-icon></button></div></x-polypad-settings>`;var El=`<x-polypad-toolbar hidden data-display="flex"><div class="bar"><x-select :bind="tool"><button class="tool" value="move" title="Move Tool"><x-icon name="cursor" size="32"></x-icon><div class="tooltip">Move Tool</div></button><button class="tool" value="pen" title="Drawing Tools"><x-icon :name="penOptions" size="32"></x-icon><div class="tooltip">Drawing Tools</div></button><button class="tool" value="geo" title="Construction Tools"><x-icon :name="'geo-' + geoOptions" size="32"></x-icon><div class="tooltip">Construction Tools</div></button><button class="tool" value="text" title="Text Box"><x-icon name="text" size="32"></x-icon><div class="tooltip">Text Box</div></button><button class="tool" value="eraser" title="Eraser"><x-icon name="eraser" size="32"></x-icon><div class="tooltip">Eraser</div></button></x-select><label class="tool" for="image-upload"><x-icon name="add-image" size="32"></x-icon><div class="tooltip">Upload Image</div></label><input id="image-upload" type="file" multiple hidden><x-popup class="color-picker" @pointerdown="stop($event)"><button class="popup-target rainbow" title="Colour Picker"></button><div class="popup-body"><x-color-picker></x-color-picker></div></x-popup></div><div class="buttons"><button :show="tool === 'move' &amp;&amp; tiles.length === 1 &amp;&amp; tileType('number-tile') &amp;&amp; canSplitTiles()" @click="action('number-tile', 'split')">Split Tiles</button><button :show="tool === 'move' &amp;&amp; tiles.length &gt; 1 &amp;&amp; tileType('number-tile')" @click="action('number-tile', 'merge')">Merge Tiles</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('algebra-tile')" @click="action('algebra-tile', 'negate')">Negate</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('fraction-bar')" @click="action('fraction-bar', 'split')">Split Tiles</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('fraction-bar') &amp;&amp; tiles.length &gt; 1 &amp;&amp; canMergeFractionBars()" @click="action('fraction-bar', 'merge')">Merge Tiles</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('polygon tangram pentomino custom-polygon penrose egg fractal garden')" @click="action('polygon', 'flip')">Flip</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('polygon custom-polygon')" @click="cutPolygon()">Cut</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('custom-polygon')" @click="action('custom-polygon', 'lock')">Lock</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('dice coin spinner non-trans-dice custom-spinner')" @click="action('dice', 'roll')">Randomise</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('balance')" @click="action('balance', 'balance')">Balance</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('dot')" @click="action('dot', 'negate')">Negate</button><button :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('bucket')" @click="action('bucket', 'fill')">Fill</button><div class="btn-group" :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('dot-machine')" data-display="flex"><button @click="action('dot-machine', 'explode')">Explode</button><button @click="action('dot-machine', 'annihilate')">Annihilate</button></div><btn-group :show="tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('card')" data-display="flex"><button @click="action('card', 'flip')">Flip</button></btn-group><div class="btn-group" :show="focussed.type === 'text' || (tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('text equation'))" data-display="flex" @pointerdown="stop($event)"><button class="icon-only" @click="format('smaller')"><x-icon name="text-alt" size="14" style="margin: 0 2px"></x-icon><div class="tooltip">Smaller</div></button><button class="icon-only" @click="format('larger')"><x-icon name="text-alt" size="22"></x-icon><div class="tooltip">Larger</div></button></div><div class="btn-group" :show="focussed.type === 'text' || (tool === 'move' &amp;&amp; tiles.length &amp;&amp; tileType('text'))" data-display="flex" @pointerdown="stop($event)"><button class="icon-only" @click="format('bold')"><x-icon name="bold" size="22"></x-icon><div class="tooltip">Bold</div></button><button class="icon-only" @click="format('italic')"><x-icon name="italic" size="22"></x-icon><div class="tooltip">Italic</div></button><button class="icon-only" @click="format('underline')"><x-icon name="underlined" size="22"></x-icon><div class="tooltip">Underline</div></button></div><div class="btn-group" :show="geo &amp;&amp; geo.type !== 'point'" data-display="flex"><button class="icon-only" @click="construct('$0.midpoint')" :if="geo.type === 'segment'"><x-icon name="geo-midpoint" size="24"></x-icon><div class="tooltip">Midpoint</div></button><button class="icon-only" @click="construct('$0.perpendicularBisector')" :if="geo.type === 'segment'"><x-icon name="geo-perp-bisector" size="24"></x-icon><div class="tooltip">Perpendicular Bisector</div></button><button class="icon-only" @click="construct('$0.parallel($1)')" :if="geo.type === 'line' || geo.type === 'segment'"><x-icon name="geo-parallel" size="24"></x-icon><div class="tooltip">Parallel Line</div></button><button class="icon-only" @click="construct('$0.perpendicular($1)')" :if="geo.type === 'line' || geo.type === 'segment'"><x-icon name="geo-perpendicular" size="24"></x-icon><div class="tooltip">Perpendicular Line</div></button><button class="icon-only" @click="construct('line($0.c,$1).perpendicular($1)')" :if="geo.type === 'circle'"><x-icon name="geo-tangent" size="24"></x-icon><div class="tooltip">Tangent Line</div></button><button class="icon-only" @click="construct('$0.centroid')" :if="geo.type === 'polygon' || geo.type === 'triangle'"><x-icon name="geo-centroid" size="24"></x-icon><div class="tooltip">Centroid</div></button><button class="icon-only" @click="construct('$0.circumcircle')" :if="geo.type === 'triangle'"><x-icon name="geo-circumcircle" size="24"></x-icon><div class="tooltip">Circumcircle</div></button><button class="icon-only" @click="construct('$0.incircle')" :if="geo.type === 'triangle'"><x-icon name="geo-incircle" size="24"></x-icon><div class="tooltip">Incircle</div></button></div><div class="btn-group" :show="focussed.type === 'equation'" data-display="flex" @pointerdown="stop($event)"><button class="icon-only" @click="format('frac')"><x-icon name="fraction" size="24"></x-icon><div class="tooltip">Fraction</div></button><button class="icon-only" @click="format('sup')"><x-icon name="power" size="24"></x-icon><div class="tooltip">Exponent</div></button><button class="icon-only" @click="format('sqrt')"><x-icon name="sqrt" size="24"></x-icon><div class="tooltip">Square Root</div></button></div><div class="btn-group" :show="tool === 'move' &amp;&amp; tiles.length" data-display="flex"><button class="icon-only" @click="action('', 'copy')"><x-icon name="copy" size="22"></x-icon><div class="tooltip">Copy</div></button><button class="icon-only" @click="action('', 'delete')"><x-icon name="delete" size="22"></x-icon><div class="tooltip">Delete</div></button></div><x-select class="btn-group" :show="tool === 'geo'" :bind="geoOptions" data-display="flex"><button value="line"><x-icon name="geo-line" size="22"></x-icon> Line</button><button value="circle"><x-icon name="geo-circle" size="22"></x-icon> Circle</button></x-select><x-select class="btn-group" :show="tool === 'text'" :bind="textOptions" data-display="flex"><button value="text"><x-icon name="text-alt" size="22"></x-icon> Text</button><button value="equation"><x-icon name="equation" size="22"></x-icon> Equation</button></x-select></div><x-select class="brushes" :show="tool === 'pen'" :bind="penOptions" data-display="flex"><svg width="36" height="80" value="pen" title="Pen"><path d="M36,48c-.5,0-3-5-3-5H3S.5,48,0,48H0V80H36V48Z" :fill="color"></path><rect x="11" y="43" width="14" height="37" transform="translate(36 123) rotate(180)" opacity="0.3"></rect><path d="M1.4,47.3l2.2-2.6a2,2,0,0,1,3-.2l2.8,3.9a2.6,2.6,0,0,0,3.3.2l3.6-3.2a2.7,2.7,0,0,1,3.4,0l3.6,3.2a2.6,2.6,0,0,0,3.3-.2l2.8-3.9a2,2,0,0,1,3,.2l2.2,2.6A1.7,1.7,0,0,0,36,48L25.4,19.6a20.3,20.3,0,0,1-14.8,0L0,48A1.7,1.7,0,0,0,1.4,47.3Z" fill="#f7eecb"></path><path d="M10.6,19.6a20.3,20.3,0,0,0,14.8,0L18,0Z" :fill="color"></path></svg><svg width="36" height="80" value="marker" title="Marker"><path d="M27,21H9V15a11.4,11.4,0,0,1,2.6-7.2L18,0l6.4,7.8A11.4,11.4,0,0,1,27,15Z" :fill="color"></path><rect y="37" width="36" height="43" fill="#ccc"></rect><rect x="2" y="29" width="32" height="8" :fill="color"></rect><rect x="5" y="21" width="26" height="8" fill="#3a3645"></rect><rect x="26" y="37" width="10" height="43" opacity="0.15"></rect><rect y="50" width="18" height="30" :fill="color"></rect></svg><svg width="40" height="80" value="highlighter" title="Highlighter"><rect y="38" width="40" height="7" fill="#3a3645"></rect><rect x="13" y="14" width="14" height="3" fill="#3a3645"></rect><path d="M27,17H13C10.9,25.1,8.2,31.8,0,38H40C31,32.2,28.6,25.5,27,17Z" fill="#615e6a"></path><rect y="45" width="40" height="35" :fill="color"></rect><rect x="7" y="52" width="26" height="28" opacity="0.2"></rect><polygon points="13 0 13 14 27 14 27 7 13 0" :fill="color"></polygon></svg><svg width="36" height="80" value="ruler" title="Straight lines"><path d="M5,0H31a5,5,0,0,1,5,5V80a0,0,0,0,1,0,0H0a0,0,0,0,1,0,0V5A5,5,0,0,1,5,0Z" fill="#ccc"></path><path d="M5,0h5a0,0,0,0,1,0,0V80a0,0,0,0,1,0,0H0a0,0,0,0,1,0,0V5A5,5,0,0,1,5,0Z" :fill="color"></path><path d="M36,10v2H24V10Zm-7,8v2h7V18Zm-5,8v2H36V26Zm5,8v2h7V34Zm-5,8v2H36V42Zm5,8v2h7V50Zm-5,8v2H36V58Zm5,8v2h7V66Zm-5,8v2H36V74Z" :fill="color"></path></svg></x-select></x-polypad-toolbar>`;var Hp=b,_o=class extends Y{ready(){let t=+this.attr("size")||24;this.css({width:t+"px",height:t+"px"});let e=d("svg",{viewBox:"0 0 24 24"},this);e.css({width:t+"px",height:t+"px"}),this.onAttr("name",i=>e.html=Hp[i])}};_o=Q([et("x-icon")],_o);function Up(s,t){return M(this,null,function*(){var G;let e=s._el.attachShadow({mode:"open"}),i=document.createElement("style");i.textContent=`@charset "UTF-8";@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600&display=swap");.icon,.sketch{display:inline-block;fill:currentColor}.button .icon{margin:-10px 3px -10px -8px}.row{display:flex;flex-wrap:wrap;justify-content:center}.row .grow{flex-grow:1}.row .shrink{flex-shrink:1}.ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}article,aside,audio,canvas,details,figcaption,figure,footer,header,main,nav,section,summary,video{display:block}audio:not([controls]){display:none;height:0}html{font-size:100%;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}template{display:none}svg{display:block;overflow:hidden}li svg,p svg,td svg{display:inline-block}circle,g,image,line,path,polyline,use{transform-origin:center;transform-box:fill-box}*{-webkit-tap-highlight-color:transparent;cursor:inherit;color:inherit}body,html{margin:0;padding:0}p{margin:0 0 1em;hanging-punctuation:first}h1{font-size:40px;font-weight:400}h2{font-size:28px}h2,h3{font-weight:600}h3{font-size:20px}h1,h2,h3,h4,h5,h6{color:inherit;font-weight:700;line-height:1.1;padding:0;margin:2em 0 .8em;text-rendering:optimizelegibility}a{cursor:pointer}a,a:hover{text-decoration:none}a,button{touch-action:manipulation}button{-webkit-user-select:none;-moz-user-select:none;user-select:none;box-sizing:content-box}.small,small{font-size:80%}.b,b,strong{font-weight:700}.i,dfn,em,i{font-style:italic}sub,sup{font-size:65%;line-height:0;position:relative;vertical-align:baseline;margin:0 .1em}sup{top:-.6em}sub{bottom:-.25em}.text-center{text-align:center}.text-right{text-align:right}.break{word-break:break-all;-webkit-hyphens:auto;hyphens:auto}.nowrap{white-space:nowrap}ol,ul{margin:0 0 1em 1.5em;padding:0;text-align:left}ol ol,ol ul,ul ol,ul ul{margin:.5em 0 0 1.5em}li{margin:0 0 .5em}ol.unstyled,ul.unstyled{margin:0;list-style:none}ol.unstyled li,ul.unstyled li{margin:0}hr{display:block;height:1px;background:#aaa;margin:1em 0;padding:0;clear:both}hr,img{border:0}img{vertical-align:middle;-ms-interpolation-mode:bicubic;max-width:100%;height:auto}figure{margin:0}blockquote{margin:1.5em 0}blockquote,q{font-style:italic}q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:none}.hidden,[hidden]{display:none!important;visibility:hidden!important}table{border-collapse:collapse;border-spacing:0}table,td{border:none}td{vertical-align:top}table.fixed{table-layout:fixed}table.grid td{border-bottom:1px solid #c5c2cc;border-right:1px solid #c5c2cc}table.grid tr td:last-child{border-right:none}table.grid tr:last-child td{border-bottom:none}@media print{body,html{color:#000;background:transparent}h2,h3,p{orphans:3;widows:3}h1,h2,h3{page-break-after:avoid}p a,p a:visited{text-decoration:underline}p a[href]:after{content:" (" attr(href) ")"}blockquote,img,pre,tr{page-break-inside:avoid}img{max-width:100%!important}@page{margin:.5cm}}button,form,input,select,textarea{border:none;margin:0;padding:0}input:invalid{box-shadow:none}button,input,select,textarea{display:inline-block;background:transparent;font-family:inherit;font-size:inherit;font-weight:inherit}input[type=date],input[type=email],input[type=password],input[type=text],textarea{cursor:text}button,select{cursor:pointer}form.form-large{max-width:600px;margin:0 auto}.form-row{display:flex;flex-direction:row;flex-wrap:wrap}.form-row .form-field{width:180px;flex-grow:1}.form-large p{margin:0 8px 16px}.form-large .btn,.form-large .icon-btn{margin:12px 8px}.form-field{display:block;position:relative;padding:8px}.form-field-style,.form-field input,.form-field select,.form-field textarea,x-polypad-embed pre{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:no-repeat top 12px right 10px/24px 24px;background-color:#f6f6f6;border:1px solid rgba(0,0,0,.1);color:#000;border-radius:4px;box-sizing:border-box;display:block;line-height:1.4em;padding:18px 16px 4px;transition:border .2s,background .2s,box-shadow .2s;width:100%}html[theme=dark] .form-field-style,html[theme=dark] .form-field input,html[theme=dark] .form-field select,html[theme=dark] .form-field textarea,html[theme=dark] x-polypad-embed pre,x-polypad-embed html[theme=dark] pre{background-color:#43424d;border-color:hsla(0,0%,100%,.5);color:#fff}.form-field-style:not([disabled]):focus,.form-field-style:not([disabled]):hover,.form-field input:not([disabled]):focus,.form-field input:not([disabled]):hover,.form-field select:not([disabled]):focus,.form-field select:not([disabled]):hover,.form-field textarea:not([disabled]):focus,.form-field textarea:not([disabled]):hover,x-polypad-embed pre:not([disabled]):focus,x-polypad-embed pre:not([disabled]):hover{background-color:#eee}html[theme=dark] .form-field-style:not([disabled]):focus,html[theme=dark] .form-field-style:not([disabled]):hover,html[theme=dark] .form-field input:not([disabled]):focus,html[theme=dark] .form-field input:not([disabled]):hover,html[theme=dark] .form-field select:not([disabled]):focus,html[theme=dark] .form-field select:not([disabled]):hover,html[theme=dark] .form-field textarea:not([disabled]):focus,html[theme=dark] .form-field textarea:not([disabled]):hover,html[theme=dark] x-polypad-embed pre:not([disabled]):focus,html[theme=dark] x-polypad-embed pre:not([disabled]):hover,x-polypad-embed html[theme=dark] pre:not([disabled]):focus,x-polypad-embed html[theme=dark] pre:not([disabled]):hover{background-color:#64646d}.form-field-style:not([disabled]):focus,.form-field input:not([disabled]):focus,.form-field select:not([disabled]):focus,.form-field textarea:not([disabled]):focus,x-polypad-embed pre:not([disabled]):focus{border-color:#0f82f2;box-shadow:0 0 0 3px rgba(15,130,242,.5);outline:none}.form-field-style:not([disabled]):focus+.placeholder,.form-field input:not([disabled]):focus+.placeholder,.form-field select:not([disabled]):focus+.placeholder,.form-field textarea:not([disabled]):focus+.placeholder,x-polypad-embed pre:not([disabled]):focus+.placeholder{color:#0f82f2}.form-field-style[disabled],.form-field input[disabled],.form-field select[disabled],.form-field textarea[disabled],x-polypad-embed pre[disabled]{cursor:default!important;opacity:.6}.form-field-style.no-label,.form-field input.no-label,.form-field select.no-label,.form-field textarea.no-label,x-polypad-embed pre.no-label{padding-top:4px;background-position:top 5px right 10px}.form-field input::-moz-placeholder{opacity:0}.form-field input::placeholder{opacity:0}.form-field input:-moz-placeholder-shown{padding:11px 16px}.form-field input:placeholder-shown{padding:11px 16px}.form-field input:-moz-placeholder-shown+.placeholder{transform:none}.form-field input:placeholder-shown+.placeholder{transform:none}.form-field input.dirty:not(:focus){padding-right:36px}.form-field input.dirty:not(:focus).valid,.form-field input.dirty:not(:focus):valid{background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%2322ab24%22%20d%3D%22m19.7%206.3-.2-.4-.3-.2c-.1-.1-.3%200-.4%200a36.6%2036.6%200%200%200%20-9.8%208.4%2036.1%2036.1%200%200%200%20-4.8-2.9h-.5l-1%20.9a.4.4%200%200%200%20-.1.3c0%20.2%200%20.3.1.4a72.1%2072.1%200%200%201%206.6%207h.4a.5.5%200%200%200%20.4-.2c3.8-6.8%205.7-9.6%209.4-13%20.2.1.2-.1.2-.3z%22%2F%3E%3C%2Fsvg%3E")}.form-field input.dirty:not(:focus).invalid,.form-field input.dirty:not(:focus):invalid{background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%3E%3Crect%20x%3D%2210%22%20y%3D%228%22%20width%3D%224%22%20height%3D%2212%22%20fill%3D%22%23fff%22%2F%3E%3Cpath%20fill%3D%22%23cd0e66%22%20d%3D%22M22.1%2C19.5l-9.2-16a1%2C1%2C0%2C0%2C0-1.8%2C0l-9.2%2C16A1%2C1%2C0%2C0%2C0%2C2.7%2C21H21.3A1%2C1%2C0%2C0%2C0%2C22.1%2C19.5Zm-8.7-11v2.4l-.4%2C4.4H11.1l-.4-4.4V8.5ZM12%2C19.4a1.6%2C1.6%2C0%2C0%2C1-1.6-1.6%2C1.6%2C1.6%2C0%2C1%2C1%2C3.2%2C0A1.6%2C1.6%2C0%2C0%2C1%2C12%2C19.4Z%22%2F%3E%3C%2Fsvg%3E");border-color:#cd0e66}.form-field textarea{height:auto;resize:vertical;padding:10px 16px}.form-field textarea::-moz-placeholder{color:#aaa;opacity:1;-moz-transition:color .2s;transition:color .2s}.form-field textarea::placeholder{color:#aaa;opacity:1;transition:color .2s}.form-field textarea:active::-moz-placeholder, .form-field textarea:focus::-moz-placeholder{color:#0f82f2}.form-field textarea:active::placeholder,.form-field textarea:focus::placeholder{color:#0f82f2}.form-field select{padding-right:40px;background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22%234d4d4d%22%20d%3D%22m19.9%207.5a1.4%201.4%200%200%200%20-2.1%200l-5.8%205.8-5.8-5.8a1.4%201.4%200%200%200%20-2.1%200%201.5%201.5%200%200%200%200%202.1l6.8%206.9a1.6%201.6%200%200%200%202.2%200l6.8-6.9a1.4%201.4%200%200%200%200-2.1z%22%2F%3E%3C%2Fsvg%3E")}.form-field .form-error,.form-field .form-hint{margin:4px 17px 0;font-size:14px;line-height:1.3}.form-field .form-error{color:#cd0e66}.form-field .placeholder{position:absolute;line-height:1.4em;top:19px;left:24px;transition:transform .2s,color .2s;color:#aaa;transform-origin:top left;transform:translateY(-7px) scale(.7);pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.form-checkbox{padding-left:40px;min-height:28px;cursor:pointer;display:block;position:relative;margin:16px 8px}.form-checkbox input{position:absolute;left:5px;top:7px;opacity:0}.form-checkbox .control{background:#f6f6f6;border:1px solid rgba(0,0,0,.1);border-radius:4px;height:22px;left:0;position:absolute;top:2px;width:22px;transition:border .2s,background .2s,box-shadow .2s}.form-checkbox .control:after{display:block;content:" ";width:21px;height:21px;background:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%2221%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20fill%3D%22white%22%20d%3D%22m19.7%206.3-.2-.4-.3-.2c-.1-.1-.3%200-.4%200a36.6%2036.6%200%200%200%20-9.8%208.4%2036.1%2036.1%200%200%200%20-4.8-2.9h-.5l-1%20.9a.4.4%200%200%200%20-.1.3c0%20.2%200%20.3.1.4a72.1%2072.1%200%200%201%206.6%207h.4a.5.5%200%200%200%20.4-.2c3.8-6.8%205.7-9.6%209.4-13%20.2.1.2-.1.2-.3z%22%2F%3E%3C%2Fsvg%3E");top:0;left:1px;position:absolute;transform:scale(0);transition:transform .4s cubic-bezier(.33,1.9,.52,.7)}.form-checkbox:hover .control,.form-checkbox input:focus+.control{border-color:#0f82f2;background:#eee}.form-checkbox input:focus+.control{box-shadow:0 0 0 3px rgba(15,130,242,.5);outline:none}.form-checkbox input:checked+.control{background:#0f82f2}.form-checkbox input:checked+.control:after{transform:none}.form-checkbox:hover input:checked+.control,.form-checkbox input:focus:checked+.control{border-color:#053563}.input-field{display:block;border-radius:4px;cursor:text;text-align:center;padding:0;color:inherit;line-height:1.7em;border:1px solid;transition:border .2s,background .2s,box-shadow .2s,color .2s;-webkit-appearance:none;-moz-appearance:textfield}.input-field:focus{border-color:#0f82f2;box-shadow:0 0 0 3px rgba(15,130,242,.5);outline:none}.input-field::-webkit-inner-spin-button,.input-field::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.btn,.icon-btn{display:inline-block;width:auto;text-align:center;border:none;border-radius:24px;cursor:pointer;color:hsla(0,0%,100%,.95);transition:background .2s,color .2s,box-shadow .2s;min-width:48px;padding:0 1.2em;height:2em;line-height:2em;font-weight:600;letter-spacing:.2px;background-color:#181824;-webkit-appearance:none;-moz-appearance:none;appearance:none;outline:none;transition:transform .3s,background .2s,color .2s,box-shadow .2s,opacity .2s}.btn.on,.btn:hover,.icon-btn:hover,.on.icon-btn{z-index:10;color:#fff;box-shadow:0 4px 12px rgba(0,0,0,.25)}.btn.disabled,.btn[disabled],.disabled.icon-btn,[disabled].icon-btn{box-shadow:none;cursor:default;pointer-events:none}.btn:hover,.icon-btn:hover{transform:scale(1.08)}.btn:active,.icon-btn:active{transform:scale(.92)}.btn:active,.btn:hover,.icon-btn:active,.icon-btn:hover{background-color:#504b5c}html.is-tabbing .btn:focus,html.is-tabbing .icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #181824}.btn.disabled,.btn[disabled],.disabled.icon-btn,[disabled].icon-btn{background-color:#ddd!important;color:#999!important}.btn x-icon,.icon-btn x-icon{opacity:.95;transition:opacity .2s;margin:0 6px -6px 0;fill:currentColor}.btn:active x-icon,.btn:hover x-icon,.icon-btn:active x-icon,.icon-btn:hover x-icon{opacity:1}.btn-small{height:1.6em;line-height:1.6em;padding:0 .8em}.btn-large{font-size:22px;padding:0 20px;height:44px;line-height:44px}.btn-large x-icon{margin:0 10px -6px -2px}.btn-large .arrow{margin:0 -2px -1px 6px}.btn-row{margin:-10px}.btn-row .btn,.btn-row .icon-btn{margin:10px}.btn-red{background-color:#cd0e66;-webkit-touch-callout:none;outline:none}.btn-red:focus,.btn-red:hover{background-color:#ef1579}html.is-tabbing .btn-red:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #ef1579}.btn-blue{background-color:#0f82f2;-webkit-touch-callout:none;outline:none}.btn-blue:focus,.btn-blue:hover{background-color:#3696f4}html.is-tabbing .btn-blue:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #3696f4}.btn-green{background-color:#22ab24;-webkit-touch-callout:none;outline:none}.btn-green:focus,.btn-green:hover{background-color:#29cd2b}html.is-tabbing .btn-green:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #29cd2b}.btn-yellow{background-color:#fd8c00;-webkit-touch-callout:none;outline:none}.btn-yellow:focus,.btn-yellow:hover{background-color:#ff9e27}html.is-tabbing .btn-yellow:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #ff9e27}.btn-grey{background-color:#656073;-webkit-touch-callout:none;outline:none}.btn-grey:focus,.btn-grey:hover{background-color:#797389}html.is-tabbing .btn-grey:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #797389}.btn-white{-webkit-touch-callout:none;outline:none}.btn-white,.btn-white:focus,.btn-white:hover{background-color:#fff}html.is-tabbing .btn-white:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #fff}.btn-white,.btn-white:active,.btn-white:hover{color:#3a3645}.btn.facebook,.facebook.icon-btn{background-color:#1878f2;-webkit-touch-callout:none;outline:none}.btn.facebook:focus,.btn.facebook:hover,.facebook.icon-btn:focus,.facebook.icon-btn:hover{background-color:#3f8ff4}html.is-tabbing .btn.facebook:focus,html.is-tabbing .facebook.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #3f8ff4}.btn.twitter,.twitter.icon-btn{background-color:#00b6f1;-webkit-touch-callout:none;outline:none}.btn.twitter:focus,.btn.twitter:hover,.twitter.icon-btn:focus,.twitter.icon-btn:hover{background-color:#1bc7ff}html.is-tabbing .btn.twitter:focus,html.is-tabbing .twitter.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #1bc7ff}.btn.youtube,.youtube.icon-btn{background-color:red;-webkit-touch-callout:none;outline:none}.btn.youtube:focus,.btn.youtube:hover,.youtube.icon-btn:focus,.youtube.icon-btn:hover{background-color:#ff2929}html.is-tabbing .btn.youtube:focus,html.is-tabbing .youtube.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #ff2929}.btn.instagram,.instagram.icon-btn{background-color:#bc2a8d;-webkit-touch-callout:none;outline:none}.btn.instagram:focus,.btn.instagram:hover,.instagram.icon-btn:focus,.instagram.icon-btn:hover{background-color:#d33ba2}html.is-tabbing .btn.instagram:focus,html.is-tabbing .instagram.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #d33ba2}.btn.pinterest,.pinterest.icon-btn{background-color:#cb2027;-webkit-touch-callout:none;outline:none}.btn.pinterest:focus,.btn.pinterest:hover,.pinterest.icon-btn:focus,.pinterest.icon-btn:hover{background-color:#df353c}html.is-tabbing .btn.pinterest:focus,html.is-tabbing .pinterest.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #df353c}.btn.tumblr,.tumblr.icon-btn{background-color:#35465d;-webkit-touch-callout:none;outline:none}.btn.tumblr:focus,.btn.tumblr:hover,.tumblr.icon-btn:focus,.tumblr.icon-btn:hover{background-color:#445a77}html.is-tabbing .btn.tumblr:focus,html.is-tabbing .tumblr.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #445a77}.btn.reddit,.reddit.icon-btn{background-color:#ff5700;-webkit-touch-callout:none;outline:none}.btn.reddit:focus,.btn.reddit:hover,.reddit.icon-btn:focus,.reddit.icon-btn:hover{background-color:#ff7229}html.is-tabbing .btn.reddit:focus,html.is-tabbing .reddit.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #ff7229}.btn.microsoft,.microsoft.icon-btn{background-color:#2f2f2f;-webkit-touch-callout:none;outline:none}.btn.microsoft:focus,.btn.microsoft:hover,.microsoft.icon-btn:focus,.microsoft.icon-btn:hover{background-color:#434343}html.is-tabbing .btn.microsoft:focus,html.is-tabbing .microsoft.icon-btn:focus{box-shadow:0 0 0 2px currentColor,0 0 0 4px #434343}.btn.google,.google.icon-btn{background:#fff;color:#3a3645;box-shadow:inset 0 0 0 1px #aaa}.btn.google:hover,.google.icon-btn:hover{box-shadow:inset 0 0 0 1px #aaa,0 4px 12px rgba(0,0,0,.25)}html.is-tabbing .btn.google:focus,html.is-tabbing .google.icon-btn:focus{box-shadow:inset 0 0 0 1px #aaa,0 0 0 2px #fff,0 0 0 4px #656073}.icon-btn{display:block;padding:0;min-width:40px;height:40px;border-radius:20px}.icon-btn x-icon{display:block;margin:8px}@font-face{font-family:Mathigon Symbol;src:url(/fonts/mathigon-symbol.woff2) format("woff2"),url(/fonts/mathigon-symbol.woff) format("woff");font-weight:400;font-style:normal}.math,math{display:inline-block;margin:0 .1em;font-style:normal;font-weight:400}.nowrap .math,.nowrap math{margin-right:0}mfenced,mfrac,mi,mn,mo,mroot,mrow,ms,msqrt,msub,msup,mtext{display:inline-block;font-size:inherit;line-height:1;white-space:nowrap;font-family:Mathigon Symbol,Source Sans Pro,sans-serif}mi[mathvariant=normal]{font-family:Source Sans Pro,sans-serif}mi{line-height:.9}mo{margin:0 .25em}mn+.cursor+mi,mn+mi{margin-left:.1em}mi+mi{margin-left:.05em}mfrac+.coursor+mi,mfrac+.cursor+mtext,mfrac+mi,mfrac+mtext{margin-left:.15em}mo[value=\u2212]:first-child{margin:0 .1em}mo[value="="],mo[value=\u2248]{margin:0 .4em}mo[value=\u2221],mo[value=\u25B3]{margin:0}.cursor:first-child+mo,mn+mo[value=\u2026],mo+.cursor+mo,mo+.cursor+mo[value],mo+mo,mo+mo[value],mo:first-child,mo[lspace="0"],mo[value=\xB0],mo[value=\u2019]{margin-left:0}mo:last-child,mo[rspace="0"]{margin-right:0}mtext{font-family:Source Sans Pro,Helvetica,sans-serif}mspace{padding:0 .2em}mphantom{visibility:hidden}ms:after,ms:before{content:'"'}ms[lquote]:before{content:attr(lquote)}ms[rquote]:after{content:attr(rquote)}msubsup>:nth-child(3),msup>:last-child{font-size:67%;margin:-.2em .1em 0 .15em;vertical-align:top}msub>:last-child,msubsup>:nth-child(2){font-size:67%;margin:0 .1em -.2em;vertical-align:bottom}mfrac,msub>:last-child mo,msubsup>:nth-child(3) mo,msup>:last-child mo{margin:0 .1em}mfrac{font-size:.6em;vertical-align:-.2em}mfrac>*{display:block;text-align:center}mfrac>:first-child{padding-bottom:.06em}mfrac>:last-child{border-top:1px solid;float:right;padding-top:.06em;width:100%}mfrac:after{content:"\xA0";visibility:hidden;width:0}.display mfrac,.text-center:not(.inline) mfrac,table mfrac{font-size:1em;vertical-align:-.45em}.display mfrac mfrac,.text-center:not(.inline) mfrac mfrac,mfrac mfrac{font-size:75%;vertical-align:-.25em}mroot,msqrt{border-top:1px solid;margin-left:9px;padding:.1em .1em 0 .2em;position:relative}mroot:before,msqrt:before{background:currentColor;-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2213%22%20height%3D%2222%22%3E%3Cpath%20d%3D%22M3%2C11.72l-1.56.7-.42-1%2C2.93-1.3%2C2.55%2C7.61c.15.46.26.95.37%2C1.41h.09c.09-.46.18-.95.26-1.41L11.12%2C1h1.32L7.67%2C21.13H6.28Z%22%2F%3E%3C%2Fsvg%3E");mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2213%22%20height%3D%2222%22%3E%3Cpath%20d%3D%22M3%2C11.72l-1.56.7-.42-1%2C2.93-1.3%2C2.55%2C7.61c.15.46.26.95.37%2C1.41h.09c.09-.46.18-.95.26-1.41L11.12%2C1h1.32L7.67%2C21.13H6.28Z%22%2F%3E%3C%2Fsvg%3E");-webkit-mask-size:100% 100%;mask-size:100% 100%;position:absolute;content:"";bottom:0;left:-11px;top:-2px;width:13px}mroot>:last-child{position:absolute;font-size:67%;right:calc(100% + 5px);margin-top:-5px}mfenced{margin:0 calc(5px + .1em);padding:.05em .1em;position:relative}mfenced:after,mfenced:before{bottom:-1px;top:-1px;content:"";width:5px}mfenced:before{-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%225%22%20height%3D%2222%22%3E%3Cpath%20d%3D%22M0%2C11A18.32%2C18.32%2C0%2C0%2C1%2C2.91%2C1L4%2C1.53A18.32%2C18.32%2C0%2C0%2C0%2C1.5%2C11%2C18.33%2C18.33%2C0%2C0%2C0%2C4%2C20.47L2.91%2C21A18.32%2C18.32%2C0%2C0%2C1%2C0%2C11Z%22%2F%3E%3C%2Fsvg%3E");mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%225%22%20height%3D%2222%22%3E%3Cpath%20d%3D%22M0%2C11A18.32%2C18.32%2C0%2C0%2C1%2C2.91%2C1L4%2C1.53A18.32%2C18.32%2C0%2C0%2C0%2C1.5%2C11%2C18.33%2C18.33%2C0%2C0%2C0%2C4%2C20.47L2.91%2C21A18.32%2C18.32%2C0%2C0%2C1%2C0%2C11Z%22%2F%3E%3C%2Fsvg%3E");left:-4px}mfenced:after,mfenced:before{background:currentColor;-webkit-mask-size:100% 100%;mask-size:100% 100%;position:absolute}mfenced:after{-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%225%22%20height%3D%2222%22%3E%3Cpath%20d%3D%22M1%2C20.47A18.33%2C18.33%2C0%2C0%2C0%2C3.5%2C11%2C18.32%2C18.32%2C0%2C0%2C0%2C1%2C1.53L2.09%2C1A18.32%2C18.32%2C0%2C0%2C1%2C5%2C11%2C18.32%2C18.32%2C0%2C0%2C1%2C2.09%2C21Z%22%2F%3E%3C%2Fsvg%3E");mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%225%22%20height%3D%2222%22%3E%3Cpath%20d%3D%22M1%2C20.47A18.33%2C18.33%2C0%2C0%2C0%2C3.5%2C11%2C18.32%2C18.32%2C0%2C0%2C0%2C1%2C1.53L2.09%2C1A18.32%2C18.32%2C0%2C0%2C1%2C5%2C11%2C18.32%2C18.32%2C0%2C0%2C1%2C2.09%2C21Z%22%2F%3E%3C%2Fsvg%3E");right:-4px}mfenced[open="|"]{margin:0 .1em;padding:0 .1em;border-left:1px solid;border-right:1px solid}mfenced[open="|"]:after,mfenced[open="|"]:before{content:none}mfenced[open="["]:before{content:"["}mfenced[close="]"]:after{content:"]"}mfenced[open="{"]:before{content:"{"}mfenced[close="}"]:after{content:"}"}mover,munder{position:relative}mover>:nth-child(2){position:absolute;left:0;right:0;height:5px;font-size:0}mover>[value=\u203E]:nth-child(2){top:0;-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M0%2C2L21%2C2L21%2C3L0%2C3Z%22%2F%3E%3C%2Fsvg%3E");mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M0%2C2L21%2C2L21%2C3L0%2C3Z%22%2F%3E%3C%2Fsvg%3E")}mover>[value=\u203E]:nth-child(2),mover>[value=\u2192]:nth-child(2){background:currentColor;-webkit-mask-size:100% 100%;mask-size:100% 100%;position:absolute}mover>[value=\u2192]:nth-child(2){top:-2px;-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M21%2C2.5L15.7%2C0.3L16.5%2C2L0%2C2L0%2C3L16.5%2C3L15.7%2C4.7L21%2C2.5Z%22%2F%3E%3C%2Fsvg%3E");mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M21%2C2.5L15.7%2C0.3L16.5%2C2L0%2C2L0%2C3L16.5%2C3L15.7%2C4.7L21%2C2.5Z%22%2F%3E%3C%2Fsvg%3E")}mover>[value=\u2194]:nth-child(2){-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M21%2C2.5L15.7%2C0.3L16.5%2C2L4.5%2C2L5.3%2C0.3L0%2C2.5L5.3%2C4.7L4.5%2C3L16.5%2C3L15.7%2C4.7L21%2C2.5Z%22%2F%3E%3C%2Fsvg%3E");mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M21%2C2.5L15.7%2C0.3L16.5%2C2L4.5%2C2L5.3%2C0.3L0%2C2.5L5.3%2C4.7L4.5%2C3L16.5%2C3L15.7%2C4.7L21%2C2.5Z%22%2F%3E%3C%2Fsvg%3E")}mover>[value=\u2194]:nth-child(2),mover>[value=\u2312]:nth-child(2){top:-2px;background:currentColor;-webkit-mask-size:100% 100%;mask-size:100% 100%;position:absolute}mover>[value=\u2312]:nth-child(2){-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M20.5%2C4.5a.52.52%2C0%2C0%2C1-.29-.09A17.1%2C17.1%2C0%2C0%2C0%2C10.5%2C1.5%2C17.1%2C17.1%2C0%2C0%2C0%2C.79%2C4.41a.5.5%2C0%2C0%2C1-.7-.13.5.5%2C0%2C0%2C1%2C.12-.69A18.22%2C18.22%2C0%2C0%2C1%2C10.5.5%2C18.22%2C18.22%2C0%2C0%2C1%2C20.79%2C3.59a.5.5%2C0%2C0%2C1%2C.12.69A.5.5%2C0%2C0%2C1%2C20.5%2C4.5Z%22%2F%3E%3C%2Fsvg%3E");mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2221%22%20height%3D%225%22%3E%3Cpath%20d%3D%22M20.5%2C4.5a.52.52%2C0%2C0%2C1-.29-.09A17.1%2C17.1%2C0%2C0%2C0%2C10.5%2C1.5%2C17.1%2C17.1%2C0%2C0%2C0%2C.79%2C4.41a.5.5%2C0%2C0%2C1-.7-.13.5.5%2C0%2C0%2C1%2C.12-.69A18.22%2C18.22%2C0%2C0%2C1%2C10.5.5%2C18.22%2C18.22%2C0%2C0%2C1%2C20.79%2C3.59a.5.5%2C0%2C0%2C1%2C.12.69A.5.5%2C0%2C0%2C1%2C20.5%2C4.5Z%22%2F%3E%3C%2Fsvg%3E")}.modal-background{position:fixed;z-index:400;top:44px;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);display:none;transition:background .4s;-webkit-backdrop-filter:blur(4px)}.modal-background.light{background:hsla(0,0%,100%,.9)}html.webview .modal-background{top:0}x-modal{z-index:401;position:fixed;width:520px;max-width:calc(100% - 40px);max-height:calc(100vh - 84px);background:#fff;border-radius:12px;top:50%;left:50%;margin-top:22px;transform:translate(-50%,-50%);box-shadow:0 6px 32px rgba(0,0,0,.8);display:none;box-sizing:border-box}html[theme=dark] x-modal{background:#2d2c38}x-modal.light{box-shadow:0 4px 20px rgba(0,0,0,.25)}html.webview x-modal{max-height:calc(100% - 40px);margin-top:0}x-modal .modal-body{height:100%;max-height:calc(100vh - 84px);padding:24px;box-sizing:border-box;overflow:auto;-webkit-overflow-scrolling:touch;overscroll-behavior:contain}@media screen and (max-height:720px){x-modal.interactive{top:42px;transform:translate(-50%)}}.is-safari:not(.is-webview) x-modal,.is-safari:not(.is-webview) x-modal .modal-body{max-height:calc(100vh - 200px)}x-modal h2{margin-top:0}x-modal h2 x-icon{margin:-6px 4px -6px -2px}x-modal h3{margin:1.5em 0 .8em}x-modal h3 x-icon{margin:0 5px -5px 0}x-modal .btn-row{text-align:right;margin:0}x-modal .form-large{margin:0 -8px -10px}x-modal p:last-child:not(.btn-row){margin-bottom:0}x-modal .form-checkbox{margin:16px 0}x-modal hr{margin:1.5em 0}x-modal .close{fill:rgba(0,0,0,.4);position:absolute;right:0;top:0;padding:8px;transition:transform .2s,color .2s;cursor:pointer;z-index:10;display:block}html[theme=dark] x-modal .close{fill:hsla(0,0%,100%,.4)}x-modal .close:hover{transform:scale(1.4);color:#000}html[theme=dark] x-modal .close:hover{color:#fff}x-modal.video{border-radius:0;background:#000;width:1200px}x-modal.video .video-wrap{position:relative;height:0;padding-bottom:56.25%}x-modal.video iframe,x-modal.video video{position:absolute;width:100%;height:100%}x-modal.video .close x-icon{fill:hsla(0,0%,100%,.8);top:-40px}x-select.segmented{display:flex;margin:0 auto .5em;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}x-select.segmented>*{width:100px;text-align:center;border:1px solid #cd0e66;border-left:none;transition:color .2s,background .2s;cursor:pointer}x-select.segmented>:first-child{border-radius:20px 0 0 20px;border-left:1px solid #cd0e66}x-select.segmented>:last-child{border-radius:0 20px 20px 0}x-select.segmented>:hover{background:rgba(205,14,102,.18)}x-select.segmented>.active{color:#fff;background:#cd0e66;cursor:default}html.is-tabbing x-select.segmented>:focus{box-shadow:0 0 0 2px #fff,0 0 0 4px #cd0e66;outline:none;z-index:1}.snackbar{position:fixed;top:52px;left:50%;z-index:500;transform:translateX(-50%)}x-alert{background:#cd0e66;border-radius:6px;box-shadow:0 3px 8px rgba(0,0,0,.3);padding:8px 20px;color:#fff;display:none;max-width:300px;font-size:16px;line-height:1.4;width:-webkit-max-content;width:-moz-max-content;width:max-content}x-alert x-icon{margin:-2px 6px 20px -4px;float:left}x-alert.error{background:#b50c5a}x-alert.success{background:#1e9620}x-icon{display:inline-block;width:24px;height:24px;fill:currentColor}x-icon svg{display:block}x-icon[name=warning]{fill:#cd0e66}.button x-icon{margin:-10px 3px -10px -8px}x-progress{border:2px solid;border-radius:100%;box-sizing:border-box}x-progress svg{display:block;margin:-14px;pointer-events:none;max-width:none}x-progress path.done,x-progress path.pie{transform:translate(12px,12px)}x-progress path.pie{fill:none;transition:stroke-dasharray .2s;stroke:currentColor}x-progress line{stroke:currentColor;stroke-width:2px}header{position:fixed;width:100%;top:0;height:44px;background:#181824;z-index:450;color:#fff;-webkit-user-select:none;-moz-user-select:none;user-select:none;box-shadow:0 0 12px rgba(0,0,0,.25)}header #logo,header .nav-link{display:block;font-size:18px;line-height:44px;height:44px}header #logo{float:left;padding:4px 4px 4px 16px;margin-right:-12px;box-sizing:border-box}header #logo img,header #logo svg{height:36px;width:auto;float:left}header #logo span{line-height:36px;display:inline-block;float:left;margin:0 8px}@media (max-width:420px){header #logo img:last-child,header #logo svg:last-child{display:none}}header #skip-nav{position:absolute;top:2px;left:-9999px;height:32px;padding:2px 18px;background:#3a3645;border:2px solid #181824;border-radius:30px}html.is-tabbing header #skip-nav:focus{left:2px}header nav{float:right;display:flex}header .nav-link{padding:0 16px;opacity:.8;transition:opacity .2s,background .2s;cursor:pointer}header .nav-link:focus,header .nav-link:hover{opacity:1;background:#4b4757}header .nav-link x-icon{margin:0 8px -6px -2px;vertical-align:baseline}header .nav-link.narrow{padding:0 12px}header .nav-link.narrow x-icon{margin:0;display:block}header .nav-link.popup-target{padding-right:18px}header .nav-item.open .nav-link{opacity:1;background:#4b4757}header .nav-user-icon{display:block;width:28px;height:28px;border-radius:100%;border:1px solid hsla(0,0%,100%,.5)}header .popup-body{position:absolute;top:44px;right:0;display:none;background:rgba(24,24,36,.91);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:0 0 0 6px;border-left:1px solid hsla(0,0%,100%,.3);border-bottom:1px solid hsla(0,0%,100%,.3);background-clip:content-box}header .popup-body .nav-link{padding:0 18px;white-space:nowrap;box-sizing:border-box;width:100%;text-align:left;transition:background .2s,color .2s;color:hsla(0,0%,100%,.8);position:relative}header .popup-body .nav-link:before{content:" ";display:block;height:1px;background:hsla(0,0%,100%,.4);transition:background-color .2s;position:absolute;width:calc(100% - 36px);top:0}header .popup-body .nav-link:first-child:before{display:none}header .popup-body .nav-link.active,header .popup-body .nav-link.on,header .popup-body .nav-link:focus,header .popup-body .nav-link:hover{background:hsla(0,0%,100%,.2);color:#fff}header .popup-body .nav-link.active+:before,header .popup-body .nav-link.active:before,header .popup-body .nav-link.on+:before,header .popup-body .nav-link.on:before,header .popup-body .nav-link:focus+:before,header .popup-body .nav-link:focus:before,header .popup-body .nav-link:hover+:before,header .popup-body .nav-link:hover:before{background:transparent}header .popup-body .nav-link.active,header .popup-body .nav-link.on{background:hsla(0,0%,100%,.32)}header .popup-body .nav-link.logout{max-width:300px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}header .popup-body .nav-link:last-child{border-radius:0 0 0 6px}header .popup-body .nav-link img{float:right;margin:10px 2px 0 12px}header .popup-body .nav-link .form-checkbox{float:right;margin:8px 2px 0 12px;padding-left:24px}@media (max-width:680px){header .nav-link{padding:0 12px}header .nav-link.narrow{padding:0 10px}header .nav-link x-icon{margin-right:6px}}@media (max-width:620px){header .nav-item>.nav-link{padding:4px 8px;height:36px}header .nav-item>.nav-link x-icon{display:block;margin:0 auto;width:24px;height:24px}header .nav-text{display:block;line-height:12px;font-size:10px;text-align:center}}x-modal#language{width:540px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.locale-list{-moz-column-count:3;column-count:3}@media (max-width:560px){.locale-list{-moz-column-count:2;column-count:2}}@media (max-width:420px){.locale-list{-moz-column-count:1;column-count:1}}.locale-link{display:block;padding:4px 8px;border-radius:6px;transition:background .2s;margin:2px 0;-webkit-column-break-inside:avoid;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.locale-link:hover{background:#e2e1e6}html[theme=dark] .locale-link:hover{background:hsla(0,0%,100%,.2)}.locale-link img{margin-right:8px}#search{width:480px}#search .modal-body{padding:12px;overflow:visible}#search .form-field{padding:0}#search .form-field input{padding:8px 16px 8px 48px;font-size:24px;border-radius:40px;line-height:32px}#search .form-field input::-moz-placeholder{color:inherit;opacity:.5}#search .form-field input::placeholder{color:inherit;opacity:.5}#search .form-field input:focus{box-shadow:0 0 0 3px #87c1f9}#search .form-field x-icon{position:absolute;left:13px;top:11px;fill:currentColor}#search .search-body{padding:8px 8px 6px 48px;min-height:180px;max-height:calc(100vh - 160px);overflow:auto}#search .search-body:after,#search .search-body:before{display:table;content:" ";clear:both}@media screen and (max-width:420px){#search .search-body{padding-left:8px}}#search .search-section{font-weight:600;font-size:14px;text-transform:uppercase}#search .search-result{margin:0 -6px;height:48px;display:block;padding:6px;border-radius:6px;line-height:1.2;transition:background .2s}#search .search-result:focus,#search .search-result:hover{background:#e2e1e6}html[theme=dark] #search .search-result:focus,html[theme=dark] #search .search-result:hover{background:hsla(0,0%,100%,.2)}#search .search-img{width:48px;height:48px;background:#000;background-size:cover;border-radius:4px;float:left;margin-right:10px}#search .search-subtitle{font-size:14px;color:#aaa;margin-top:4px}#search .search-subtitle,#search .search-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}#search .search-title{font-size:20px;font-weight:600}#search .search-gloss{background:#fed199;border-radius:6px;margin:6px 0;padding:8px 14px;font-size:16px;line-height:1.4}#search .search-gloss:after,#search .search-gloss:before{display:table;content:" ";clear:both}#search .search-gloss img{border:0;float:right;width:160px;margin:0 -12px 0 0}#search .search-gloss .math,#search .search-gloss x-math{white-space:nowrap}#search .search-gloss li,#search .search-gloss p,#search .search-gloss ul{margin-bottom:.3em}#search .search-gloss li:last-child,#search .search-gloss p:last-child,#search .search-gloss ul:last-child{margin-bottom:0}#search .no-results{margin-top:32px;text-align:center;padding-right:32px;color:#aaa}@media screen and (max-width:420px){#search .no-results{padding:0}}#search .no-results svg{width:80px;margin:0 auto;fill:#aaa}.global-footer{margin:50px 0 40px;border-top:1px solid #ccc;padding-top:6px;font-size:15px;color:#aaa;display:flex}.global-footer .footer-left{flex-grow:1}.global-footer .footer-right{text-align:right}.global-footer .footer-row{margin:4px 0}.global-footer button{position:relative;cursor:pointer;margin-left:24px;line-height:inherit}.global-footer button img{position:absolute;left:-24px;top:2px}.global-footer .dot{display:inline-block;margin:0 8px}.global-footer .footer-left a,.global-footer button{display:inline-block;background-size:0 100%;background-repeat:no-repeat;background-image:linear-gradient(transparent calc(100% - 2px),currentColor calc(100% - 2px),currentColor calc(100% - 1px),transparent calc(100% - 1px));transition:color .2s,background-size .2s ease-in-out}.global-footer .footer-left a:hover,.global-footer button:hover{background-size:100% 100%;color:#333}html[theme=dark] .global-footer .footer-left a:hover,html[theme=dark] .global-footer button:hover{color:#fff}.global-footer .footer-social{display:inline-block;padding:6px 3px;margin:-5px 0 -11px;color:#aaa;transition:color .2s}.global-footer .footer-social x-icon{display:block}.global-footer .footer-social:hover{color:#333}html[theme=dark] .global-footer .footer-social:hover{color:#fff}@media (max-width:760px){.global-footer{display:block;font-size:16px;margin-bottom:30px}.global-footer .footer-left,.global-footer .footer-right{text-align:center}.global-footer .footer-row{margin-bottom:10px}.global-footer .footer-social{padding:6px}.global-footer .footer-social svg{width:28px;height:28px;margin:0 4px}.global-footer button img{width:20px;height:20px;left:-26px;top:3px}}.course{border-top:1px solid #c5c2cc;-moz-column-count:2;column-count:2;-moz-column-gap:10px;column-gap:10px;min-height:80px;padding:18px 0 18px 90px;position:relative}@media screen and (max-width:660px){.course{-moz-column-count:1;column-count:1}}.course .course-img{width:80px;height:80px;background-size:cover;border-radius:6px;position:absolute;left:0;top:18px}.course h3{margin:0 0 8px 8px;-moz-column-span:all;column-span:all}.course h3 img{margin:-4px 0 0 8px}.course .course-banner{float:right;color:#fff;font-size:14px;font-weight:400;border-radius:20px;padding:2px 10px;margin:0 0 4px 6px}.course .course-section{border-radius:4px;-moz-column-break-inside:avoid;break-inside:avoid;font-size:16px;line-height:1.2;padding:7px 8px 7px 34px;page-break-inside:avoid}.course .course-section.locked{color:#aaa;position:relative}.course .course-section.locked .tooltip{top:7px;right:0;left:auto;transform:none;background:#656073;padding:1px 10px}.course a.course-section{display:block;transition:background .2s;outline:none}.course a.course-section:focus,.course a.course-section:hover{background:#e2e1e6}html[theme=dark] .course a.course-section:focus,html[theme=dark] .course a.course-section:hover{background:hsla(0,0%,100%,.2)}.course .course-section.locked x-icon,.course x-progress{display:inline-block;margin:0 6px -4px -26px;fill:#c5c2cc}html{font-family:Source Sans Pro,Helvetica,sans-serif;cursor:default;background-color:#fff;min-width:320px;font-size:18px;line-height:1.6;touch-action:manipulation}html[theme=dark]{background:#22212e}html:not(.ready) *{transition:none!important;-webkit-animation:none!important;animation:none!important}html:not(.is-tabbing) :focus{outline:none!important}html.grabbing,html.grabbing *{cursor:-webkit-grabbing!important;cursor:grabbing!important}body{color:#333}html[theme=dark] body{color:hsla(0,0%,100%,.9)}main{padding-top:44px}html.webview main{padding-top:0}.container{width:1000px;max-width:calc(100% - 48px);margin:0 auto;position:relative}.container.narrow{width:800px}.container.wide{width:1200px}.panel.narrow{max-width:800px;margin:0 auto}svg.mathjax{display:inline-block}svg.mathjax g,svg.mathjax path,svg.mathjax use{transform-origin:0 0;transform-box:initial}.is-mobile .only-desktop,.not-mobile .only-mobile,.not-touch .only-touch{display:none!important}@media screen and (max-width:480px){.xs-hide{display:none!important}}@media screen and (max-width:640px){.s-hide{display:none!important}}@media screen and (min-width:641px){.l-hide{display:none!important}}@media screen and (min-width:801px){.xl-hide{display:none!important}}.invert{filter:none}html[theme=dark] .invert{filter:invert(1)}.r{position:relative}.column,.row{display:flex;flex-wrap:wrap;justify-content:center}.column{flex-direction:column}.row.right{flex-direction:row-reverse}.column.padded,.row.padded{margin:-24px}.column.padded>*,.row.padded>*{margin:24px}.column.padded-thin,.row.padded-thin{margin:-12px}.column.padded-thin>*,.row.padded-thin>*{margin:12px}.column .grow,.row .grow{flex-grow:1}.column .shrink,.row .shrink{flex-shrink:1}.row>*>h2:first-child,.row>*>h3:first-child{margin-top:0}.padded-thin>*>p:last-child,.padded>*>p:last-child{margin-bottom:0}.text-medium{color:#999}button.a,label a,ol a,p a,ul a{color:#0f82f2;background-size:0 100%;background-repeat:no-repeat;background-image:linear-gradient(transparent calc(100% - 3px),currentColor calc(100% - 3px),currentColor calc(100% - 1px),transparent calc(100% - 1px));transition:color .2s,background-size .2s ease-in-out}button.a:hover,label a:hover,ol a:hover,p a:hover,ul a:hover{background-size:100% 100%}.caption{font-size:80%;margin:0 0 .6em;text-align:left;color:#888}.emoji{font-size:inherit;margin:-4px 2px 0;display:inline-block;line-height:normal;vertical-align:middle;width:20px;height:20px}img.emoji{width:auto}.tooltip{position:absolute;top:-22px;white-space:nowrap;left:50%;transform:translateX(-50%);font-size:14px;background:#181824;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);opacity:0;border-radius:16px;pointer-events:none;padding:2px 12px;transition:opacity .1s;color:#fff;border:1px solid #fff;line-height:18px;z-index:9999}.is-tabbing.not-mobile :focus>.tooltip,.not-mobile :hover>.tooltip{opacity:.8}.alert{padding:12px 44px 12px 20px;border-radius:4px;background:fade(#fd8c00,40%);position:relative;margin-bottom:2em}.alert.fail{background:fade(#cd0e66,40%)}.alert.success{background:fade(#22ab24,40%)}.alert p:last-child{margin:0}.alert .close{position:absolute;top:0;right:0;font-weight:700;padding:0 13px;font-size:30px;cursor:pointer;opacity:.6}.alert .close:hover{opacity:1}.warning{z-index:900;display:block;position:fixed;top:0;left:0;right:0;bottom:0;background:#181824 url(/images/tiles.png);background-size:240px 240px}.warning-body{max-width:calc(100% - 48px);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.warning-body svg{margin:0 auto 20px;width:100px;height:100px}.warning-body p{color:#fff;background:#cd0e66;border-radius:4px;padding:8px 16px;text-align:center}.warning-body a:hover{color:#3f9bf5}.cookie-warning{border-radius:4px;background:#b50c5a;padding:10px 16px 12px;box-sizing:border-box;position:fixed;left:10px;bottom:10px;color:#fff;z-index:800;max-width:calc(100vw - 20px);box-shadow:0 3px 6px rgba(0,0,0,.3);line-height:1.4}.cookie-warning h2{color:hsla(0,0%,100%,.8);font-weight:100;margin:0 0 6px;font-size:24px}.cookie-warning p{margin-bottom:12px}.cookie-warning .btn,.cookie-warning .icon-btn{color:#b50c5a}.cookie-warning .close{cursor:pointer;top:2px;right:2px;position:absolute;padding:12px;opacity:.6;transition:opacity .2s}.cookie-warning .close:hover{opacity:1}.cookie-warning x-icon{display:block}x-share{display:flex;margin:-4px;flex-wrap:wrap;justify-content:center}x-share .btn,x-share .icon-btn{width:36px;height:36px;margin:4px;padding:8px;min-width:0;border-radius:8px;box-shadow:none}x-share .btn x-icon,x-share .icon-btn x-icon{margin:0}x-share .btn.classroom,x-share .classroom.icon-btn{background:url(https://www.gstatic.com/classroom/logo_square_48.svg);background-size:cover}x-algebra-flow,x-math{position:relative}x-algebra-flow svg.equation,x-math svg.equation{width:100%;fill:currentColor;overflow:visible}x-algebra-flow svg.equation *,x-math svg.equation *{transform-origin:0 0}x-algebra-flow .overlay,x-math .overlay{position:absolute;top:0;left:0}x-algebra-flow .overlay>*,x-math .overlay>*{position:absolute;transform-origin:0 0}x-algebra-flow line,x-algebra-flow path,x-math line,x-math path{fill:none;stroke:currentColor;stroke-width:1.45;stroke-linejoin:round;stroke-linecap:round;transform-box:view-box;transform-origin:top left}x-algebra-flow text,x-math text{font-family:Mathigon Symbol,Source Sans Pro,sans-serif;dominant-baseline:text-before-edge;stroke:currentColor;fill:currentColor;stroke-width:0}x-algebra-flow text.font-normal,x-math text.font-normal{font-family:Source Sans Pro,Helvetica,sans-serif}x-math{display:inline-block;font-style:normal}x-math svg.equation{height:100%}x-algebra-flow{display:block;position:relative;margin:1.5em auto;max-width:440px}x-algebra-flow .legend-box{border-top:2px solid #ccc;font-size:16px;line-height:1.5}x-algebra-flow .legend-box p{display:none}x-algebra-flow .legend-box li{padding:8px 48px 0;display:none;margin:0;text-align:center}x-algebra-flow .nav{height:0;position:relative}x-algebra-flow .back,x-algebra-flow .next{position:absolute;display:block;top:0;width:36px;height:36px;padding:0;min-width:0;border-radius:0 0 6px 6px;z-index:1;transition:opacity .4s,background .2s,color .2s,box-shadow .2s}x-algebra-flow .back.hide,x-algebra-flow .next.hide{opacity:0;pointer-events:none}x-algebra-flow .back x-icon,x-algebra-flow .next x-icon{margin:6px}x-algebra-flow .back{transform-origin:left top}x-algebra-flow .next{right:0;transform-origin:right top}.m-red{color:#cd0e66}.m-blue{color:#0f82f2}.m-green{color:#22ab24}.m-yellow{color:#fd8c00}.m-orange{color:#eb4726}.m-purple{color:#6d3bbf}.m-teal{color:#009ea6}.m-lime{color:#bfc212}.lgrey{color:#aaa}.gradient-red{background:#cd0e66 linear-gradient(to bottom right,#cd0e66,#eb4726)}.gradient-orange{background:#eb4726 linear-gradient(to bottom right,#eb4726,#fd8c00)}.gradient-yellow{background:#fd8c00 linear-gradient(to bottom right,#fd8c00,#bfc212)}.gradient-lime{background:#bfc212 linear-gradient(to bottom right,#bfc212,#22ab24)}.gradient-green{background:#22ab24 linear-gradient(to bottom right,#22ab24,#009ea6)}.gradient-teal{background:#009ea6 linear-gradient(to bottom right,#009ea6,#0f82f2)}.gradient-blue{background:#0f82f2 linear-gradient(to bottom right,#0f82f2,#6d3bbf)}.gradient-purple{background:#6d3bbf linear-gradient(to bottom right,#6d3bbf,#cd0e66)}x-modal#login{width:500px}x-modal#login .modal-body{padding:24px 16px 12px}x-modal#login h2{text-align:center}x-modal#login .btn-row.social{display:flex;flex-wrap:wrap;justify-content:center}x-modal#login .btn-row.social .btn,x-modal#login .btn-row.social .icon-btn{margin:6px}x-modal#login .hr{height:1px;margin:1em 8px;background:#c5c2cc;position:relative}x-modal#login .hr span{background:#fff;display:block;left:50%;position:absolute;text-align:center;margin-top:-7px;font-size:14px;color:#aaa;line-height:1;text-transform:uppercase;white-space:nowrap;padding:0 12px;transform:translateX(-50%)}.tile{transform-origin:0 0;transform-box:view-box}.group-outline,.rotate-bar,.tile .outline{stroke:#181824;stroke-width:6px;stroke-linejoin:round;stroke-linecap:round;fill:none}html[theme=dark] .group-outline,html[theme=dark] .rotate-bar,html[theme=dark] .tile .outline{stroke:#e2e1e6}.group-outline,.rotate-bar{pointer-events:none}.group-outline{fill:rgba(0,0,0,.25)}html[theme=dark] .group-outline{fill:hsla(0,0%,100%,.25)}.rotate-circle,.tile .handle{fill:#181824;cursor:-webkit-grab;cursor:grab;stroke:transparent;stroke-linejoin:round;stroke-width:6px}html[theme=dark] .rotate-circle,html[theme=dark] .tile .handle{fill:#e2e1e6}.tile .handle{cursor:ew-resize}.tile path.handle{stroke:#181824}html[theme=dark] .tile path.handle{stroke:#e2e1e6}.tile .handle,.tile .outline{display:none}.active .tile .handle,.active .tile .outline,.tile .handle.active,.tile .outline.active{display:block}.balance,.number-tile,.polygon-tile{stroke:#fff;stroke-width:1px;stroke-linejoin:round}x-polypad .balance,x-polypad .number-tile,x-polypad .polygon-tile{stroke:#fff}html[theme=dark] x-polypad .balance,html[theme=dark] x-polypad .number-tile,html[theme=dark] x-polypad .polygon-tile{stroke:#22212e}.fraction line{stroke:#fff;stroke-width:2}.source .fraction line{stroke-width:1}.no-labels .fraction line{display:none}.prime-background{fill:#fff}html[theme=dark] .prime-background{fill:#22212e}x-polypad .prime-move{stroke:#181824;stroke-width:6px;stroke-linejoin:round}html[theme=dark] x-polypad .prime-move{stroke:#e2e1e6}.grid-axis,.number-line-ticks{stroke-width:3px;stroke-linecap:round;stroke-linejoin:round}.active .grid-axis,.active .number-line-ticks{stroke-width:6px}x-polypad-sidebar .grid-axis,x-polypad-sidebar .number-line-ticks{stroke:#fff;stroke-width:2px}.axis-gridlines{stroke-width:2px;opacity:.15;stroke-linecap:round;pointer-events:none}.penrose-circles{fill:none;stroke-width:2px;stroke:#fff;opacity:.4}.dice-face{stroke-width:4px;stroke-linejoin:round}.dice-dot{fill:#fff;opacity:.85}.balance-beam{fill:none;stroke-width:8px;stroke-linejoin:round}.active .balance,.active .balance-beam,.active .bucket{stroke:#181824;stroke-width:6px}html[theme=dark] .active .balance,html[theme=dark] .active .balance-beam,html[theme=dark] .active .bucket{stroke:#e2e1e6}.balance-target{display:none;fill:transparent;stroke:#181824;stroke-width:4px;stroke-linejoin:round;stroke-dasharray:12px 10px}html[theme=dark] .balance-target{stroke:#e2e1e6}.spinner{fill:#181824;stroke:#fff;stroke-width:1px;stroke-linejoin:round}html[theme=dark] .spinner{fill:#e2e1e6;stroke:#22212e}x-polypad-sidebar .spinner{stroke-width:1px}.utensil .glass{fill:rgba(197,194,204,.7)}html[theme=dark] .utensil .glass{fill:rgba(101,96,115,.7)}.utensil .ticks{pointer-events:none;stroke-width:.6;stroke:#000}html[theme=dark] .utensil .ticks{stroke:#fff}.utensil text{font-size:12px;text-anchor:middle;fill:#000}html[theme=dark] .utensil text{fill:#fff}.dot-cell{fill:none;stroke-width:20px;stroke-linejoin:round;fill-opacity:.3}.dot-label{text-anchor:middle;font-weight:600;fill:#fff}html[theme=dark] .dot-label{fill:#22212e}.axis-labels text{stroke:#fff;stroke-width:4px;paint-order:stroke;stroke-linejoin:round;font-weight:700;font-size:16px}html[theme=dark] .axis-labels text{stroke:#22212e}html.is-safari .axis-labels text{stroke:none}.bead-gradient{stroke:#fff;fill:url(#sphere-gradient);pointer-events:none}html[theme=dark] .bead-gradient{stroke:#22212e}.active .bead-gradient{stroke:#181824;stroke-width:6px}html[theme=dark] .active .bead-gradient{stroke:#e2e1e6}.bucket-label,.fraction text,.number-line text,.polygon-label,.prime-label{font-weight:600;text-anchor:middle;font-size:18px}.bucket-label,.fraction text,.polygon-label,.prime-label{fill:#fff}.no-labels .bucket-label,.no-labels .fraction text,.no-labels .polygon-label,.no-labels .prime-label{display:none}.prime-label{fill:#181824;stroke:#fff;stroke-width:4px;paint-order:stroke;stroke-linejoin:round}html[theme=dark] .prime-label{fill:#e2e1e6;stroke:#22212e}html.is-safari .prime-label{stroke:none}.bucket-label{font-size:38px;font-weight:400}.number-line text{transform-origin:center;transform-box:fill-box}x-polypad-sidebar .polygon-label{font-size:16px}x-polypad-sidebar .fraction text{font-size:10px}x-polypad-sidebar .number-line text{font-size:15px;fill:#fff}.hidden-input{position:absolute;width:0;height:0;overflow:hidden;transform:scale(0);display:none}.problem-box{stroke:#0f82f2;stroke-width:4px;fill:#cfe6fc;transition:stroke .3s,fill .3s}html[theme=dark] .problem-box{fill:#1e3455}.correct .problem-box{stroke:#22ab24;fill:#d3eed3}html[theme=dark] .correct .problem-box{fill:#223d2c}.incorrect .problem-box{stroke:#cd0e66;fill:#f5cfe0}html[theme=dark] .incorrect .problem-box{fill:#441d39}.active .problem-box{stroke-width:6px}.problem-text{text-anchor:middle;font-size:32px;fill:#181824;color:#181824;text-align:center}html[theme=dark] .problem-text{fill:#e2e1e6;color:#e2e1e6}.problem-marker{transform:scale(0);transition:transform .2s cubic-bezier(.33,1.9,.52,.7)}.problem-marker.show{transform:none}@-webkit-keyframes cursor{0%,to{opacity:1}50%{opacity:0}}@keyframes cursor{0%,to{opacity:1}50%{opacity:0}}.equation{transform-origin:0 0}.equation line,.equation path{fill:none;stroke:currentColor;stroke-width:1.45;stroke-linejoin:round;stroke-linecap:round;transform-box:view-box;transform-origin:top left}.equation text{font-family:Mathigon Symbol,Source Sans Pro,sans-serif;dominant-baseline:text-before-edge;stroke:currentColor;fill:currentColor;stroke-width:0}.equation text.font-normal{font-family:Source Sans Pro,Helvetica,sans-serif}.equation .placeholder{fill:currentColor;opacity:.3}.equation .cursor{stroke:#0f82f2;stroke-linecap:round;stroke-width:1.5px;-webkit-animation:cursor 1s step-end infinite;animation:cursor 1s step-end infinite}.equation .range{fill:#87c1f9}.polypad-settings{background:#c5c2cc;box-shadow:0 2px 6px rgba(0,0,0,.12);border-radius:6px;font-size:14px;padding:6px 0 8px}html[theme=dark] .polypad-settings{background:#3a3645}.polypad-settings h3{margin:0 12px 4px;font-size:15px;line-height:26px;text-align:center}.polypad-settings .row{padding:2px 12px 2px 16px}.polypad-settings .label{flex-grow:1;margin-right:8px;text-align:right;line-height:26px}.polypad-settings .input-field{width:60px;border-color:#807c89;background:hsla(0,0%,100%,.5)}html[theme=dark] .polypad-settings .input-field{border-color:hsla(0,0%,100%,.5);background:hsla(0,0%,100%,.15)}.polypad-settings .input-field:focus,.polypad-settings .input-field:hover{background:#fff}html[theme=dark] .polypad-settings .input-field:focus,html[theme=dark] .polypad-settings .input-field:hover{background:hsla(0,0%,100%,.3)}.polypad-settings .input-field:focus,html[theme=dark] .polypad-settings .input-field:focus{border-color:#0f82f2}.geo-path{fill:none;stroke:currentColor;stroke-width:3px;stroke-linecap:round;stroke-linejoin:round}.geo-point{fill:currentColor}.geo-point.locked{stroke:currentColor;stroke-width:3px;fill:#f5f5f6}html[theme=dark] .geo-point.locked{fill:#2d2c38}svg:not(:hover) .geo-point.pending{display:none!important}.geo-shadow{display:none;stroke-width:10px;stroke:currentColor;fill:none}x-polypad{display:block;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;overflow:hidden;touch-action:none}x-polypad .canvas{width:100%;height:100%;outline:none}x-polypad .html-overlay,x-polypad .html-overlay>*{position:absolute;top:0;left:0}x-polypad .selection{stroke:#87c1f9;fill:rgba(135,193,249,.5);display:none}x-polypad .stroke{stroke-width:3px;fill:none;stroke-linecap:round;stroke-linejoin:round}x-polypad .stroke.marker{stroke-width:8px}x-polypad .stroke.highlighter{stroke-width:24px;opacity:.4;mix-blend-mode:multiply}html[theme=dark] x-polypad .stroke.highlighter{mix-blend-mode:normal}x-polypad .stroke.cut{stroke:#000;stroke-dasharray:10px}html[theme=dark] x-polypad .stroke.cut{stroke:#fff}x-polypad[data-tool=text]{cursor:text}x-polypad[data-tool=pan]{cursor:move}x-polypad[data-tool=cutPolygon],x-polypad[data-tool=geo],x-polypad[data-tool=geoPending]{cursor:crosshair}x-polypad[data-tool=pen]{cursor:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAZUlEQVR4AWJwL/AB8DEGJgDCQAz8EX7EbOZIHeFHiV4hKKAWrjzJkY1tXSzfj1vpIx0zY0muKnf3vsnocJBEQIn0gCyyEFeW3qDDQczaJzz+X4mRiOeIsppoz6AHD0wDRvAQHeAAguXO6bw3SrQAAAAASUVORK5CYII=) 5 5,auto;cursor:-webkit-image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAZUlEQVR4AWJwL/AB8DEGJgDCQAz8EX7EbOZIHeFHiV4hKKAWrjzJkY1tXSzfj1vpIx0zY0muKnf3vsnocJBEQIn0gCyyEFeW3qDDQczaJzz+X4mRiOeIsppoz6AHD0wDRvAQHeAAguXO6bw3SrQAAAAASUVORK5CYII=) 1x,url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAJ1BMVEVHcEz///////////////////////8AAAD///9wcHAwMDDf399gYGCQhTdXAAAAB3RSTlMA759wYBCvzmM0WgAAAGdJREFUeNptkVsKwCAMBJP6yKi9/3kLxQYsO5/DisnGXlrtDt5rs6Q4Gy+fu2CNGTHHgivdiM3YtsAdyQ3FrPnOZdabVVYcLKr1DGa0mzNPOXGD+AFSyufyIzmSHF6tqQrR1emS5TkegZUJJUoarYQAAAAASUVORK5CYII=) 2x) 5 5,auto}x-polypad[data-tool=eraser]{cursor:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUBAMAAAB/pwA+AAAAMFBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAD////v7+8gICC/v79AQEDT09MAAACfn58wMDBKyk2zAAAAB3RSTlMA759wEGCvta0l/AAAAGRJREFUCNdjYGBgCZO9mOrAAAKG+47XvBYGsZhmlQPBSgUgU78dxKz4xMDAPKMcDDoNGByXQ5hVIgzR5VCwlSEPxnzGIANjHmS4DmPWIjORFCBpQzIMyQoki5Gcg+xIJKfDPQQAeUtQWzzU2P8AAAAASUVORK5CYII=) 10 10,auto;cursor:-webkit-image-set(url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUBAMAAAB/pwA+AAAAMFBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAD////v7+8gICC/v79AQEDT09MAAACfn58wMDBKyk2zAAAAB3RSTlMA759wEGCvta0l/AAAAGRJREFUCNdjYGBgCZO9mOrAAAKG+47XvBYGsZhmlQPBSgUgU78dxKz4xMDAPKMcDDoNGByXQ5hVIgzR5VCwlSEPxnzGIANjHmS4DmPWIjORFCBpQzIMyQoki5Gcg+xIJKfDPQQAeUtQWzzU2P8AAAAASUVORK5CYII=) 1x,url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAMFBMVEVHcEwAAAAAAAAAAAAAAAABAQEAAAAAAAAAAAAgICBYWFiXl5e/v7////9AQEDPz8/yxGM3AAAACXRSTlMAQHi/z/8Zn+8OOe6YAAAAzklEQVR42sWV0a6EIBBDETmIMKP//7d34zUb3cjStz3PTQs4U8OdKc6JF2mOU+iSl8KFsuSODFhrM39hra7AkzQWqOYXrEKJD3bb7h/s26dpTtD8gQYp33Xmj9hNucDuHXZY3vc4/bqe8QwuNP9Co+QzePOvbP/h+XLA7jHzYVh9QD0sC+YDjBLCxOpDVqYQj+RhdgwzzYc05pAwH2KkAC4APxTKl5GfR35w+ROqQyGPmTy46irIy6Wuq1oAcqXIJaXXnl6kejXrZS//Pv4AjK46OUdio5kAAAAASUVORK5CYII=) 2x) 10 10,auto}x-polypad .geo-paths,x-polypad .geo-points,x-polypad .geo-shadows,x-polypad .grid,x-polypad .selection,x-polypad .strokes,x-polypad:not([data-tool=move]) .tiles{pointer-events:none}x-polypad .geo-shadows{opacity:.3}x-polypad .grid-pattern line,x-polypad .grid-pattern rect{stroke:#000;fill:none}html[theme=dark] x-polypad .grid-pattern line,html[theme=dark] x-polypad .grid-pattern rect{stroke:#fff}x-polypad .grid-pattern .filled,x-polypad .grid-pattern circle{fill:#000;stroke:none}html[theme=dark] x-polypad .grid-pattern .filled,html[theme=dark] x-polypad .grid-pattern circle{fill:#fff}x-polypad .text-edit{alignment-baseline:hanging;top:0;padding:2px 8px;font-size:20px;line-height:1.4em;transform-origin:0 0;-webkit-user-modify:read-write-plaintext-only;-webkit-user-select:text;-moz-user-select:text;user-select:text;white-space:pre;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}x-polypad .text-edit[contenteditable]{cursor:text}x-polypad .image-drop{position:absolute;top:0;left:0;width:100%;height:100%;display:none;border:6px dashed #0f82f2;box-sizing:border-box;background:rgba(15,130,242,.1);pointer-events:none}x-polypad .panels{position:absolute;top:8px;right:8px}x-polypad.handdrawn .canvas{filter:url(#handdrawn)}x-polypad.handdrawn .geo-paths,x-polypad.handdrawn .strokes{filter:url(#pencil)}x-polypad-sidebar{position:absolute;top:8px;left:8px;z-index:6;border-radius:6px;color:hsla(0,0%,100%,.8);overflow:hidden;box-shadow:0 3px 8px rgba(0,0,0,.3);display:none;transition:height .4s ease-out,width .4s ease-out;height:40px}x-polypad-sidebar[tabs="1"]{width:48px}x-polypad-sidebar[tabs="2"]{width:97px}x-polypad-sidebar[tabs="3"]{width:146px}x-polypad-sidebar.open{width:300px;height:calc(100% - 16px)}.webview x-polypad-sidebar.open{height:calc(100% - 16px - env(safe-area-inset-bottom))}x-polypad-sidebar .sidebar-header{display:flex;margin-bottom:1px}x-polypad-sidebar .sidebar-header button{height:40px;display:block;flex-grow:1;border-right:1px solid #3a3645;overflow:hidden;cursor:pointer;background:#3a3645;position:relative;color:hsla(0,0%,100%,.6);transition:color .2s,background .2s,border .2s}x-polypad-sidebar .sidebar-header button:last-child{border-right:0}x-polypad-sidebar .sidebar-header button x-icon{margin:0 12px;display:block}x-polypad-sidebar .sidebar-header button span{position:absolute;white-space:nowrap;top:8px;left:42px;opacity:0;transition:opacity .2s}x-polypad-sidebar .sidebar-header button .close{opacity:0;transition:opacity .2s;position:absolute;right:8px;top:8px;margin:0}x-polypad-sidebar .sidebar-header button.active,x-polypad-sidebar .sidebar-header button:focus,x-polypad-sidebar .sidebar-header button:hover{background:#181824;color:#fff}x-polypad-sidebar[tabs="3"] .sidebar-header button .close{display:none}x-polypad-sidebar[tabs="3"] .sidebar-header button:nth-child(2) span{left:38px}x-polypad-sidebar.open .sidebar-header button{background:#504e59;border-color:#65636e}x-polypad-sidebar.open .sidebar-header button:focus,x-polypad-sidebar.open .sidebar-header button:hover{background:#3e3d49}x-polypad-sidebar.open .sidebar-header button.active{background:#292735}x-polypad-sidebar.open .sidebar-header button span{opacity:1}x-polypad-sidebar.open .sidebar-header button.active:hover .close{opacity:.5;transition-delay:.6s}x-polypad-sidebar .sidebar-body{position:absolute;width:300px;background:#292735;top:40px;border-top:1px solid #65636e;bottom:0}x-polypad-sidebar .sidebar-panel{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch;overscroll-behavior:contain;background:#292735;display:none;transition:transform .4s ease-out}x-polypad-sidebar .sidebar-panel.left{transform:translateX(-100%)}x-polypad-sidebar .sidebar-panel.right{transform:translateX(100%)}x-polypad-sidebar h2,x-polypad-sidebar h3{font-weight:600;border-top:1px solid #65636e;padding:2px 16px;margin:0}x-polypad-sidebar h2{font-size:18px;line-height:36px}x-polypad-sidebar h2:first-child{border:none;margin-top:6px}x-polypad-sidebar h3{font-size:16px;line-height:30px;padding-left:9px;letter-spacing:.01em}x-polypad-sidebar h2 x-icon{background:currentColor;fill:#fff;border-radius:100%;padding:3px;margin:0 3px -6px -6px}x-polypad-sidebar x-accordion{display:block}x-polypad-sidebar x-accordion .subsection{margin-left:32px}x-polypad-sidebar x-accordion h2,x-polypad-sidebar x-accordion h3{cursor:pointer;transition:background .2s,border .2s}x-polypad-sidebar x-accordion h2:focus,x-polypad-sidebar x-accordion h2:hover,x-polypad-sidebar x-accordion h3:focus,x-polypad-sidebar x-accordion h3:hover{background:hsla(0,0%,100%,.15)}x-polypad-sidebar x-accordion h2:focus+.subsection h3:first-child,x-polypad-sidebar x-accordion h2:hover+.subsection h3:first-child,x-polypad-sidebar x-accordion h3:focus+.subsection h3:first-child,x-polypad-sidebar x-accordion h3:hover+.subsection h3:first-child{border-color:transparent}x-polypad-sidebar p{margin:6px 16px;color:hsla(0,0%,100%,.85);font-size:16px;line-height:28px}x-polypad-sidebar .source-wrap{display:flex;flex-wrap:wrap;justify-content:space-evenly;padding-right:6px;margin:0 auto}x-polypad-sidebar .source-wrap:first-child{margin-top:4px}x-polypad-sidebar .source-wrap:last-child{margin-bottom:12px}x-polypad-sidebar .source-wrap>.source,x-polypad-sidebar .source-wrap>svg{margin:3px 0}x-polypad-sidebar .source-wrap .source{cursor:-webkit-grab;cursor:grab;touch-action:none}x-polypad-sidebar .caption,x-polypad-sidebar .source:after,x-polypad-sidebar .subtitle{display:block;font-size:14px;color:hsla(0,0%,100%,.5);line-height:1.2;text-align:center;width:100%}x-polypad-sidebar .source:after{content:attr(data-caption);font-size:12px}x-polypad-sidebar .caption{margin:0;padding:0 16px;box-sizing:border-box}x-polypad-sidebar .subtitle{margin:16px 0 4px;font-weight:600;font-size:15px;color:hsla(0,0%,100%,.7);border-top:1px solid #65636e;padding-top:12px}x-polypad-sidebar .subtitle:first-child{margin-top:6px;padding:0;border:0}x-polypad-sidebar .polypad-library .caption{margin-bottom:16px}x-polypad-sidebar .primes{display:flex;align-items:center;flex-grow:1;justify-content:center;margin:8px 20px 6px}x-polypad-sidebar .primes input{width:64px;margin-right:12px}x-polypad-sidebar .suits{display:flex;justify-content:center;width:100%;margin-bottom:4px}x-polypad-sidebar .suits button{cursor:pointer;padding:5px;opacity:.4;transition:opacity .2s}x-polypad-sidebar .suits button:hover{opacity:.7}x-polypad-sidebar .suits button.active{opacity:1}x-polypad-sidebar .suits button,x-polypad-sidebar .suits x-icon{display:block}x-polypad-sidebar .input-field{border-color:hsla(0,0%,100%,.5);background:hsla(0,0%,100%,.15)}x-polypad-sidebar .input-field:focus,x-polypad-sidebar .input-field:hover{background:hsla(0,0%,100%,.25)}x-polypad-sidebar .warn{line-height:1.4;margin:20px 16px;text-align:center}x-polypad-sidebar .warn x-icon{display:block;margin:0 auto 6px}x-polypad-sidebar .s-btn{background:hsla(0,0%,100%,.2);cursor:pointer;display:block;text-align:center;transition:background .2s,color .2s,opacity .15s;font-size:16px;font-weight:600}x-polypad-sidebar .s-btn x-icon{margin:0 2px -4px -2px}x-polypad-sidebar .s-btn:focus,x-polypad-sidebar .s-btn:hover{background:hsla(0,0%,100%,.35);color:#fff}x-polypad-sidebar .canvas-grid{display:flex;flex-wrap:wrap;justify-content:center;margin:-2px 0 8px}x-polypad-sidebar .canvas{padding:8px 0;width:132px;border-radius:4px;transition:background .2s}x-polypad-sidebar .canvas .thumb{margin:0 auto 3px;width:108px;height:72px;background:#fff 50%;border-radius:4px;background-size:contain}x-polypad-sidebar .canvas .title{text-align:center;margin:0;font-size:14px;font-weight:600;color:hsla(0,0%,100%,.75);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}x-polypad-sidebar .canvas .status{color:hsla(0,0%,100%,.4);font-size:12px;line-height:1.4;text-align:center}x-polypad-sidebar .canvas .status x-icon{margin:0 1px -3px 0}x-polypad-sidebar .current .title{width:94px;margin:3px 4px;line-height:24px;padding:0 20px 0 6px;text-align:left}x-polypad-sidebar .current .title:not(:hover):not(:focus){border-color:transparent;background:transparent}x-polypad-sidebar .current .canvas{position:relative}x-polypad-sidebar .current .canvas x-icon{position:absolute;top:88px;right:10px}x-polypad-sidebar .buttons{width:124px;margin:8px 4px 0;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}x-polypad-sidebar .buttons .s-btn{margin-top:1px;width:100%;font-size:16px;height:32px;line-height:32px}x-polypad-sidebar .buttons .s-btn:first-child{margin-top:0;border-radius:16px 16px 0 0}x-polypad-sidebar .buttons .s-btn:last-child{border-bottom-left-radius:16px;border-bottom-right-radius:16px}x-polypad-sidebar .buttons .s-btn.delete:focus,x-polypad-sidebar .buttons .s-btn.delete:hover{background:rgba(205,14,102,.8)}x-polypad-sidebar .buttons .s-btn.save{background:rgba(34,171,36,.8)}x-polypad-sidebar .buttons .s-btn.save:focus,x-polypad-sidebar .buttons .s-btn.save:hover{background:#22ab24}x-polypad-sidebar .buttons .s-btn.blue{background:rgba(15,130,242,.8)}x-polypad-sidebar .buttons .s-btn.blue:focus,x-polypad-sidebar .buttons .s-btn.blue:hover{background:#0f82f2}x-polypad-sidebar .buttons.row{width:auto;margin:14px}x-polypad-sidebar .buttons.row .s-btn{width:auto;flex-grow:1;margin:0 0 0 1px}x-polypad-sidebar .buttons.row .s-btn:last-child{border-radius:0}x-polypad-sidebar .buttons.row .s-btn:first-child{margin-left:0;border-radius:16px 0 0 16px}x-polypad-sidebar .buttons.row .s-btn:last-child{border-top-right-radius:16px;border-bottom-right-radius:16px}x-polypad-sidebar .loading{width:20px;height:20px;background:url(/images/loading-white.gif);background-size:20px 20px;margin:20px auto}x-polypad-sidebar a.canvas:focus,x-polypad-sidebar a.canvas:hover{background:hsla(0,0%,100%,.15)}x-polypad-sidebar a.canvas.active{background:hsla(0,0%,100%,.25);pointer-events:none}x-polypad-sidebar .canvas+h2{margin-top:6px}x-polypad-sidebar .classroom h2{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:40px}x-polypad-sidebar .title-options{position:absolute;display:flex;right:8px;margin-top:-38px}x-polypad-sidebar .title-options a,x-polypad-sidebar .title-options button,x-polypad-sidebar .title-options x-icon{display:block}x-polypad-sidebar .title-options a,x-polypad-sidebar .title-options button{padding:6px;cursor:pointer;transition:color .2s;color:hsla(0,0%,100%,.7)}x-polypad-sidebar .title-options a:focus,x-polypad-sidebar .title-options a:hover,x-polypad-sidebar .title-options button:focus,x-polypad-sidebar .title-options button:hover{color:#fff}x-polypad-sidebar .title-options .popup-body{position:relative;position:absolute;background:#4e4a58;width:180px;right:0;z-index:10;box-shadow:0 3px 8px rgba(0,0,0,.3);border-radius:6px;padding:4px;transform-origin:172px -4px}x-polypad-sidebar .title-options .popup-body:after{content:"";display:block;position:absolute;bottom:100%;left:50%;margin-left:-6px;border-bottom:6px solid #4e4a58;border-left:6px solid transparent;border-right:6px solid transparent;left:auto;right:12px}x-polypad-sidebar .title-options .popup-body>*{font-size:16px;padding:4px 10px;cursor:pointer;border-radius:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:background .2s,color .2s;color:hsla(0,0%,100%,.8);position:relative}x-polypad-sidebar .title-options .popup-body>:before{content:" ";display:block;height:1px;background:hsla(0,0%,100%,.4);transition:background-color .2s;position:absolute;width:160px;top:0}x-polypad-sidebar .title-options .popup-body>:first-child:before{display:none}x-polypad-sidebar .title-options .popup-body>.active,x-polypad-sidebar .title-options .popup-body>.on,x-polypad-sidebar .title-options .popup-body>:focus,x-polypad-sidebar .title-options .popup-body>:hover{background:hsla(0,0%,100%,.2);color:#fff}x-polypad-sidebar .title-options .popup-body>.active+:before,x-polypad-sidebar .title-options .popup-body>.active:before,x-polypad-sidebar .title-options .popup-body>.on+:before,x-polypad-sidebar .title-options .popup-body>.on:before,x-polypad-sidebar .title-options .popup-body>:focus+:before,x-polypad-sidebar .title-options .popup-body>:focus:before,x-polypad-sidebar .title-options .popup-body>:hover+:before,x-polypad-sidebar .title-options .popup-body>:hover:before{background:transparent}x-polypad-sidebar .title-options .popup-body>.active,x-polypad-sidebar .title-options .popup-body>.on{background:hsla(0,0%,100%,.32)}x-polypad-sidebar .title-options .popup-body>:focus,x-polypad-sidebar .title-options .popup-body>:hover{color:#fff}x-polypad-sidebar .title-options .popup-body>.active{background:#009ea6;font-weight:600;cursor:default}x-polypad-sidebar .form-checkbox.s-btn{margin:0;text-align:left;box-sizing:border-box;padding-left:44px}x-polypad-sidebar .form-checkbox.s-btn .control{left:14px;top:4px}x-polypad-sidebar p.help{font-size:14px;line-height:1.6;margin:0 16px 8px}x-polypad-sidebar .progress{background:hsla(0,0%,100%,.2);height:8px;border-radius:4px;margin:6px 12px 2px;overflow:hidden;display:flex}x-polypad-sidebar .progress *{height:8px;float:left;background:#22ab24}x-polypad-sidebar .progress :nth-child(2){background:#fd8c00}x-polypad-sidebar .progress :nth-child(3){background:#cd0e66}x-polypad-sidebar .canvas-grid.hide-names .progress,x-polypad-sidebar .canvas-grid.hide-names .title{display:none!important}#accessibility code{background:#f5f5f6;border:1px solid #c5c2cc;border-radius:4px;padding:0 3px;font-size:95%}x-color-picker{display:flex;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;justify-content:center}x-color-picker x-select{width:32px;margin-right:18px}x-color-picker .color-content{width:270px;height:90px}x-color-picker.custom .palette,x-color-picker:not(.custom) .sliders{display:none}x-color-picker .switch{cursor:pointer;transition:opacity .2s;opacity:.4}x-color-picker .switch:hover{opacity:.6}x-color-picker .switch.active{opacity:1}x-color-picker x-icon.switch{color:#fff}x-color-picker .palette{display:flex;flex-wrap:wrap}x-color-picker .palette button{width:30px;height:30px;box-sizing:border-box;cursor:pointer}x-color-picker .palette button.active{border:3px solid #fff;transform:scale(1.2);border-radius:4px}html.is-tabbing x-color-picker .palette button:focus,x-color-picker .palette button.active{z-index:1}x-color-picker .slider-row{display:flex}x-color-picker .slider-row:first-child{margin-top:-3px}x-color-picker .slider-row label{width:40px;display:block;line-height:32px;font-size:12px;margin:0 12px 0 0;text-transform:uppercase;color:hsla(0,0%,100%,.6)}x-color-picker .slider{height:16px;position:relative;margin:8px 0;border-radius:4px;width:210px;box-shadow:inset 0 0 0 1px rgba(0,0,0,.2)}x-color-picker .handle{width:24px;height:24px;position:absolute;margin:-4px -12px;background:#fff;border-radius:100%;box-shadow:0 2px 4px rgba(0,0,0,.4);cursor:pointer;transition:transform .2s}x-color-picker .handle.active,x-color-picker .handle:hover{transform:scale(1.2);box-shadow:0 4px 8px rgba(0,0,0,.3)}x-polypad-toolbar{position:absolute;bottom:8px;left:50%;z-index:5;transition:transform .4s;transform:translateX(-50%);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}@media screen and (min-width:680px){x-polypad-toolbar.shifted{transform:translateX(calc(144px - 50%))}}x-polypad-toolbar .bar{background:#3a3645;height:44px;border-radius:26px;display:flex;padding:1px 12px;box-shadow:0 3px 8px rgba(0,0,0,.3);z-index:1}html.webview x-polypad-toolbar{bottom:calc(8px + env(safe-area-inset-bottom))}x-polypad-toolbar>x-select{display:flex}x-polypad-toolbar .tool{cursor:pointer;padding:6px;position:relative}x-polypad-toolbar .tool x-icon{display:block;opacity:.35;transition:opacity .1s;fill:#fff}x-polypad-toolbar .tool:focus x-icon,x-polypad-toolbar .tool:hover x-icon{opacity:.7}x-polypad-toolbar .tool.active{cursor:default;pointer-events:none}x-polypad-toolbar .tool.active x-icon{opacity:1}x-polypad-toolbar .tooltip{top:-28px}@media screen and (max-width:410px){x-polypad-toolbar{padding:2px 8px}x-polypad-toolbar .tool{padding:6px 3px}}@media screen and (max-width:370px){x-polypad-toolbar .tool{padding:6px 2px}}x-polypad-toolbar .color-picker{display:block;position:relative;color:#fff}x-polypad-toolbar .color-picker .popup-target{display:block;cursor:pointer;width:30px;height:30px;border-radius:100%;margin:6px;border:1px solid hsla(0,0%,100%,.8);background:linear-gradient(180deg,transparent,rgba(0,0,0,.25))}x-polypad-toolbar .color-picker .popup-target.rainbow{background:radial-gradient(#fff,hsla(0,0%,100%,0) 60%),conic-gradient(#cd0e66,#6d3bbf,#0f82f2,#009ea6,#22ab24,#bfc212,#fd8c00,#eb4726,#cd0e66)}x-polypad-toolbar .color-picker .popup-body{position:relative;display:none;position:absolute;padding:12px;left:-151px;bottom:56px;background:#3a3645;border-radius:10px;box-shadow:0 3px 8px rgba(0,0,0,.3);transform-origin:center bottom;z-index:10}x-polypad-toolbar .color-picker .popup-body:after{content:"";display:block;position:absolute;top:100%;left:50%;margin-left:-8px;border-top:8px solid #3a3645;border-left:8px solid transparent;border-right:8px solid transparent}@media screen and (max-width:880px){x-polypad-toolbar .color-picker .popup-body{left:-280px;transform-origin:302px bottom}x-polypad-toolbar .color-picker .popup-body:after{left:302px}}x-polypad-toolbar .buttons{display:flex;position:absolute;bottom:54px;left:50%;transform:translateX(-50%)}x-polypad-toolbar .bar[hidden]+.buttons{bottom:0}x-polypad-toolbar .buttons button{-webkit-appearance:none;-moz-appearance:none;appearance:none;font-size:16px;background:#89868f;margin:0 4px;white-space:nowrap;font-weight:400;border-radius:20px;border:none;cursor:pointer;transition:background .2s,color .2s;position:relative;padding:0 20px;color:hsla(0,0%,100%,.95);height:2em;line-height:2em;box-shadow:0 2px 4px rgba(0,0,0,.2)}x-polypad-toolbar .buttons button:focus,x-polypad-toolbar .buttons button:hover{background:#615e6a;color:#fff}x-polypad-toolbar .buttons button.active{background:#3a3645;pointer-events:none}x-polypad-toolbar .buttons button x-icon{margin:0 3px -5px -4px}x-polypad-toolbar .buttons button.icon-only{padding:0 12px}x-polypad-toolbar .buttons button.icon-only x-icon{display:block;margin:0}x-polypad-toolbar .btn-group{display:flex;margin:0 3px;border-radius:24px;box-shadow:0 2px 4px rgba(0,0,0,.2)}x-polypad-toolbar .btn-group button{border-radius:0;margin:0 0 0 1px;box-shadow:none}x-polypad-toolbar .btn-group button:first-child{border-radius:20px 0 0 20px;margin-left:0}x-polypad-toolbar .btn-group button:last-child{border-bottom-right-radius:20px;border-top-right-radius:20px}x-polypad-toolbar .btn-group button.icon-only:first-child{padding-left:14px}x-polypad-toolbar .btn-group button.icon-only:last-child{padding-right:14px}x-polypad-toolbar .brushes{position:absolute;bottom:26px;left:50%;transform:translateX(-50%)}x-polypad-toolbar .brushes svg{margin:0 6px;filter:saturate(0) contrast(.3) brightness(1.5);transition:transform .2s,filter .2s;cursor:pointer}x-polypad-toolbar .brushes svg:focus,x-polypad-toolbar .brushes svg:hover{transform:translateY(-10px)}x-polypad-toolbar .brushes svg.active{filter:none;transform:translateY(-20px);cursor:default}x-polypad-settings{position:absolute;top:8px;right:8px;z-index:4;display:block}x-polypad-settings .settings-group{border-radius:6px;margin-bottom:8px;box-shadow:0 3px 8px rgba(0,0,0,.3)}x-polypad-settings .settings-group:last-child{margin:0}x-polypad-settings .settings-btn{display:block;padding:8px;cursor:pointer;background:#3a3645;transition:background .2s,color .2s;color:hsla(0,0%,100%,.7);position:relative}x-polypad-settings .settings-btn.dark{background:#292735}x-polypad-settings .settings-btn:focus,x-polypad-settings .settings-btn:not([disabled]):hover{background:#181824;color:#fff}x-polypad-settings .settings-btn x-icon{display:block}x-polypad-settings .settings-btn[disabled]{cursor:default;color:hsla(0,0%,100%,.3)}x-polypad-settings .settings-group>.settings-btn:first-child,x-polypad-settings .settings-group>x-popup:first-child .settings-btn{border-radius:6px 6px 0 0}x-polypad-settings .settings-group>.settings-btn:last-child,x-polypad-settings .settings-group>x-popup:last-child .settings-btn{border-bottom-left-radius:6px;border-bottom-right-radius:6px}x-polypad-settings .tooltip{transform:none;right:44px;left:auto;top:8px}x-polypad-settings .active .tooltip{opacity:0!important}x-polypad-settings x-popup{display:block;position:relative}x-polypad-settings .popup-body{position:relative;position:absolute;top:0;right:48px;padding:6px;background:#3a3645;border-radius:6px;transform-origin:right 20px;box-shadow:0 3px 8px rgba(0,0,0,.3)}x-polypad-settings .popup-body:after{content:"";display:block;position:absolute;left:100%;top:50%;margin-top:-6px;border-left:6px solid #3a3645;border-top:6px solid transparent;border-bottom:6px solid transparent;top:20px}x-polypad-settings .grid-popup{width:116px;display:flex;flex-wrap:wrap}x-polypad-settings .grid{cursor:pointer;width:48px;height:48px;border:3px solid #3a3645;border-radius:6px;margin:2px;transition:border .2s,opacity .2s;opacity:.6;background:hsla(0,0%,100%,.15)}x-polypad-settings .grid:focus,x-polypad-settings .grid:hover{border-color:#1873cf;opacity:.8}x-polypad-settings .grid.active{border-color:#0f82f2;cursor:default;opacity:1}x-polypad-settings .grid svg{display:block;width:48px;height:48px;border-radius:3px}x-polypad-settings .grid path{stroke:#fff}x-polypad-settings .grid.fill path,x-polypad-settings .grid circle{fill:#fff;stroke:none}x-polypad-settings .options-popup{width:220px;color:#fff;font-size:16px;padding:10px}x-polypad-settings .options-popup .row x-icon{margin:0 4px -4px 0}x-polypad-settings .options-popup .row{justify-content:space-between;align-items:center}x-polypad-settings .options-popup .row,x-polypad-settings .options-popup button{margin-bottom:8px}x-polypad-settings .options-popup .form-checkbox{margin:0;padding:0 12px}x-polypad-settings .options-popup .form-field{padding:0}x-polypad-settings .options-popup button:last-child{margin-bottom:0}#share .warn{background:rgba(205,14,102,.2);padding:6px;text-align:center;border-radius:6px}x-polypad-embed{font-size:16px}x-polypad-embed pre{white-space:normal;word-break:break-all;padding:6px 12px;cursor:text}x-polypad-embed h3{font-size:18px;margin:18px 0 6px}x-polypad-embed .form-checkbox{padding-left:28px;min-height:0;margin:0 0 6px}x-polypad-embed .form-checkbox .control{height:18px;width:18px}x-polypad-embed .form-checkbox .control:after{width:18px;height:18px;background-size:18px 18px}.polypad{background:#fff;position:relative;font-size:18px;font-family:Source Sans Pro,Helvetica,sans-serif;line-height:1.6;touch-action:manipulation;-webkit-user-select:none;-moz-user-select:none;user-select:none;overflow:hidden;width:100%;height:100%}.polypad[theme=dark]{background:#22212e}.polypad.grabbing *{cursor:-webkit-grabbing!important;cursor:grabbing!important}.polypad:not(.ready) *{transition:none!important;-webkit-animation:none!important;animation:none!important}.polypad:not(.is-tabbing) :focus{outline:none!important}svg.overlay,x-polypad{position:absolute;top:0;left:0;width:100%;height:100%}x-polypad .panels{right:56px}svg.overlay{pointer-events:none;z-index:10}x-polypad-sidebar .credit{border-top:1px solid #65636e;display:block;padding:8px 0;text-align:center;font-size:14px;color:hsla(0,0%,100%,.6)}`,e.appendChild(i);let n=d("div",{class:"polypad",dir:"ltr",lang:"en"});e.appendChild(n._el),n.addClass((w.isMobile?"is":"not")+"-mobile"),w.isSafari&&n.addClass("is-safari"),setTimeout(()=>n.addClass("ready")),window.addEventListener("keydown",f=>{f.keyCode===9&&n.addClass("is-tabbing")}),window.addEventListener("mousedown",()=>{n.removeClass("is-tabbing")});let o="";t.sidebar!==!1&&(o+=Al),t.toolbar!==!1&&(o+=El),o+='<svg class="overlay"><g class="tiles active"></g></svg>',o+=`<x-polypad${t.noPanAndZoom?"":' pan="yes"'}></x-polypad>`,t.settings!==!1&&(o+=Vl),n.html=o;let r=new te,a=n.$("x-polypad");yield new Promise(f=>setTimeout(f)),t.themeColours&&Object.assign(u,t.themeColours),t.bindKeyboardEvents&&a.enableHotkeys(),w.onResize(()=>a.setViewport(a.origin,a.zoom));let l=n.$("x-polypad-sidebar"),h=n.$("x-polypad-toolbar"),p=n.$("x-polypad-settings"),g=n.$(".overlay");l==null||l.bindPolypad(a,g),h==null||h.bindPolypad(a),p==null||p.bindPolypad(a),a.margins=[32,p?64:32,h?106:32,(l==null?void 0:l.isOpen)?324:32],t.initial&&a.load(t.initial),h==null||h.setClass("shifted",(l==null?void 0:l.active)!==void 0),l==null||l.on("toggle",({open:f})=>h==null?void 0:h.setClass("shifted",f)),t.imageUpload?a.enableImageDrop((f,m)=>M(this,null,function*(){m.options="";try{m.options=yield t.imageUpload(f)}catch(v){m.delete(),console.error("Failed to upload image :(")}}),h==null?void 0:h.$imageUpload):(G=h==null?void 0:h.$('[for="image-upload"]'))==null||G.hide(),a.on("change",f=>{var ii,Bo,Ho,Uo,Zo;if(!f||!((ii=f==null?void 0:f.tilesAdded)==null?void 0:ii.length)&&!((Bo=f==null?void 0:f.tilesDeleted)==null?void 0:Bo.length)&&!((Ho=f==null?void 0:f.strokesAdded)==null?void 0:Ho.length)&&!((Uo=f==null?void 0:f.strokesDeleted)==null?void 0:Uo.length)&&!((Zo=f==null?void 0:f.tilesChanged)==null?void 0:Zo.length))return;let m={},v=((f==null?void 0:f.tilesAdded)||[]).map(Jt=>Jt.serialize()),I=((f==null?void 0:f.strokesAdded)||[]).map(Jt=>Jt.serialize(Infinity));(v.length||I.length)&&(m.added=[...v,...I]);let it=((f==null?void 0:f.tilesDeleted)||[]).map(Jt=>Jt.serialize()),Dt=((f==null?void 0:f.strokesDeleted)||[]).map(Jt=>Jt.serialize(0));(it.length||Dt.length)&&(m.deleted=[...it,...Dt]);let Di=((f==null?void 0:f.tilesChanged)||[]).map(Jt=>Jt.serialize());Di.length&&(m.changed=Di),r.trigger("change",m)}),a.on("undo",f=>r.trigger("undo",f)),a.on("redo",f=>r.trigger("redo",f)),a.on("viewport",()=>{r.trigger("viewport",{x:a.origin.x,y:a.origin.y,zoom:a.zoom})});let y=0;a.options.watch(()=>{let f=a.options.grid;y&&r.trigger("grid",{grid:f}),y=1}),a.on("move-selection",()=>{let f=Array.from(a.selection.tiles).map(m=>({id:m.id,x:m.posn.x,y:m.posn.y}));r.trigger("move",{tiles:f})}),a.on("change-selection",f=>{var m;r.trigger("selection",{tiles:(m=f.tiles)==null?void 0:m.map(v=>v.id)})});let x=!0;return a.options.watch(f=>{let{altColors:m,mergeTiles:v,noLabels:I}=f;x||r.trigger("options",{altColors:m,noLabels:I,mergeTiles:v}),x=!1}),{on(f,m){r.on(f,m)},off(f,m){r.off(f,m)},undo(){a.undo()},redo(){a.redo()},serialize(f,m,v){return a.serialize(f,m,v)},unSerialize(f){a.load(f)},setGrid(f){a.options.grid=f},pngImage(f,m){return a.thumbnail(f,m)},add(f){if(f.name){let m=S.unSerialize(f,a);return m==null?void 0:m.id}else if(f.points)return ee.unSerialize(f,a).id},update(f,m){let v=a.tileMap.get(f);if(!v)return S.unSerialize(m,a);if(m.options){m=Object.assign(v.serialize(),m),v.delete(),S.unSerialize(m,a);return}(m.x||m.y||m.rot)&&v.setTransform(new c(m.x||0,m.y||0),m.rot||0),m.colour&&v.setColour(m.colour),m.size&&v.setSize(m.size),"locked"in m&&v.lock(m.locked),"flipped"in m&&v.flipped!==!!m.flipped&&v.flip()},delete(...f){var m,v;for(let I of f)(m=a.tileMap.get(I))==null||m.delete(),(v=a.strokeMap.get(I))==null||v.delete()},select(...f){a.selection.clear(),a.selection.select(f.map(m=>a.tileMap.get(m)).filter(m=>m))},getSelection(){return Array.from(a.selection.tiles).map(f=>f.id)},getViewport(){return{x:a.origin.x,y:a.origin.y,zoom:a.zoom}},setViewport(f,m,v){a.setViewport(new c(f,m),v)},setOptions(f){f.altColors!==void 0&&(a.options.altColors=f.altColors),f.noLabels!==void 0&&(a.options.noLabels=f.noLabels)},resetViewport(){a.resetViewport()},clear(){a.unSerialize({}),a.options.grid="none",a.resetViewport(),a.change()},setTheme(f){throw new Error(".setTheme() is not yet implemented.")},toggleSidebar(f){let m=(l==null?void 0:l.active)===0;f===void 0&&(f=!m),f!==m&&(l==null||l.toggleTab(0))},addCustomButton(f,m=""){var Dt;let v=f==="toolbar",I=d("button",{class:v?"tool":"settings-btn"});typeof m=="string"?I.html=m:I.append(Z(m));let it=v?h==null?void 0:h.$(".bar"):p==null?void 0:p.$(".settings-group");return v?(Dt=L((it==null?void 0:it.children)||[]))==null||Dt.insertBefore(I):it==null||it.append(I),I._el}}})}window.Polypad={create(e){return M(this,arguments,function*(s,t={}){let i=Z(s);if(!i)throw new Error(`Unable to find element ${s}`);let n=t.apiKey||"unknown",o=t.userKey||"";return fetch(`https://mathigon.org/api/polypad?key=${n}&user=${o}`),i.removeChildren(),yield Up(i,t)})}};})();